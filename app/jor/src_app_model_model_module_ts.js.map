{"version":3,"file":"src_app_model_model_module_ts.js","mappings":"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","sources":["./src/app/model/attribute-meta/attribute-meta.component.ts","./src/app/model/data-domain/data-domain-detail/data-domain-detail.component.ts","./src/app/model/data-domain/data-domain.component.ts","./src/app/model/data-element/data-element-detail/data-element-detail.component.ts","./src/app/model/data-element/data-element.component.ts","./src/app/model/entity-type/entity-type-detail/entity-type-detail.component.ts","./src/app/model/entity-type/entity-type.component.ts","./src/app/model/model-routing.module.ts","./src/app/model/model-validators.ts","./src/app/model/model.component.ts","./src/app/model/model.module.ts","./src/app/model/model.service.ts","./src/app/model/relation/relation-detail/relation-detail.component.ts","./src/app/model/relation/relation.component.ts","./src/app/model/relationship/relationship-detail/relationship-detail.component.ts","./src/app/model/relationship/relationship.component.ts","./src/app/model/role/role-detail/role-detail.component.ts","./src/app/model/role/role.component.ts","./src/app/model/search-help/search-help-detail/search-help-detail.component.ts","./src/app/model/search-help/search-help.component.ts","./node_modules/rxjs/_esm2015/internal/operators/debounceTime.js"],"sourcesContent":["import {Component, Input, OnChanges, OnInit, ViewChild} from '@angular/core';\nimport {AbstractControl, FormArray, FormBuilder, FormGroup} from '@angular/forms';\nimport {Attribute} from 'jor-angular';\nimport {ModelService} from '../model.service';\nimport {Observable} from 'rxjs';\nimport {SearchHelpMethod, SearchHelp, EntityService, SearchHelpComponent} from 'jor-angular';\nimport {MessageService, Message} from 'ui-message-angular';\nimport {msgStore} from '../../msgStore';\nimport {Router} from '@angular/router';\n\n@Component({\n  selector: 'app-attribute-meta',\n  templateUrl: './attribute-meta.component.html',\n  styleUrls: ['./attribute-meta.component.css']\n})\nexport class AttributeMetaComponent implements OnInit, OnChanges {\n  dataTypes = [];\n  formArray: FormArray;\n  deletedAttributes = [];\n  dataElementSearchHelp: SearchHelp;\n\n  constructor(private fb: FormBuilder,\n              private router: Router,\n              private entityService: EntityService,\n              private messageService: MessageService,\n              private modelService: ModelService) {\n    this.dataTypes = modelService.dataTypes;\n    this.messageService.setMessageStore(msgStore, 'EN');\n  }\n\n  @Input() parentForm: FormGroup;\n  @Input() attributes: Attribute[];\n  @Input() readonly: boolean;\n  @Input() relationID: string;\n  @Input() isNewMode: boolean;\n\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent !: SearchHelpComponent;\n\n  ngOnInit() {\n  }\n\n  ngOnChanges() {\n    this.generateFormArray();\n    this.formArray = this.parentForm.get('ATTRIBUTES') as FormArray;\n  }\n\n  onSearchHelp(control: AbstractControl, rowID: number): void {\n    if (!this.dataElementSearchHelp) {\n      this.dataElementSearchHelp = new SearchHelp();\n      this.dataElementSearchHelp.OBJECT_NAME = 'Data Element';\n      this.dataElementSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listDataElement(searchTerm);\n      }(this.entityService);\n      this.dataElementSearchHelp.BEHAVIOUR = 'A';\n      this.dataElementSearchHelp.MULTI = false;\n      this.dataElementSearchHelp.FUZZY_SEARCH = true;\n      this.dataElementSearchHelp.FIELDS = [\n        {FIELD_NAME: 'ELEMENT_ID', LIST_HEADER_TEXT: 'Element ID', IE_FIELD_NAME: 'DATA_ELEMENT',\n          IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'ELEMENT_DESC', LIST_HEADER_TEXT: 'Element Description', IE_FIELD_NAME: 'ATTR_DESC',\n          IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.dataElementSearchHelp.READ_ONLY = this.readonly || control.get('DATA_ELEMENT').disabled;\n    }\n    const afterExportFn = function (context: any, attrIdx: number) {\n      return () => context.onChangeDataElement(attrIdx);\n    }(this, rowID).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.dataElementSearchHelp, control, afterExportFn);\n  }\n\n  deleteAttribute(index: number): void {\n    if (index !== this.formArray.length - 1) {\n      this.deletedAttributes.push({\n        ATTR_GUID: this.formArray.at(index).get('ATTR_GUID').value,\n        ATTR_NAME: this.formArray.at(index).get('ATTR_NAME').value\n      });\n      this.formArray.removeAt(index);\n      this.formArray.markAsDirty();\n    }\n  }\n\n  insertAttribute(index: number): void {\n    this.formArray.insert(index, this._createAnAttributeFormCtrl());\n  }\n\n  _createAnAttributeFormCtrl(): FormGroup {\n    return this.fb.group({\n      ATTR_GUID: [''],\n      RELATION_ID: [''],\n      ATTR_NAME: [''],\n      ATTR_DESC: [{value: '', disabled: true}],\n      DATA_ELEMENT: [{value: '', disabled: false}],\n      DATA_TYPE: [{value: '', disabled: true}],\n      DATA_LENGTH: [{value: '', disabled: true}],\n      DECIMAL: [null],\n      ORDER: [null],\n      PRIMARY_KEY: [false],\n      AUTO_INCREMENT: [{value: false, disabled: true}]\n    });\n  }\n\n  switchBtwDEAndDT(index: number): void {\n    const currentAttributeFormCtrl = this.formArray.at(index);\n    const dataElementCtrl = currentAttributeFormCtrl.get('DATA_ELEMENT');\n    if (dataElementCtrl.enabled) {\n      this._disableField(dataElementCtrl);\n      this._enableField(currentAttributeFormCtrl.get('ATTR_DESC'));\n      this._enableField(currentAttributeFormCtrl.get('DATA_TYPE'));\n      this._enableField(currentAttributeFormCtrl.get('DATA_LENGTH'));\n      this._enableField(currentAttributeFormCtrl.get('DECIMAL'));\n      currentAttributeFormCtrl.get('DATA_TYPE').setValue(1);\n      currentAttributeFormCtrl.get('DATA_LENGTH').setValue(10);\n      this._disableField(currentAttributeFormCtrl.get('AUTO_INCREMENT'));\n    } else {\n      dataElementCtrl.enable();\n      this._enableField(dataElementCtrl);\n      this._disableField(currentAttributeFormCtrl.get('ATTR_DESC'));\n      this._disableField(currentAttributeFormCtrl.get('DATA_TYPE'));\n      this._disableField(currentAttributeFormCtrl.get('DATA_LENGTH'));\n      this._disableField(currentAttributeFormCtrl.get('DECIMAL'));\n      this._disableField(currentAttributeFormCtrl.get('AUTO_INCREMENT'));\n    }\n  }\n\n  _enableField(ctrl: AbstractControl) {\n    ctrl.setValue(null);\n    ctrl.enable();\n  }\n\n  _disableField(ctrl: AbstractControl) {\n    if (ctrl.value !== null && ctrl.value !== '') {\n      ctrl.setValue(null);\n      ctrl.markAsDirty();\n    }\n    ctrl.disable();\n  }\n\n  onChangeDataType(attrFormGroup: AbstractControl): void {\n    switch (attrFormGroup.get('DATA_TYPE').value) {\n      case '1': // char\n        attrFormGroup.get('DATA_LENGTH').setValue(10);\n        attrFormGroup.get('DECIMAL').setValue(null);\n        this._disableField(attrFormGroup.get('AUTO_INCREMENT'));\n        break;\n      case '2': // Integer\n        attrFormGroup.get('DATA_LENGTH').setValue(null);\n        attrFormGroup.get('DECIMAL').setValue(null);\n        this._enableField(attrFormGroup.get('AUTO_INCREMENT'));\n        break;\n      case '4': // decimal\n        attrFormGroup.get('DATA_LENGTH').setValue(23);\n        attrFormGroup.get('DECIMAL').setValue(2);\n        this._disableField(attrFormGroup.get('AUTO_INCREMENT'));\n        break;\n      default:\n        attrFormGroup.get('DATA_LENGTH').setValue(null);\n        attrFormGroup.get('DECIMAL').setValue(null);\n        this._disableField(attrFormGroup.get('AUTO_INCREMENT'));\n    }\n    attrFormGroup.get('DATA_LENGTH').markAsDirty();\n  }\n\n  onChangeAttributeName(index: number): void {\n    if (index === this.formArray.length - 1 && !this.formArray.controls[index].value.ATTR_GUID) {\n      // Only work for the last New line\n      this.formArray.push(this._createAnAttributeFormCtrl());\n    }\n  }\n\n  onChangeDataElement(index: number): void {\n    const attributeFormGroup = this.formArray.at(index);\n    const dataElementCtrl = attributeFormGroup.get('DATA_ELEMENT');\n    this.entityService.getDataElement(dataElementCtrl.value).subscribe(data => {\n      if (data['msgCat']) {\n        dataElementCtrl.setErrors({message: data['msgShortText']});\n      } else {\n        attributeFormGroup.get('ATTR_DESC').setValue(data['ELEMENT_DESC']);\n        attributeFormGroup.get('DATA_TYPE').setValue(data['DATA_TYPE']);\n        attributeFormGroup.get('DATA_LENGTH').setValue(data['DATA_LENGTH']);\n        attributeFormGroup.get('DECIMAL').setValue(data['DECIMAL']);\n        if (attributeFormGroup.get('DATA_TYPE').value === 2) {\n          this._enableField(attributeFormGroup.get('AUTO_INCREMENT'));\n        } else {\n          this._disableField(attributeFormGroup.get('AUTO_INCREMENT'));\n        }\n      }\n    });\n  }\n\n  checkAttributes(): Message[] {\n    const Messages: Message[] = [];\n    if ( this.formArray.controls.findIndex( control => control.get('PRIMARY_KEY').value ) === -1 ) {\n      Messages.push(this.messageService.generateMessage(\n        'MODEL', 'RELATION_PRIMARY_KEY_MISSING', 'E'));\n    }\n    return Messages;\n  }\n\n  processChangedAttributes(): any[] {\n    const changedAttributes = [];\n    let changedAttribute;\n    let order = 0;\n    if (this.formArray.dirty) {\n      this.formArray.controls.forEach((attribute, index) => {\n        if (attribute.get('ATTR_NAME').value.trim() === '') { return; }\n        order = index + 1;\n        if (order !== attribute.get('ORDER').value) {\n          attribute.get('ORDER').setValue(order);\n          attribute.get('ORDER').markAsDirty();\n        }\n        if (attribute.dirty) {\n          changedAttribute = {};\n          if (attribute.get('ATTR_GUID').value) { // Update Case\n            changedAttribute['action'] = 'update';\n            changedAttribute['ATTR_GUID'] = attribute.get('ATTR_GUID').value;\n            const attrFormGroup = attribute as FormGroup;\n            Object.keys(attrFormGroup.controls).forEach(key => {\n              const formControl = attrFormGroup.controls[key];\n              if (formControl.dirty) {\n                changedAttribute[key] = formControl.value;\n              }\n            });\n          } else { // New Add Case\n            changedAttribute['action'] = 'add';\n            const attrFormGroup = attribute as FormGroup;\n            Object.keys(attrFormGroup.controls).forEach(key => {\n              const formControl = attrFormGroup.controls[key];\n              changedAttribute[key] = formControl.value;\n            });\n          }\n        } else {\n          changedAttribute = null;\n        }\n        if (changedAttribute) {\n          changedAttributes.push(changedAttribute);\n        }\n      });\n\n      // Deletion Case\n      this.deletedAttributes.forEach(attribute => {\n        changedAttribute = {action: 'delete', ATTR_GUID: attribute.ATTR_GUID, ATTR_NAME: attribute.ATTR_NAME};\n        changedAttributes.push(changedAttribute);\n      });\n\n      return changedAttributes;\n    }\n  }\n\n  generateFormArray(): void {\n    const formArray = [];\n    if (this.attributes) {\n      this.attributes.forEach( attribute => {\n        const isDataElementAttribute = !!attribute.DATA_ELEMENT;\n        formArray.push(this.fb.group({\n          ATTR_GUID: [attribute.ATTR_GUID],\n          RELATION_ID: [attribute.RELATION_ID],\n          ATTR_NAME: [attribute.ATTR_NAME],\n          ATTR_DESC: [{value: attribute.ATTR_DESC, disabled: isDataElementAttribute}],\n          DATA_ELEMENT: [{value: attribute.DATA_ELEMENT, disabled: !isDataElementAttribute}],\n          DATA_TYPE: [{value: attribute.DATA_TYPE, disabled: this.readonly || this.isFieldGray(attribute) || isDataElementAttribute}],\n          DATA_LENGTH: [{value: attribute.DATA_LENGTH, disabled: isDataElementAttribute}],\n          DECIMAL: [{value: attribute.DECIMAL, disabled: isDataElementAttribute}],\n          ORDER: [attribute.ORDER],\n          PRIMARY_KEY: [{value: attribute.PRIMARY_KEY, disabled: this.readonly || this.isFieldGray(attribute)}],\n          AUTO_INCREMENT: [{\n            value: attribute.AUTO_INCREMENT,\n            disabled: this.readonly || this.isFieldGray(attribute) || attribute.DATA_TYPE !== 2}]\n        }));\n      });\n    }\n    if (this.isNewMode) {\n      formArray.push(this._createAnAttributeFormCtrl());\n    }\n    this.parentForm.addControl('ATTRIBUTES', new FormArray(formArray));\n  }\n\n  switchEditDisplay(readonly: boolean) {\n    if (!readonly) { // To Edit Mode\n      this.formArray.controls.forEach(attrFormGroup => {\n        if (!this.isFieldGray(attrFormGroup.value)) {\n          if (!attrFormGroup.get('DATA_ELEMENT').value) {\n            attrFormGroup.get('DATA_TYPE').enable();\n          }\n          attrFormGroup.get('PRIMARY_KEY').enable();\n          if (attrFormGroup.get('DATA_TYPE').value === 2) {\n            attrFormGroup.get('AUTO_INCREMENT').enable();\n          } else {\n            attrFormGroup.get('AUTO_INCREMENT').disable();\n          }\n        }\n      });\n      this.formArray.push(this._createAnAttributeFormCtrl());\n    } else { // To Display Mode\n      let lastIndex = this.formArray.length - 1;\n      while (lastIndex >= 0 && this.formArray.controls[lastIndex].get('ATTR_NAME').value.trim() === '') {\n        this.formArray.removeAt(lastIndex);\n        lastIndex--;\n      }\n      this.formArray.controls.forEach(attrFormGroup => {\n        attrFormGroup.get('DATA_TYPE').disable();\n        attrFormGroup.get('PRIMARY_KEY').disable();\n        attrFormGroup.get('AUTO_INCREMENT').disable();\n      });\n    }\n  }\n\n  isFieldGray(attribute: Attribute): boolean {\n    return this.relationID.substr(0, 3) === 'rs_' &&\n        attribute && attribute.ATTR_NAME &&\n       (attribute.ATTR_NAME === 'VALID_FROM' ||\n        attribute.ATTR_NAME === 'VALID_TO' ||\n        attribute.ATTR_NAME.substr(-14, 14) === '_INSTANCE_GUID' ||\n        attribute.ATTR_NAME.substr(-10, 10) === '_ENTITY_ID');\n  }\n\n  onGoToDataElement(dataElementName: string): void {\n    this.router.navigate(['/model/data-element', dataElementName]);\n  }\n}\n","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {UniqueDataDomainValidator} from '../../model-validators';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {switchMap} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\nimport {DataDomainMeta, SearchHelpComponent, EntityService, SearchHelp, SearchHelpMethod} from 'jor-angular';\n\n@Component({\n  selector: 'app-data-domain-detail',\n  templateUrl: './data-domain-detail.component.html',\n  styleUrls: ['./data-domain-detail.component.css']\n})\nexport class DataDomainDetailComponent implements OnInit {\n\n  dataDomainMeta: DataDomainMeta;\n  readonly = true;\n  isNewMode = false;\n  dataDomainForm: FormGroup;\n  dataTypes = [];\n  changedDataDomain = {};\n  relationsOfEntity = [];\n  bypassProtection = false;\n  isSearchListShown = true;\n  enableGeneralType = false;\n  enableRegExpr = false;\n  enableValueRelation = false;\n  enableArrayOrInterval = false;\n  entitySearchHelp: SearchHelp;\n\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent !: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueDataDomainValidator: UniqueDataDomainValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.dataTypes = this.modelService.dataTypes;\n  }\n\n  get domainValueFormArray() {\n    return this.dataDomainForm.get('DOMAIN_VALUES') as FormArray;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const domainID = params.get('domainID');\n        if (domainID === 'new') {\n          const dataDomain = new DataDomainMeta();\n          dataDomain.DOMAIN_ID = '';\n          dataDomain.DOMAIN_DESC = '';\n          dataDomain.DATA_TYPE = 1; // Char by default\n          dataDomain.DATA_LENGTH = 10;\n          dataDomain.DOMAIN_TYPE = 0;\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return of(dataDomain);\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return this.entityService.getDataDomain(domainID);\n        }\n      })\n    ).subscribe(data => {\n      if ( 'msgName' in data) {\n        this.messageService.clearMessages();\n        this.dataDomainMeta = null;\n        this.dataDomainForm = null;\n        this.messageService.report(<Message>data);\n      } else {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.dataDomainMeta = <DataDomainMeta>data;\n        this._generateDataDomainForm();\n        this._getRelationsOfEntity( this.dataDomainForm, false);\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  _generateDataDomainForm(): void {\n    if (this.dataDomainForm) {\n      this.dataDomainForm.markAsPristine({onlySelf: false});\n      this.dataDomainForm.get('DOMAIN_ID').setValue(this.dataDomainMeta.DOMAIN_ID);\n      this.dataDomainForm.get('DOMAIN_DESC').setValue(this.dataDomainMeta.DOMAIN_DESC);\n      this.dataDomainForm.get('DATA_TYPE').setValue(this.dataDomainMeta.DATA_TYPE);\n      this.dataDomainForm.get('DATA_LENGTH').setValue(this.dataDomainMeta.DATA_LENGTH);\n      this.dataDomainForm.get('DECIMAL').setValue(this.dataDomainMeta.DECIMAL);\n      this.dataDomainForm.get('DOMAIN_TYPE').setValue(this.dataDomainMeta.DOMAIN_TYPE);\n      this.dataDomainForm.get('UNSIGNED').setValue(this.dataDomainMeta.UNSIGNED);\n      this.dataDomainForm.get('CAPITAL_ONLY').setValue(this.dataDomainMeta.CAPITAL_ONLY);\n      this.dataDomainForm.get('REG_EXPR').setValue(this.dataDomainMeta.REG_EXPR);\n      this.dataDomainForm.get('ENTITY_ID').setValue(this.dataDomainMeta.ENTITY_ID);\n      this.dataDomainForm.get('RELATION_ID').setValue(this.dataDomainMeta.RELATION_ID);\n      (<FormArray>this.dataDomainForm.get('DOMAIN_VALUES')).clear();\n      if (this.readonly) {\n        this.dataDomainForm.get('DOMAIN_TYPE').disable();\n        this.dataDomainForm.get('DATA_TYPE').disable();\n      }\n    } else {\n      this.dataDomainForm = this.fb.group({\n        DOMAIN_ID: [this.dataDomainMeta.DOMAIN_ID, {updateOn: 'blur'}],\n        DOMAIN_DESC: [this.dataDomainMeta.DOMAIN_DESC],\n        DATA_TYPE: [{value: this.dataDomainMeta.DATA_TYPE, disabled: this.readonly}],\n        DATA_LENGTH: [this.dataDomainMeta.DATA_LENGTH, [this._validateDataLength]],\n        DECIMAL: [this.dataDomainMeta.DECIMAL, [this._validateDecimal]],\n        DOMAIN_TYPE: [{value: this.dataDomainMeta.DOMAIN_TYPE, disabled: this.readonly}],\n        UNSIGNED: [{value: this.dataDomainMeta.UNSIGNED, disabled: this.readonly}],\n        CAPITAL_ONLY: [{value: this.dataDomainMeta.CAPITAL_ONLY, disabled: this.readonly}],\n        REG_EXPR: [this.dataDomainMeta.REG_EXPR],\n        ENTITY_ID: [this.dataDomainMeta.ENTITY_ID],\n        RELATION_ID: [{value: this.dataDomainMeta.RELATION_ID, disabled: this.readonly}],\n        DOMAIN_VALUES: this.fb.array([])\n      });\n    }\n    this._setNewModeState();\n    if (this.dataDomainMeta.DOMAIN_TYPE >= 3 && this.dataDomainMeta.DOMAIN_VALUES) { // Value Array/Interval\n      this.dataDomainMeta.DOMAIN_VALUES.forEach( domainValue => {\n        this.domainValueFormArray.push(\n          this.fb.group({\n            LOW_VALUE: [domainValue.LOW_VALUE],\n            LOW_VALUE_TEXT: [domainValue.LOW_VALUE_TEXT],\n            HIGH_VALUE: [domainValue.HIGH_VALUE]\n          })\n        );\n      });\n    }\n    this._setDomainType(this.dataDomainForm, false);\n    this._updateLengthAndDecimal(this.dataDomainForm, false);\n  }\n\n  _setNewModeState() {\n    if (this.isNewMode) {\n      this.dataDomainForm.get('DOMAIN_ID').setValidators(this._validateDataDomainID);\n      this.dataDomainForm.get('DOMAIN_ID').setAsyncValidators(\n        this.uniqueDataDomainValidator.validate.bind(this.uniqueDataDomainValidator));\n      this.dataDomainForm.get('DATA_TYPE').enable();\n      this.dataDomainForm.get('DOMAIN_TYPE').enable();\n      this.dataDomainForm.get('DATA_TYPE').markAsDirty(); // Default value mark as dirty\n      this.dataDomainForm.get('DATA_LENGTH').markAsDirty(); // Default value mark as dirty\n      this.dataDomainForm.get('DOMAIN_TYPE').markAsDirty(); // Default value mark as dirty\n    } else {\n      this.dataDomainForm.get('DOMAIN_ID').clearValidators();\n      this.dataDomainForm.get('DOMAIN_ID').clearAsyncValidators();\n      this.dataDomainForm.get('DOMAIN_ID').updateValueAndValidity();\n    }\n  }\n\n  _validateDataDomainID(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Data Domain ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().length > 32) {\n      return {message: 'Data Domain ID must have length less than 32!'};\n    }\n    return null;\n  }\n\n  _validateDataLength(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a Length'};\n    }\n    return null;\n  }\n\n  _validateDecimal(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a decimal place'};\n    }\n    if (c.value < 1 || c.value > 37) {\n      return {message: 'Decimal place can only between 1 and 37'};\n    }\n    return null;\n  }\n  _validateEntityID(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give an entity'};\n    }\n    return null;\n  }\n  _validateRelationID(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a relation'};\n    }\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Data Domain?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.dataDomainMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.dataDomainForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateDataDomainForm();\n            this.dataDomainForm.reset(this.dataDomainForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this._switch2EditMode();\n    }\n\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    this.dataDomainForm.get('DOMAIN_TYPE').disable();\n    this.dataDomainForm.get('DATA_TYPE').disable();\n    this.dataDomainForm.get('UNSIGNED').disable();\n    this.dataDomainForm.get('CAPITAL_ONLY').disable();\n    this.dataDomainForm.get('RELATION_ID').disable();\n  }\n\n  _switch2EditMode(): void {\n    this.readonly = false;\n    this.dataDomainForm.get('DOMAIN_TYPE').enable();\n    this.dataDomainForm.get('DATA_TYPE').enable();\n    this._setDomainType(this.dataDomainForm, false);\n    this._updateLengthAndDecimal(this.dataDomainForm, false);\n  }\n\n  onChangeDataDomainID(): void {\n    this.modelService.updateDataDomainID(this.dataDomainForm.get('DOMAIN_ID').value);\n  }\n\n  onChangeDataDomainDesc(): void {\n    this.modelService.updateDataDomainDesc(this.dataDomainForm.get('DOMAIN_DESC').value);\n  }\n\n  onChangeDomainType(formGroup: AbstractControl): void {\n    this._setDomainType(formGroup, true);\n  }\n\n  onEntitySearchHelp(control: AbstractControl): void {\n    if (!this.entitySearchHelp) {\n      this.entitySearchHelp = new SearchHelp();\n      this.entitySearchHelp.OBJECT_NAME = 'Entity ID';\n      this.entitySearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listEntityType(searchTerm);\n      }(this.entityService);\n      this.entitySearchHelp.BEHAVIOUR = 'A';\n      this.entitySearchHelp.MULTI = false;\n      this.entitySearchHelp.FUZZY_SEARCH = true;\n      this.entitySearchHelp.FIELDS = [\n        {FIELD_NAME: 'ENTITY_ID', LIST_HEADER_TEXT: 'Entity', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'ENTITY_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.entitySearchHelp.READ_ONLY = this.readonly || this.dataDomainForm.get('DOMAIN_TYPE').value !== 2;\n    }\n    const afterExportFn = function (context: any) {\n      return () => context.onChangeEntityID(control);\n    }(this).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.entitySearchHelp, control, afterExportFn);\n  }\n\n  onChangeEntityID(formGroup: AbstractControl): void {\n    this._getRelationsOfEntity(formGroup, true);\n  }\n\n  _getRelationsOfEntity(dataDomainForm: AbstractControl, setDefault: boolean): void {\n    const domainEntityID = dataDomainForm.get('ENTITY_ID').value;\n    if (!domainEntityID) { return; }\n    this.entityService.getRelationMetaOfEntity(domainEntityID)\n      .subscribe(entityRelations => {\n        if (entityRelations[0]['msgType'] === 'E') {\n          dataDomainForm.get('ENTITY_ID').setErrors({message: entityRelations[0]['msgShortText']});\n        } else {\n          this.relationsOfEntity = entityRelations.map(relationMeta => relationMeta.RELATION_ID )\n            .filter(relationId => relationId.substr(0, 2) !== 'rs' );\n          if (setDefault) {\n            dataDomainForm.get('RELATION_ID').setValue(this.relationsOfEntity[0]);\n            dataDomainForm.get('RELATION_ID').markAsDirty();\n          }\n        }\n      });\n  }\n\n  _setDomainType(formGroup: AbstractControl, markAsDirty: boolean): void {\n    if (markAsDirty) { formGroup.get('DOMAIN_TYPE').markAsDirty(); }\n    switch (+formGroup.get('DOMAIN_TYPE').value) {\n      case 0: // General Type\n        if (+formGroup.get('DATA_TYPE').value === 2) {\n          if (!this.readonly) { formGroup.get('UNSIGNED').enable(); }\n          this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        } else if (+formGroup.get('DATA_TYPE').value === 1) {\n          if (!this.readonly) { formGroup.get('CAPITAL_ONLY').enable(); }\n          this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        }\n        this._invalidField(formGroup.get('REG_EXPR'), markAsDirty);\n        this._invalidField(formGroup.get('ENTITY_ID'), markAsDirty);\n        this._invalidField(formGroup.get('RELATION_ID'), markAsDirty);\n        this._invalidField(formGroup.get('DOMAIN_VALUES'), markAsDirty, true);\n        break;\n      case 1: // Regular Expression\n        // formGroup.get('REG_EXPR').setValidators(this._validateRegExpr);\n        if (!this.readonly) { formGroup.get('REG_EXPR').enable(); }\n        this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        this._invalidField(formGroup.get('ENTITY_ID'), markAsDirty);\n        this._invalidField(formGroup.get('RELATION_ID'), markAsDirty);\n        this._invalidField(formGroup.get('DOMAIN_VALUES'), markAsDirty, true);\n        break;\n      case 2: // Value Relation\n        if (!this.readonly) {\n          formGroup.get('ENTITY_ID').enable();\n          formGroup.get('RELATION_ID').enable();\n          formGroup.get('ENTITY_ID').setValidators(this._validateEntityID);\n          formGroup.get('RELATION_ID').setValidators(this._validateRelationID);\n        }\n        this._invalidField(formGroup.get('REG_EXPR'), markAsDirty);\n        this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        this._invalidField(formGroup.get('DOMAIN_VALUES'), markAsDirty, true);\n        break;\n      case 3: // Value Array\n        if (!this.readonly) { formGroup.get('DOMAIN_VALUES').enable(); }\n        this._invalidField(formGroup.get('ENTITY_ID'), markAsDirty);\n        this._invalidField(formGroup.get('RELATION_ID'), markAsDirty);\n        this._invalidField(formGroup.get('REG_EXPR'), markAsDirty);\n        this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        this._generateEmptyLines(5);\n        break;\n      case 4: // Value Interval\n        if (!this.readonly) { formGroup.get('DOMAIN_VALUES').enable(); }\n        this._invalidField(formGroup.get('ENTITY_ID'), markAsDirty);\n        this._invalidField(formGroup.get('RELATION_ID'), markAsDirty);\n        this._invalidField(formGroup.get('REG_EXPR'), markAsDirty);\n        this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        this._generateEmptyLines(5);\n        break;\n      default:\n    }\n  }\n\n  _generateEmptyLines(num: number): void {\n    const existingLines = this.domainValueFormArray.length;\n    for (let i = 0; i < num - existingLines; i++) {\n      this.domainValueFormArray.push(\n        this.fb.group({\n          LOW_VALUE: [''],\n          LOW_VALUE_TEXT: [''],\n          HIGH_VALUE: ['']\n        }));\n    }\n  }\n\n  onChangeDataType(formGroup: AbstractControl): void {\n    switch (+formGroup.get('DATA_TYPE').value) {\n      case 1: // char\n        formGroup.get('DATA_LENGTH').setValue(10);\n        formGroup.get('DECIMAL').setValue(null);\n        break;\n      case 4: // decimal\n        formGroup.get('DATA_LENGTH').setValue(23);\n        formGroup.get('DECIMAL').setValue(2);\n        break;\n      default:\n        formGroup.get('DATA_LENGTH').setValue(null);\n        formGroup.get('DECIMAL').setValue(null);\n    }\n    formGroup.get('DATA_LENGTH').markAsDirty();\n    formGroup.get('DECIMAL').markAsDirty();\n    this._updateLengthAndDecimal(formGroup, true);\n  }\n\n  _updateLengthAndDecimal(formGroup: AbstractControl, markAsDirty: boolean): void {\n    switch (+formGroup.get('DATA_TYPE').value) {\n      case 1: // char\n        if (!this.readonly) {\n          formGroup.get('DATA_LENGTH').enable();\n          formGroup.get('DATA_LENGTH').setValidators(this._validateDataLength);\n        }\n        this._invalidField(formGroup.get('DECIMAL'));\n        if (+formGroup.get('DOMAIN_TYPE').value === 0) {\n          if (!this.readonly) { formGroup.get('CAPITAL_ONLY').enable(); }\n          this._invalidField(formGroup.get('UNSIGNED'));\n        }\n        this.enableGeneralType = true;\n        this.enableRegExpr = true;\n        this.enableValueRelation = true;\n        this.enableArrayOrInterval = true;\n        break;\n      case 2: // Integer\n        formGroup.get('DATA_LENGTH').disable();\n        this._invalidField(formGroup.get('DECIMAL'), markAsDirty);\n        if (+formGroup.get('DOMAIN_TYPE').value === 0) {\n          if (!this.readonly) { formGroup.get('UNSIGNED').enable(); }\n          this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        } else if (+formGroup.get('DOMAIN_TYPE').value === 1 || +formGroup.get('DOMAIN_TYPE').value === 2) {\n          if (!this.readonly) { formGroup.get('DOMAIN_TYPE').setValue(0); }\n          this._setDomainType(formGroup, markAsDirty);\n        }\n        this.enableGeneralType = true;\n        this.enableRegExpr = false;\n        this.enableValueRelation = false;\n        this.enableArrayOrInterval = true;\n        break;\n      case 4: // decimal\n        if (!this.readonly) {\n          formGroup.get('DATA_LENGTH').enable();\n          formGroup.get('DATA_LENGTH').setValidators(this._validateDataLength);\n          formGroup.get('DECIMAL').enable();\n          formGroup.get('DECIMAL').setValidators(this._validateDecimal);\n          formGroup.get('UNSIGNED').enable();\n        }\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        formGroup.get('DOMAIN_TYPE').setValue(0);\n        this._setDomainType(formGroup, markAsDirty);\n        this.enableGeneralType = true;\n        this.enableRegExpr = false;\n        this.enableValueRelation = false;\n        this.enableArrayOrInterval = false;\n        break;\n      case 5: // string\n        this._invalidField(formGroup.get('DATA_LENGTH'), markAsDirty);\n        this._invalidField(formGroup.get('DECIMAL'), markAsDirty);\n        formGroup.get('DOMAIN_TYPE').setValue(1);\n        this._setDomainType(formGroup, markAsDirty);\n        this.enableGeneralType = false;\n        this.enableRegExpr = true;\n        this.enableValueRelation = false;\n        this.enableArrayOrInterval = false;\n        break;\n      default:\n        this._invalidField(formGroup.get('DATA_LENGTH'), markAsDirty);\n        this._invalidField(formGroup.get('DECIMAL'), markAsDirty);\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        formGroup.get('DOMAIN_TYPE').setValue(0);\n        this._setDomainType(formGroup, markAsDirty);\n        this.enableGeneralType = true;\n        this.enableRegExpr = false;\n        this.enableValueRelation = false;\n        this.enableArrayOrInterval = false;\n    }\n  }\n\n  _invalidField(fieldCtrl: AbstractControl, markAsDirty: boolean = false, isArray: boolean = false): void {\n    fieldCtrl.clearValidators();\n    fieldCtrl.clearAsyncValidators();\n    fieldCtrl.disable();\n    if (markAsDirty) {\n      isArray ? (<FormArray>fieldCtrl).clear() : fieldCtrl.setValue(null);\n      fieldCtrl.markAsDirty();\n    }\n  }\n\n  onChangeDomainValue(index: number): void {\n    const currentDomainValueCtrl = this.domainValueFormArray.at(index);\n    if (!currentDomainValueCtrl.get('LOW_VALUE').value) { return; }\n    const indexFound = this.domainValueFormArray.controls.findIndex(\n      (ctrl, valueIndex) => index !== valueIndex && ctrl.value.LOW_VALUE === currentDomainValueCtrl.value.LOW_VALUE);\n    if (indexFound > -1) {\n      currentDomainValueCtrl.get('LOW_VALUE').setErrors({message: 'Value is duplicated!'});\n    } else {\n      currentDomainValueCtrl.get('LOW_VALUE').setErrors(null);\n    }\n\n    if (this.dataDomainForm.get('DOMAIN_TYPE').value === 4 && currentDomainValueCtrl.get('LOW_VALUE').value) {\n      if (!currentDomainValueCtrl.value.HIGH_VALUE ||\n        currentDomainValueCtrl.value.HIGH_VALUE <=  currentDomainValueCtrl.value.LOW_VALUE ) {\n        currentDomainValueCtrl.get('HIGH_VALUE').setErrors({message: 'High value must be greater!'});\n      } else {\n        currentDomainValueCtrl.get('HIGH_VALUE').setErrors(null);\n      }\n    }\n  }\n\n  insertDomainValue(index: number): void {\n    this.domainValueFormArray.insert(index, this.fb.group({\n        LOW_VALUE: [''],\n        LOW_VALUE_TEXT: [''],\n        HIGH_VALUE: ['']\n      }));\n  }\n\n  deleteDomainValue(index: number): void {\n    this.domainValueFormArray.removeAt(index);\n    this.domainValueFormArray.markAsDirty();\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.dataDomainForm && this.dataDomainForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.dataDomainForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (this.dataDomainForm.invalid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (+this.dataDomainForm.get('DOMAIN_TYPE').value >= 3 && this.domainValueFormArray.length === 0 ) {\n      return this.messageService.reportMessage('MODEL', 'MINIMUM_ONE_DOMAIN_VALUE', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedDataDomain['action'] = 'add';\n      this.changedDataDomain['DOMAIN_ID'] = this.dataDomainForm.get('DOMAIN_ID').value;\n    } else {\n      this.changedDataDomain['action'] = 'update';\n      this.changedDataDomain['DOMAIN_ID'] = this.dataDomainMeta.DOMAIN_ID;\n    }\n    if (this.dataDomainForm.get('DOMAIN_DESC').dirty) {\n      this.changedDataDomain['DOMAIN_DESC'] = this.dataDomainForm.get('DOMAIN_DESC').value;\n    }\n    if (this.dataDomainForm.get('DATA_TYPE').dirty) {\n      this.changedDataDomain['DATA_TYPE'] = this.dataDomainForm.get('DATA_TYPE').value;\n    }\n    if (this.dataDomainForm.get('DATA_LENGTH').dirty) {\n      this.changedDataDomain['DATA_LENGTH'] = this.dataDomainForm.get('DATA_LENGTH').value;\n    }\n    if (this.dataDomainForm.get('DECIMAL').dirty) {\n      this.changedDataDomain['DECIMAL'] = this.dataDomainForm.get('DECIMAL').value;\n    }\n    if (this.dataDomainForm.get('DOMAIN_TYPE').dirty) {\n      this.changedDataDomain['DOMAIN_TYPE'] = this.dataDomainForm.get('DOMAIN_TYPE').value;\n    }\n    if (this.dataDomainForm.get('UNSIGNED').dirty) {\n      this.changedDataDomain['UNSIGNED'] = this.dataDomainForm.get('UNSIGNED').value;\n    }\n    if (this.dataDomainForm.get('CAPITAL_ONLY').dirty) {\n      this.changedDataDomain['CAPITAL_ONLY'] = this.dataDomainForm.get('CAPITAL_ONLY').value;\n    }\n    if (this.dataDomainForm.get('REG_EXPR').dirty) {\n      this.changedDataDomain['REG_EXPR'] = this.dataDomainForm.get('REG_EXPR').value;\n    }\n    if (this.dataDomainForm.get('ENTITY_ID').dirty) {\n      this.changedDataDomain['ENTITY_ID'] = this.dataDomainForm.get('ENTITY_ID').value;\n    }\n    if (this.dataDomainForm.get('RELATION_ID').dirty) {\n      this.changedDataDomain['RELATION_ID'] = this.dataDomainForm.get('RELATION_ID').value;\n    }\n    if (this.dataDomainForm.get('DOMAIN_VALUES').dirty) {\n      this.changedDataDomain['DOMAIN_VALUES'] = [];\n      this.dataDomainForm.get('DOMAIN_VALUES').value.forEach( domainValue => {\n        if (domainValue.LOW_VALUE) {\n          this.changedDataDomain['DOMAIN_VALUES'].push(domainValue);\n        }\n      });\n    }\n    this.entityService.saveDataDomain(this.changedDataDomain)\n      .subscribe(data => this._postActivityAfterSavingDataDomain(data));\n  }\n\n  _postActivityAfterSavingDataDomain(data: any) {\n    this.changedDataDomain = {};\n    if (data['DOMAIN_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/data-domain/' + data['DOMAIN_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'DATA_DOMAIN_SAVED', 'S', data['DOMAIN_ID'])}});\n      } else {\n        this._switch2DisplayMode();\n        this.dataDomainMeta = data;\n        this._generateDataDomainForm();\n        this.messageService.reportMessage('MODEL', 'DATA_DOMAIN_SAVED', 'S', data['DOMAIN_ID']);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n\n\n","import { Component, OnInit } from '@angular/core';\nimport {Subject} from 'rxjs';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {DataDomainH, DataDomainMeta, EntityService} from 'jor-angular';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-data-domain',\n  templateUrl: './data-domain.component.html',\n  styleUrls: ['./data-domain.component.css']\n})\nexport class DataDomainComponent implements OnInit {\n  dataDomainList: DataDomainH[] = [];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedDataDomain: DataDomainH;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listDataDomain(term)),\n    ).subscribe(data => {\n      this.dataDomainList = data;\n      let domainID;\n      if (this.route.snapshot.firstChild) {\n        domainID = this.route.snapshot.firstChild.paramMap.get('domainID');\n      }\n      if (domainID ) {\n        if (domainID === 'new') {\n          this._newDataDomain();\n        } else {\n          this.onSelect(this.dataDomainList.find(dataDomain => dataDomain.DOMAIN_ID === domainID));\n        }\n      }\n    });\n    this.searchDataDomain(''); // The initial list\n\n    this.modelService.theSelectedDataDomain$.subscribe( data => {\n      if (this.theSelectedDataDomain) {\n        this.theSelectedDataDomain.DOMAIN_ID = data['DOMAIN_ID'];\n        this.theSelectedDataDomain.DOMAIN_DESC = data['DOMAIN_DESC'];\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.dataDomainList[0] && !this.dataDomainList[0].CREATE_TIME) {\n        this.dataDomainList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const domainID = this.route.snapshot.firstChild.paramMap.get('domainID');\n        if (domainID) {\n          if (domainID === 'new') {\n            this.onSelect(this.dataDomainList[0]);\n          } else {\n            this.onSelect(this.dataDomainList.find(dataDomain => dataDomain.DOMAIN_ID === domainID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  onSelect(dataDomain: DataDomainH): void {\n    if (dataDomain) {\n      this.theSelectedDataDomain = dataDomain;\n      this.modelService.setSelectedDataDomain(dataDomain);\n    }\n  }\n\n  searchDataDomain(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  newDataDomian(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('domainID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newDataDomain();\n      this.router.navigate(['/model/data-domain/new']);\n    }\n  }\n\n  _newDataDomain(): void {\n    this.theSelectedDataDomain = new DataDomainMeta();\n    this.theSelectedDataDomain.DOMAIN_ID = 'new';\n    this.theSelectedDataDomain.DOMAIN_DESC = 'description';\n    this.theSelectedDataDomain.VERSION_NO = 1;\n    this.theSelectedDataDomain.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedDataDomain.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedDataDomain(this.theSelectedDataDomain);\n    this.dataDomainList.splice(0, 0, this.theSelectedDataDomain);\n  }\n}\n","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {AbstractControl, FormBuilder, FormControl, FormGroup, Validators} from '@angular/forms';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {UniqueDataElementValidator} from '../../model-validators';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {msgStore} from '../../../msgStore';\nimport {switchMap} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\nimport {DataElementMeta, EntityService, SearchHelp, SearchHelpComponent, SearchHelpField, SearchHelpMethod} from 'jor-angular';\n\n@Component({\n  selector: 'app-data-element-detail',\n  templateUrl: './data-element-detail.component.html',\n  styleUrls: ['./data-element-detail.component.css']\n})\nexport class DataElementDetailComponent implements OnInit {\n  dataElementMeta: DataElementMeta;\n  readonly = true;\n  isNewMode = false;\n  dataElementForm: FormGroup;\n  dataTypes = [];\n  changedDataElement = {};\n  bypassProtection = false;\n  isSearchListShown = true;\n  searchHelpExportField = [];\n  dataDomainSearchHelp: SearchHelp;\n  searchHelpSearchHelp: SearchHelp;\n\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent !: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueDataElementValidator: UniqueDataElementValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.messageService.setMessageStore(msgStore, 'EN');\n    this.dataTypes = this.modelService.dataTypes;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const elementID = params.get('elementID');\n        if (elementID === 'new') {\n          const dataElement = new DataElementMeta();\n          dataElement.ELEMENT_ID = '';\n          dataElement.ELEMENT_DESC = '';\n          dataElement.DATA_TYPE = 1;\n          dataElement.DATA_LENGTH = 10;\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return of(dataElement);\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return this.entityService.getDataElement(elementID);\n        }})\n    ).subscribe(data => {\n      if ( 'msgName' in data) {\n        this.messageService.clearMessages();\n        this.dataElementMeta = null;\n        this.dataElementForm = null;\n        this.messageService.report(<Message>data);\n      } else {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.dataElementMeta = <DataElementMeta>data;\n        this._generateDataElementForm();\n        this._getSearchHelpMeta(this.dataElementForm, false);\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  onDataDomainSearchHelp(control: AbstractControl): void {\n    if (!this.dataDomainSearchHelp) {\n      this.dataDomainSearchHelp = new SearchHelp();\n      this.dataDomainSearchHelp.OBJECT_NAME = 'Data Domain';\n      this.dataDomainSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listDataDomain(searchTerm);\n      }(this.entityService);\n      this.dataDomainSearchHelp.BEHAVIOUR = 'A';\n      this.dataDomainSearchHelp.MULTI = false;\n      this.dataDomainSearchHelp.FUZZY_SEARCH = true;\n      this.dataDomainSearchHelp.FIELDS = [\n        {FIELD_NAME: 'DOMAIN_ID', LIST_HEADER_TEXT: 'Domain', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'DOMAIN_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.dataDomainSearchHelp.READ_ONLY = this.readonly || !this.dataElementForm.get('USE_DOMAIN').value;\n    }\n    const afterExportFn = function (context: any) {\n      return () => context.onChangeDataDomain(control);\n    }(this).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.dataDomainSearchHelp, control, afterExportFn);\n  }\n\n  onSearchHelpSearchHelp(control: AbstractControl): void {\n    if (!this.searchHelpSearchHelp) {\n      this.searchHelpSearchHelp = new SearchHelp();\n      this.searchHelpSearchHelp.OBJECT_NAME = 'Search Help';\n      this.searchHelpSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listSearchHelp(searchTerm);\n      }(this.entityService);\n      this.searchHelpSearchHelp.BEHAVIOUR = 'A';\n      this.searchHelpSearchHelp.MULTI = false;\n      this.searchHelpSearchHelp.FUZZY_SEARCH = true;\n      this.searchHelpSearchHelp.FIELDS = [\n        {FIELD_NAME: 'SEARCH_HELP_ID', LIST_HEADER_TEXT: 'Search Help', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'SEARCH_HELP_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.searchHelpSearchHelp.READ_ONLY = this.readonly;\n    }\n    const afterExportFn = function (context: any) {\n      return () => context.onChangeSearchHelp(control);\n    }(this).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.searchHelpSearchHelp, control, afterExportFn);\n  }\n\n  onChangeSearchHelp(formGroup: AbstractControl): void {\n    this._getSearchHelpMeta(formGroup, true);\n  }\n\n  _getSearchHelpMeta(formGroup: AbstractControl, setDefault: boolean): void {\n    const searchHelpCtrl = formGroup.get('SEARCH_HELP_ID');\n    if (!searchHelpCtrl.value) {\n      if (!this.readonly) {\n        formGroup.get('SEARCH_HELP_EXPORT_FIELD').setValue('');\n        formGroup.get('SEARCH_HELP_EXPORT_FIELD').markAsDirty();\n      }\n      return;\n    }\n    this.entityService.getSearchHelp(searchHelpCtrl.value).subscribe(data => {\n      if (data['msgCat']) {\n        searchHelpCtrl.setErrors({message: data['msgShortText']});\n        if (setDefault) {\n          formGroup.get('SEARCH_HELP_EXPORT_FIELD').setValue('');\n          formGroup.get('SEARCH_HELP_EXPORT_FIELD').markAsDirty();\n        }\n      } else {\n        this.searchHelpExportField = [];\n        const searchHelpFields = <SearchHelpField[]>data['FIELDS'];\n        searchHelpFields.forEach( field => {\n          if (field.EXPORT) {\n            this.searchHelpExportField.push( field.IE_FIELD_NAME || field.FIELD_NAME );\n          }\n        });\n        if (setDefault) {\n          formGroup.get('SEARCH_HELP_EXPORT_FIELD').setValue(this.searchHelpExportField[0]);\n          formGroup.get('SEARCH_HELP_EXPORT_FIELD').markAsDirty();\n        }\n      }\n    });\n  }\n\n  _generateDataElementForm(): void {\n    if (this.dataElementForm) {\n      this.dataElementForm.markAsPristine({onlySelf: false});\n      this.dataElementForm.get('ELEMENT_ID').setValue(this.dataElementMeta.ELEMENT_ID);\n      this.dataElementForm.get('ELEMENT_DESC').setValue(this.dataElementMeta.ELEMENT_DESC);\n      this.dataElementForm.get('LABEL_TEXT').setValue(this.dataElementMeta.LABEL_TEXT);\n      this.dataElementForm.get('LIST_HEADER_TEXT').setValue(this.dataElementMeta.LIST_HEADER_TEXT);\n      this.dataElementForm.get('DOMAIN_ID').setValue(this.dataElementMeta.DOMAIN_ID);\n      this.dataElementForm.get('DATA_TYPE').setValue(this.dataElementMeta.DATA_TYPE);\n      this.dataElementForm.get('DATA_LENGTH').setValue(this.dataElementMeta.DATA_LENGTH);\n      this.dataElementForm.get('DECIMAL').setValue(this.dataElementMeta.DECIMAL);\n      this.dataElementForm.get('SEARCH_HELP_ID').setValue(this.dataElementMeta.SEARCH_HELP_ID);\n      this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').setValue(this.dataElementMeta.SEARCH_HELP_EXPORT_FIELD);\n      this.dataElementForm.get('PARAMETER_ID').setValue(this.dataElementMeta.PARAMETER_ID);\n      if (this.dataElementMeta.DOMAIN_ID) {\n        this.dataElementForm.get('USE_DOMAIN').setValue(1);\n        this.dataElementForm.get('DATA_TYPE').disable();\n      } else {\n        this.dataElementForm.get('USE_DOMAIN').setValue(0);\n        this.dataElementForm.get('DATA_TYPE').enable();\n      }\n      if (this.readonly) {\n        this.dataElementForm.get('USE_DOMAIN').disable();\n        this.dataElementForm.get('DOMAIN_ID').disable();\n        this.dataElementForm.get('DATA_TYPE').disable();\n        this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').disable();\n      } else {\n        this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').enable();\n      }\n    } else {\n      this.dataElementForm = this.fb.group({\n        ELEMENT_ID: [this.dataElementMeta.ELEMENT_ID, {updateOn: 'blur'}],\n        ELEMENT_DESC: [this.dataElementMeta.ELEMENT_DESC],\n        LABEL_TEXT: [this.dataElementMeta.LABEL_TEXT],\n        LIST_HEADER_TEXT: [this.dataElementMeta.LIST_HEADER_TEXT],\n        DOMAIN_ID: [this.dataElementMeta.DOMAIN_ID],\n        DATA_TYPE: [{value: this.dataElementMeta.DATA_TYPE, disabled: this.readonly}],\n        DATA_LENGTH: [this.dataElementMeta.DATA_LENGTH, [this._validateDataLength]],\n        DECIMAL: [this.dataElementMeta.DECIMAL, [this._validateDecimal]],\n        SEARCH_HELP_ID: [this.dataElementMeta.SEARCH_HELP_ID],\n        SEARCH_HELP_EXPORT_FIELD: [{value: this.dataElementMeta.SEARCH_HELP_EXPORT_FIELD, disabled: this.readonly}],\n        PARAMETER_ID: [this.dataElementMeta.PARAMETER_ID],\n        USE_DOMAIN: [{value: this.dataElementMeta.DOMAIN_ID ? 1 : 0, disabled: this.readonly}]\n      });\n    }\n    this._setNewModeState();\n    if (this.dataElementForm.get('USE_DOMAIN').value) {\n      this.dataElementForm.get('DOMAIN_ID').setValidators(Validators.required);\n      this.onChangeDataDomain(this.dataElementForm);\n    } else {\n      this.dataElementForm.get('DOMAIN_ID').setErrors(null);\n      this.dataElementForm.get('DOMAIN_ID').clearValidators();\n    }\n    this._updateLengthAndDecimal(this.dataElementForm);\n  }\n\n  _setNewModeState() {\n    if (this.isNewMode) {\n      this.dataElementForm.get('ELEMENT_ID').setValidators(this._validateDataElementID);\n      this.dataElementForm.get('ELEMENT_ID').setAsyncValidators(\n        this.uniqueDataElementValidator.validate.bind(this.uniqueDataElementValidator));\n      this.dataElementForm.get('USE_DOMAIN').enable();\n      this.dataElementForm.get('DATA_TYPE').enable();\n      this.dataElementForm.get('DATA_TYPE').markAsDirty(); // Default value mark as dirty\n      this.dataElementForm.get('DATA_LENGTH').markAsDirty(); // Default value mark as dirty\n    } else {\n      this.dataElementForm.get('ELEMENT_ID').clearValidators();\n      this.dataElementForm.get('ELEMENT_ID').clearAsyncValidators() ;\n      this.dataElementForm.get('ELEMENT_ID').updateValueAndValidity();\n    }\n  }\n\n  _validateDataElementID(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Data Element ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().length > 32) {\n      return {message: 'Data Element ID must have length less than 32!'};\n    }\n    return null;\n  }\n\n  _validateDataLength(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a Length'};\n    }\n    return null;\n  }\n\n  _validateDecimal(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a decimal place'};\n    }\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Data Element?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.dataElementMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.dataElementForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateDataElementForm();\n            this.dataElementForm.reset(this.dataElementForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this._switch2EditMode();\n    }\n\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    this.dataElementForm.get('USE_DOMAIN').disable();\n    this.dataElementForm.get('DATA_TYPE').disable();\n    this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').disable();\n  }\n\n  _switch2EditMode(): void {\n    this.readonly = false;\n    this.dataElementForm.get('USE_DOMAIN').enable();\n    this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').enable();\n    this._setUseDomain(this.dataElementForm);\n  }\n\n  onChangeDataElementID(): void {\n    this.modelService.updateDataElementID(this.dataElementForm.get('ELEMENT_ID').value);\n  }\n\n  onChangeDataElementDesc(): void {\n    this.modelService.updateDataElementDesc(this.dataElementForm.get('ELEMENT_DESC').value);\n  }\n\n  onChangeUseDomain(formGroup: AbstractControl): void {\n    this._setUseDomain(formGroup, true);\n  }\n\n  onChangeDataDomain(formGroup: AbstractControl): void {\n    const dataDomainCtrl = formGroup.get('DOMAIN_ID');\n    this.entityService.getDataDomain(dataDomainCtrl.value).subscribe(data => {\n      if (data['msgCat']) {\n        dataDomainCtrl.setErrors({message: data['msgShortText']});\n      } else {\n        formGroup.get('DATA_TYPE').setValue(data['DATA_TYPE']);\n        formGroup.get('DATA_LENGTH').setValue(data['DATA_LENGTH']);\n        formGroup.get('DECIMAL').setValue(data['DECIMAL']);\n      }\n    });\n  }\n\n  _setUseDomain(formGroup: AbstractControl, markAsDirty: boolean = false): void {\n    if (formGroup.get('USE_DOMAIN').value) {\n      formGroup.get('DOMAIN_ID').enable();\n      formGroup.get('DOMAIN_ID').setValidators(Validators.required);\n      this._invalidField(formGroup.get('DATA_TYPE'), markAsDirty);\n      this._invalidField(formGroup.get('DATA_LENGTH'), markAsDirty);\n      this._invalidField(formGroup.get('DECIMAL'), markAsDirty);\n    } else {\n      this._invalidField(formGroup.get('DOMAIN_ID'), markAsDirty);\n      formGroup.get('DATA_TYPE').enable();\n      formGroup.get('DATA_TYPE').markAsDirty();\n      formGroup.get('DATA_LENGTH').enable();\n      formGroup.get('DATA_LENGTH').markAsDirty();\n      formGroup.get('DECIMAL').enable();\n      formGroup.get('DECIMAL').markAsDirty();\n      if (!formGroup.get('DATA_TYPE').value) {\n        formGroup.get('DATA_TYPE').setValue(1);\n        if (!formGroup.get('DATA_LENGTH').value) {\n          formGroup.get('DATA_LENGTH').setValue(10);\n        }\n      }\n      this._updateLengthAndDecimal(formGroup);\n    }\n  }\n\n  _invalidField(fieldCtrl: AbstractControl, markAsDirty: boolean = false): void {\n    fieldCtrl.clearValidators();\n    fieldCtrl.clearAsyncValidators();\n    fieldCtrl.disable();\n    if (markAsDirty) {\n      fieldCtrl.setValue(null);\n      fieldCtrl.markAsDirty();\n    }\n  }\n\n  onChangeDataType(formGroup: AbstractControl): void {\n    switch (+formGroup.get('DATA_TYPE').value) {\n      case 1: // char\n        formGroup.get('DATA_LENGTH').setValue(10);\n        formGroup.get('DECIMAL').setValue(null);\n        break;\n      case 4: // decimal\n        formGroup.get('DATA_LENGTH').setValue(23);\n        formGroup.get('DECIMAL').setValue(2);\n        break;\n      default:\n        formGroup.get('DATA_LENGTH').setValue(null);\n        formGroup.get('DECIMAL').setValue(null);\n    }\n    formGroup.get('DATA_LENGTH').markAsDirty();\n    formGroup.get('DECIMAL').markAsDirty();\n    this._updateLengthAndDecimal(formGroup);\n  }\n\n  _updateLengthAndDecimal(formGroup: AbstractControl): void {\n    switch (+formGroup.get('DATA_TYPE').value) {\n      case 1: // char\n        formGroup.get('DATA_LENGTH').enable();\n        formGroup.get('DATA_LENGTH').setValidators(this._validateDataLength);\n        formGroup.get('DECIMAL').disable();\n        break;\n      case 4: // decimal\n        formGroup.get('DATA_LENGTH').enable();\n        formGroup.get('DATA_LENGTH').setValidators(this._validateDataLength);\n        formGroup.get('DECIMAL').enable();\n        formGroup.get('DATA_LENGTH').setValidators(this._validateDecimal);\n        break;\n      default:\n        formGroup.get('DATA_LENGTH').disable();\n        formGroup.get('DECIMAL').disable();\n    }\n  }\n\n  onGoToDataDomain(domainID: string): void {\n    this.router.navigate(['/model/data-domain', domainID]);\n  }\n\n  onGoToSearchHelp(searchHelpID: string): void {\n    this.router.navigate(['/model/search-help', searchHelpID]);\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.dataElementForm && this.dataElementForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.dataElementForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (this.dataElementForm.invalid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedDataElement['action'] = 'add';\n      this.changedDataElement['ELEMENT_ID'] = this.dataElementForm.get('ELEMENT_ID').value;\n    } else {\n      this.changedDataElement['action'] = 'update';\n      this.changedDataElement['ELEMENT_ID'] = this.dataElementMeta.ELEMENT_ID;\n    }\n    if (this.dataElementForm.get('ELEMENT_DESC').dirty) {\n      this.changedDataElement['ELEMENT_DESC'] = this.dataElementForm.get('ELEMENT_DESC').value;\n    }\n    if (this.dataElementForm.get('DOMAIN_ID').dirty) {\n      this.changedDataElement['DOMAIN_ID'] = this.dataElementForm.get('DOMAIN_ID').value;\n    }\n    if (this.dataElementForm.get('DATA_TYPE').dirty) {\n      this.changedDataElement['DATA_TYPE'] = this.dataElementForm.get('USE_DOMAIN').value ?\n        null : this.dataElementForm.get('DATA_TYPE').value;\n    }\n    if (this.dataElementForm.get('DATA_LENGTH').dirty) {\n      this.changedDataElement['DATA_LENGTH'] = this.dataElementForm.get('USE_DOMAIN').value ?\n        null : this.dataElementForm.get('DATA_LENGTH').value;\n    }\n    if (this.dataElementForm.get('DECIMAL').dirty) {\n      this.changedDataElement['DECIMAL'] = this.dataElementForm.get('USE_DOMAIN').value ?\n        null : this.dataElementForm.get('DECIMAL').value;\n    }\n    if (this.dataElementForm.get('LABEL_TEXT').dirty) {\n      this.changedDataElement['LABEL_TEXT'] = this.dataElementForm.get('LABEL_TEXT').value;\n    }\n    if (this.dataElementForm.get('LIST_HEADER_TEXT').dirty) {\n      this.changedDataElement['LIST_HEADER_TEXT'] = this.dataElementForm.get('LIST_HEADER_TEXT').value;\n    }\n    if (this.dataElementForm.get('SEARCH_HELP_ID').dirty) {\n      this.changedDataElement['SEARCH_HELP_ID'] = this.dataElementForm.get('SEARCH_HELP_ID').value;\n    }\n    if (this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').dirty) {\n      this.changedDataElement['SEARCH_HELP_EXPORT_FIELD'] = this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').value;\n    }\n    if (this.dataElementForm.get('PARAMETER_ID').dirty) {\n      this.changedDataElement['PARAMETER_ID'] = this.dataElementForm.get('PARAMETER_ID').value;\n    }\n    this.entityService.saveDataElement(this.changedDataElement)\n      .subscribe(data => this._postActivityAfterSavingDataElement(data));\n  }\n\n  _postActivityAfterSavingDataElement(data: any) {\n    this.changedDataElement = {};\n    if (data['ELEMENT_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/data-element/' + data['ELEMENT_ID']],\n          {state: {message: this.messageService.generateMessage(\n            'MODEL', 'DATA_ELEMENT_SAVED', 'S', data['ELEMENT_ID'])}});\n      } else {\n        this._switch2DisplayMode();\n        this.dataElementMeta = data;\n        this._generateDataElementForm();\n        this.messageService.reportMessage(\n          'MODEL', 'DATA_ELEMENT_SAVED', 'S', data['ELEMENT_ID']);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport {Subject} from 'rxjs';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {DataElementH, EntityService, DataElementMeta} from 'jor-angular';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-data-element',\n  templateUrl: './data-element.component.html',\n  styleUrls: ['./data-element.component.css']\n})\nexport class DataElementComponent implements OnInit {\n  dataElementList: DataElementH[] = [];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedDataElement: DataElementH;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listDataElement(term)),\n    ).subscribe(data => {\n      this.dataElementList = data;\n      let elementID;\n      if (this.route.snapshot.firstChild) {\n        elementID = this.route.snapshot.firstChild.paramMap.get('elementID');\n      }\n      if (elementID ) {\n        if (elementID === 'new') {\n          this._newDataElement();\n        } else {\n          this.onSelect(this.dataElementList.find(dataEle => dataEle.ELEMENT_ID === elementID));\n        }\n      }\n    });\n    this.searchDataElement(''); // The initial list\n\n    this.modelService.theSelectedDataElement$.subscribe( data => {\n      if (this.theSelectedDataElement) {\n        this.theSelectedDataElement.ELEMENT_ID = data['ELEMENT_ID'];\n        this.theSelectedDataElement.ELEMENT_DESC = data['ELEMENT_DESC'];\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.dataElementList[0] && !this.dataElementList[0].CREATE_TIME) {\n        this.dataElementList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const elementID = this.route.snapshot.firstChild.paramMap.get('elementID');\n        if (elementID) {\n          if (elementID === 'new') {\n            this.onSelect(this.dataElementList[0]);\n          } else {\n            this.onSelect(this.dataElementList.find(dataElement => dataElement.ELEMENT_ID === elementID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  onSelect(dataElement: DataElementH): void {\n    if (dataElement) {\n      this.theSelectedDataElement = dataElement;\n      this.modelService.setSelectedDataElement(dataElement);\n    }\n  }\n\n  searchDataElement(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  newDataElement(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('elementID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newDataElement();\n      this.router.navigate(['/model/data-element/new']);\n    }\n  }\n\n  _newDataElement(): void {\n    this.theSelectedDataElement = new DataElementMeta();\n    this.theSelectedDataElement.ELEMENT_ID = 'new';\n    this.theSelectedDataElement.ELEMENT_DESC = 'description';\n    this.theSelectedDataElement.VERSION_NO = 1;\n    this.theSelectedDataElement.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedDataElement.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedDataElement(this.theSelectedDataElement);\n    this.dataElementList.splice(0, 0, this.theSelectedDataElement);\n  }\n}\n","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {switchMap} from 'rxjs/operators';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {msgStore} from '../../../msgStore';\nimport {forkJoin, Observable, of} from 'rxjs';\nimport {AttributeMetaComponent} from '../../attribute-meta/attribute-meta.component';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {UniqueEntityTypeValidator} from '../../model-validators';\nimport {SearchHelpMethod, SearchHelp, SearchHelpComponent, EntityService, Attribute, EntityMeta} from 'jor-angular';\n\n@Component({\n  selector: 'app-entity-type-detail',\n  templateUrl: './entity-type-detail.component.html',\n  styleUrls: ['./entity-type-detail.component.css']\n})\nexport class EntityTypeDetailComponent implements OnInit {\n  entityMeta: EntityMeta;\n  attributes: Attribute[];\n  readonly = true;\n  isNewMode = false;\n  entityTypeForm: FormGroup;\n  changedEntityType = {};\n  bypassProtection = false;\n  isSearchListShown = true;\n  roleSearchHelp: SearchHelp;\n\n  @ViewChild(AttributeMetaComponent, {static: false})\n  private attrComponent !: AttributeMetaComponent;\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent !: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueEntityTypeValidator: UniqueEntityTypeValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.messageService.setMessageStore(msgStore, 'EN');\n  }\n\n  get roleFormArray() {\n    return this.entityTypeForm.get('ROLES') as FormArray;\n  }\n\n  get attrFormArray() {\n    return this.entityTypeForm.get('ATTRIBUTES') as FormArray;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const entityID = params.get('entityID');\n        if (entityID === 'new') {\n          const entityType = new EntityMeta();\n          entityType.ENTITY_ID = '';\n          entityType.ENTITY_DESC = '';\n          entityType.ROLES = [];\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return forkJoin(of(entityType), of([]));\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return forkJoin(\n            this.entityService.getEntityMeta(entityID),\n            this.entityService.getRelationMeta(entityID));\n        }\n      })\n    ).subscribe(data => {\n      if ( 'ENTITY_ID' in data[0]) {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.entityMeta = <EntityMeta>data[0];\n        this.attributes = 'RELATION_ID' in data[1] ? data[1]['ATTRIBUTES'] : [];\n        this._generateEntityTypeForm();\n      } else {\n        this.messageService.clearMessages();\n        this.entityMeta = null;\n        this.entityTypeForm = null;\n        if (data[0] instanceof Array) {\n          data[0].forEach(err => this.messageService.add(err) );\n        } else {\n          this.messageService.report(<Message>data[0]);\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  onSearchHelp(control: AbstractControl, rowID: number): void {\n    if (!this.roleSearchHelp) {\n      this.roleSearchHelp = new SearchHelp();\n      this.roleSearchHelp.OBJECT_NAME = 'Role';\n      this.roleSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listRole(searchTerm);\n      }(this.entityService);\n      this.roleSearchHelp.BEHAVIOUR = 'A';\n      this.roleSearchHelp.MULTI = false;\n      this.roleSearchHelp.FUZZY_SEARCH = true;\n      this.roleSearchHelp.FIELDS = [\n        {FIELD_NAME: 'ROLE_ID', LIST_HEADER_TEXT: 'Role', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'ROLE_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.roleSearchHelp.READ_ONLY = this.readonly || this.oldRole(control) && control.valid;\n    }\n    const afterExportFn = function (context: any, ruleIdx: number) {\n      return () => context.onChangeRoleID(ruleIdx, true);\n    }(this, rowID).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.roleSearchHelp, control, afterExportFn);\n  }\n\n  _generateEntityTypeForm(): void {\n    this.entityTypeForm = this.fb.group({});\n    this.entityTypeForm.addControl('ENTITY_ID',\n      new FormControl(this.entityMeta.ENTITY_ID, {updateOn: 'blur'}));\n    if (this.isNewMode) {\n      this.entityTypeForm.get('ENTITY_ID').setValidators(this._validateEntityId);\n      this.entityTypeForm.get('ENTITY_ID').setAsyncValidators(\n        this.uniqueEntityTypeValidator.validate.bind(this.uniqueEntityTypeValidator));\n    }\n    this.entityTypeForm.addControl('ENTITY_DESC', new FormControl(this.entityMeta.ENTITY_DESC));\n\n    // Compose roles\n    const formArray = [];\n    this.entityMeta.ROLES.forEach( role => {\n      formArray.push(this.fb.group({\n        ROLE_ID: [role.ROLE_ID],\n        ROLE_DESC: [role.ROLE_DESC],\n        CONDITIONAL_ATTR: [{value: role.CONDITIONAL_ATTR, disabled: this.readonly}],\n        CONDITIONAL_VALUE: [role.CONDITIONAL_VALUE]\n      }));\n    });\n    if (this.isNewMode) {\n      formArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CONDITIONAL_ATTR: [''],\n          CONDITIONAL_VALUE: ['']\n        }));\n    }\n    this.entityTypeForm.addControl('ROLES', new FormArray(formArray));\n  }\n\n  _validateEntityId(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Entity ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().toLowerCase().substr(0, 2) === 'r_' ||\n        c.value.toString().toLowerCase().substr(0, 3) === 'rs_') {\n      return {message: 'Entity ID cannot be started with \"r_\" or \"rs_\"!'};\n    }\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Entity Type?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.entityMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.entityTypeForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateEntityTypeForm();\n            this.entityTypeForm.reset(this.entityTypeForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this.readonly = false;\n      this.attrComponent.switchEditDisplay(this.readonly);\n      this.roleFormArray.controls.forEach(roleFormGroup => roleFormGroup.get('CONDITIONAL_ATTR').enable());\n      this.roleFormArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CONDITIONAL_ATTR: [''],\n          CONDITIONAL_VALUE: ['']\n        })\n      );\n    }\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    this.attrComponent.switchEditDisplay(this.readonly);\n    this.roleFormArray.controls.forEach(roleFormGroup => {\n      roleFormGroup.get('CONDITIONAL_ATTR').disable();\n    });\n    let lastIndex = this.roleFormArray.length - 1;\n    while (lastIndex >= 0 && this.roleFormArray.controls[lastIndex].get('ROLE_ID').value.trim() === '') {\n      this.roleFormArray.removeAt(lastIndex);\n      lastIndex--;\n    }\n  }\n\n  onChangeEntityID(): void {\n    this.modelService.updateEntityID(this.entityTypeForm.get('ENTITY_ID').value);\n  }\n\n  onChangeEntityDesc(): void {\n    this.modelService.updateEntityDesc(this.entityTypeForm.get('ENTITY_DESC').value);\n  }\n\n  deleteRole(index: number): void {\n    if (index !== this.roleFormArray.length - 1) {\n      this.roleFormArray.removeAt(index);\n      this.roleFormArray.markAsDirty();\n    }\n  }\n\n  onChangeRoleID(index: number, isExportedFromSH?: boolean): void {\n    const currentRoleFormGroup = this.roleFormArray.controls[index];\n    if (this.roleFormArray.controls.findIndex((roleCtrl, i) =>\n      i !== index && roleCtrl.get('ROLE_ID').value === currentRoleFormGroup.get('ROLE_ID').value\n    ) !== -1) {\n      currentRoleFormGroup.get('ROLE_ID').setErrors({message: 'Duplicate roles'});\n      return;\n    }\n\n    if (index === this.roleFormArray.length - 1 && currentRoleFormGroup.value.ROLE_ID.trim() !== '') {\n      // Only work for the last New line\n      this.roleFormArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CONDITIONAL_ATTR: [''],\n          CONDITIONAL_VALUE: ['']\n        })\n      );\n    }\n\n    if (!isExportedFromSH) {\n      this.entityService.getRoleDesc(currentRoleFormGroup.value.ROLE_ID).subscribe(data => {\n        if (data['msgCat']) {\n          currentRoleFormGroup.get('ROLE_ID').setErrors({message: data['msgShortText']});\n        } else {\n          currentRoleFormGroup.get('ROLE_DESC').setValue(data);\n        }\n      });\n    }\n  }\n\n  oldRole(formGroup: AbstractControl): boolean {\n    return this.entityMeta.ROLES ?\n      this.entityMeta.ROLES.findIndex(\n        role => role.ROLE_ID === formGroup.get('ROLE_ID').value ) !== -1 :\n      false;\n  }\n\n  onGoToRole(roleID: string): void {\n    this.router.navigate(['/model/role', roleID]);\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.entityTypeForm && this.entityTypeForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.entityTypeForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (!this.entityTypeForm.valid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedEntityType['action'] = 'add';\n      this.changedEntityType['ENTITY_ID'] = this.entityTypeForm.controls['ENTITY_ID'].value;\n    } else {\n      this.changedEntityType['action'] = 'update';\n      this.changedEntityType['ENTITY_ID'] = this.entityMeta.ENTITY_ID;\n    }\n    if (this.entityTypeForm.controls['ENTITY_DESC'].dirty) {\n      this.changedEntityType['ENTITY_DESC'] = this.entityTypeForm.controls['ENTITY_DESC'].value;\n    }\n\n    this.changedEntityType['ATTRIBUTES'] = this.attrComponent.processChangedAttributes();\n    this._processChangedRoles();\n\n    this.entityService.saveEntityType(this.changedEntityType)\n      .subscribe(data => this._postActivityAfterSavingEntityType(data));\n  }\n\n  _processChangedRoles(): void {\n    const changedRoles = [];\n    if (this.roleFormArray.dirty) {\n      this.changedEntityType['ROLES'] = changedRoles;\n      let action;\n      // Add/Update Case\n      this.roleFormArray.controls.forEach(role => {\n        if (role.get('ROLE_ID').value.trim() === '') { return; }\n        const index = this.entityMeta.ROLES.findIndex(\n          existRole => role.value.ROLE_ID === existRole.ROLE_ID);\n        action = index === -1 ? 'add' : 'update';\n        if (role.dirty) {\n          const changedRole = { action: action, ROLE_ID: role.value.ROLE_ID };\n          if (role.get('CONDITIONAL_ATTR').dirty) {\n            changedRole['CONDITIONAL_ATTR'] = role.value.CONDITIONAL_ATTR;\n          }\n          if (role.get('CONDITIONAL_VALUE').dirty) {\n            changedRole['CONDITIONAL_VALUE'] = role.value.CONDITIONAL_VALUE;\n          }\n          changedRoles.push(changedRole);\n        }\n      });\n\n      // Deletion Case\n      this.entityMeta.ROLES.forEach(role => {\n        const index = this.roleFormArray.controls.findIndex(\n          roleControl => roleControl.get('ROLE_ID').value === role.ROLE_ID);\n        if (index === -1) {\n          const deletedRole = {action: 'delete', ROLE_ID: role.ROLE_ID};\n          changedRoles.push(deletedRole);\n        }\n      });\n    }\n  }\n\n  _postActivityAfterSavingEntityType(data: any) {\n    this.changedEntityType = {};\n    if (data[0] && data[0]['ENTITY_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/entity-type/' + data[0]['ENTITY_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'ENTITY_TYPE_SAVED', 'S', data[0]['ENTITY_ID'])}});\n      } else {\n        this.readonly = true;\n        this.entityMeta = data[0];\n        this.attributes = data[1].ATTRIBUTES;\n        this._generateEntityTypeForm();\n        this.messageService.reportMessage('MODEL', 'ENTITY_TYPE_SAVED', 'S',\n          this.entityMeta.ENTITY_ID);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport {EntityService} from 'jor-angular';\nimport {EntityType} from 'jor-angular';\nimport { debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {Subject} from 'rxjs';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-entity-type',\n  templateUrl: './entity-type.component.html',\n  styleUrls: ['./entity-type.component.css']\n})\nexport class EntityTypeComponent implements OnInit {\n  entityTypeList: EntityType[];\n  isSearchListShown = true;\n\n  private searchTerms = new Subject<string>();\n  private theSelectedEntityType: EntityType;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listEntityType(term)),\n    ).subscribe(data => {\n      this.entityTypeList = data;\n      let entityID;\n      if (this.route.snapshot.firstChild) {\n        entityID = this.route.snapshot.firstChild.paramMap.get('entityID');\n      }\n      if (entityID ) {\n        if (entityID === 'new') {\n          this._newEntityType();\n        } else {\n          this.onSelect(this.entityTypeList.find(entityType => entityType.ENTITY_ID === entityID));\n        }\n      }\n    });\n    this.searchEntityType(''); // The initial list\n\n    this.modelService.theSelectedEntityType$.subscribe( data => {\n      if (this.theSelectedEntityType) {\n        this.theSelectedEntityType.ENTITY_ID = data.ENTITY_ID;\n        this.theSelectedEntityType.ENTITY_DESC = data.ENTITY_DESC;\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.entityTypeList[0] && !this.entityTypeList[0].CREATE_TIME) {\n        this.entityTypeList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const entityID = this.route.snapshot.firstChild.paramMap.get('entityID');\n        if (entityID) {\n          if (entityID === 'new') {\n            this.onSelect(this.entityTypeList[0]);\n          } else {\n            this.onSelect(this.entityTypeList.find(entityType => entityType.ENTITY_ID === entityID));\n          }\n        }\n      }\n    });\n  }\n\n  onSelect(entityType: EntityType): void {\n    if (entityType) {\n      this.theSelectedEntityType = entityType;\n      this.modelService.setSelectedEntityType(entityType);\n    }\n  }\n\n  searchEntityType(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  newEntityType(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('entityID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newEntityType();\n      this.router.navigate(['/model/entity-type/new']);\n    }\n  }\n\n  _newEntityType(): void {\n    this.theSelectedEntityType = new EntityType();\n    this.theSelectedEntityType.ENTITY_ID = 'new';\n    this.theSelectedEntityType.ENTITY_DESC = 'description';\n    this.theSelectedEntityType.VERSION_NO = 1;\n    this.theSelectedEntityType.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedEntityType.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedEntityType(this.theSelectedEntityType);\n    this.entityTypeList.splice(0, 0, this.theSelectedEntityType);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport {RouterModule, Routes} from '@angular/router';\nimport {ModelComponent} from './model.component';\nimport {EntityTypeComponent} from './entity-type/entity-type.component';\nimport {EntityTypeDetailComponent} from './entity-type/entity-type-detail/entity-type-detail.component';\nimport {RelationComponent} from './relation/relation.component';\nimport {RelationDetailComponent} from './relation/relation-detail/relation-detail.component';\nimport {WorkProtectionGuard} from '../work-protection.guard';\nimport {RelationshipComponent} from './relationship/relationship.component';\nimport {RelationshipDetailComponent} from './relationship/relationship-detail/relationship-detail.component';\nimport {RoleComponent} from './role/role.component';\nimport {RoleDetailComponent} from './role/role-detail/role-detail.component';\nimport {DataElementComponent} from './data-element/data-element.component';\nimport {DataDomainComponent} from './data-domain/data-domain.component';\nimport {DataDomainDetailComponent} from './data-domain/data-domain-detail/data-domain-detail.component';\nimport {DataElementDetailComponent} from './data-element/data-element-detail/data-element-detail.component';\nimport {SearchHelpComponent} from './search-help/search-help.component';\nimport {SearchHelpDetailComponent} from './search-help/search-help-detail/search-help-detail.component';\n\nconst routes: Routes = [\n  { path: '',\n    component: ModelComponent,\n    children: [\n      { path: 'entity-type', component: EntityTypeComponent,\n        children: [{ path: ':entityID', canDeactivate: [WorkProtectionGuard], component: EntityTypeDetailComponent }] },\n      { path: 'role', component: RoleComponent,\n        children: [{ path: ':roleID', canDeactivate: [WorkProtectionGuard], component: RoleDetailComponent }] },\n      { path: 'relation', component: RelationComponent,\n        children: [{ path: ':relationID', canDeactivate: [WorkProtectionGuard], component: RelationDetailComponent }] },\n      { path: 'relationship', component: RelationshipComponent,\n        children: [{ path: ':relationshipID', canDeactivate: [WorkProtectionGuard], component: RelationshipDetailComponent }] },\n      { path: 'data-element', component: DataElementComponent,\n        children: [{ path: ':elementID', canDeactivate: [WorkProtectionGuard], component: DataElementDetailComponent }] },\n      { path: 'data-domain', component: DataDomainComponent,\n        children: [{ path: ':domainID', canDeactivate: [WorkProtectionGuard], component: DataDomainDetailComponent }] },\n      { path: 'search-help', component: SearchHelpComponent,\n        children: [{ path: ':searchHelpID', canDeactivate: [WorkProtectionGuard], component: SearchHelpDetailComponent }] },\n      { path: '**', redirectTo: '/model/entity-type', pathMatch: 'full' },\n    ]\n  }\n];\n\n@NgModule({\n  imports: [\n    RouterModule.forChild(routes)\n  ],\n  exports: [ RouterModule ]\n})\nexport class ModelRoutingModule { }\n","import { Injectable } from '@angular/core';\nimport {AbstractControl, AsyncValidator, ValidationErrors} from '@angular/forms';\nimport {EntityService} from 'jor-angular';\nimport {Observable, of} from 'rxjs';\nimport {catchError, map} from 'rxjs/operators';\nimport {ModelService} from './model.service';\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueSearchHelpValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    return this.entityService.getSearchHelpDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'SEARCH_HELP_NOT_EXIST') {\n          this.modelService.updateSearchHelpID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueDataDomainValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    return this.entityService.getDataDomainDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'DATA_DOMAIN_NOT_EXIST') {\n          this.modelService.updateDataDomainID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueDataElementValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    return this.entityService.getDataElementDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'DATA_ELEMENT_NOT_EXIST') {\n          this.modelService.updateDataElementID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueRoleValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    return this.entityService.getRoleDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'ROLE_NOT_EXIST') {\n          this.modelService.updateRoleID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueRelationValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    if (ctrl.value === 'r_') { return of(null); }\n    return this.entityService.getRelationDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'RELATION_NOT_EXIST') {\n          this.modelService.updateRelationID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueRelationshipValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    if (ctrl.value === 'rs_') { return of(null); }\n    return this.entityService.getRelationshipDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'RELATIONSHIP_NOT_EXIST') {\n          this.modelService.updateRelationshipID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueEntityTypeValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    return this.entityService.getEntityTypeDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'ENTITY_TYPE_NOT_EXIST') {\n          this.modelService.updateEntityID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-model',\n  templateUrl: './model.component.html',\n  styleUrls: ['./model.component.css']\n})\nexport class ModelComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ModelComponent } from './model.component';\nimport { ModelRoutingModule } from './model-routing.module';\nimport {NgbModule} from '@ng-bootstrap/ng-bootstrap';\nimport { EntityTypeComponent } from './entity-type/entity-type.component';\nimport {HttpClientModule} from '@angular/common/http';\nimport { EntityTypeDetailComponent } from './entity-type/entity-type-detail/entity-type-detail.component';\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\nimport { AttributeMetaComponent } from './attribute-meta/attribute-meta.component';\nimport {MessageModule} from 'ui-message-angular';\nimport { RelationComponent } from './relation/relation.component';\nimport {RelationDetailComponent} from './relation/relation-detail/relation-detail.component';\nimport { RelationshipComponent } from './relationship/relationship.component';\nimport { RelationshipDetailComponent } from './relationship/relationship-detail/relationship-detail.component';\nimport { RoleComponent } from './role/role.component';\nimport { RoleDetailComponent } from './role/role-detail/role-detail.component';\nimport { DataElementComponent } from './data-element/data-element.component';\nimport { DataDomainComponent } from './data-domain/data-domain.component';\nimport { DataDomainDetailComponent } from './data-domain/data-domain-detail/data-domain-detail.component';\nimport { DataElementDetailComponent } from './data-element/data-element-detail/data-element-detail.component';\nimport { SearchHelpComponent } from './search-help/search-help.component';\nimport { SearchHelpDetailComponent } from './search-help/search-help-detail/search-help-detail.component';\nimport {JorAngularModule} from 'jor-angular';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    FormsModule,\n    ReactiveFormsModule,\n    ModelRoutingModule,\n    MessageModule,\n    NgbModule,\n    JorAngularModule\n  ],\n  declarations: [\n    ModelComponent,\n    EntityTypeComponent,\n    EntityTypeDetailComponent,\n    AttributeMetaComponent,\n    RelationComponent,\n    RelationDetailComponent,\n    RelationshipComponent,\n    RelationshipDetailComponent,\n    RoleComponent,\n    RoleDetailComponent,\n    DataElementComponent,\n    DataElementDetailComponent,\n    DataDomainComponent,\n    DataDomainDetailComponent,\n    SearchHelpComponent,\n    SearchHelpDetailComponent\n  ]\n})\nexport class ModelModule { }\n","import { Injectable } from '@angular/core';\nimport {EntityType, Relation, RelationshipH, RoleH, DataDomainH, DataElementH, SearchHelpH} from 'jor-angular';\nimport {Subject} from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ModelService {\n  dataTypes = [\n    {key: 1, value: 'Char'},\n    {key: 2, value: 'Integer'},\n    {key: 3, value: 'Boolean'},\n    {key: 4, value: 'Decimal'},\n    {key: 5, value: 'String'},\n    {key: 6, value: 'Binary'},\n    {key: 7, value: 'Date'},\n    {key: 8, value: 'Timestamp'}\n  ];\n\n  private dialogAnswer = new Subject<string>();\n  dialogAnswer$ = this.dialogAnswer.asObservable();\n\n  private isSearchListShown = new Subject<boolean>();\n  isSearchListShown$ = this.isSearchListShown.asObservable();\n\n  private theSelectedEntityType: EntityType;\n  private selectedEntityTypeSource = new Subject<EntityType>();\n  theSelectedEntityType$ = this.selectedEntityTypeSource.asObservable();\n\n  private theSelectedRelation: Relation;\n  private selectedRelationSource = new Subject<Relation>();\n  theSelectedRelation$ = this.selectedRelationSource.asObservable();\n\n  private theSelectedRelationship: RelationshipH;\n  private selectedRelationshipSource = new Subject<RelationshipH>();\n  theSelectedRelationship$ = this.selectedRelationshipSource.asObservable();\n\n  private theSelectedRole: RoleH;\n  private selectedRoleSource = new Subject<RoleH>();\n  theSelectedRole$ = this.selectedRoleSource.asObservable();\n\n  private theSelectedDataElement: DataElementH;\n  private selectedDataElementSource = new Subject<DataElementH>();\n  theSelectedDataElement$ = this.selectedDataElementSource.asObservable();\n\n  private theSelectedDataDomain: DataDomainH;\n  private selectedDataDomainSource = new Subject<DataDomainH>();\n  theSelectedDataDomain$ = this.selectedDataDomainSource.asObservable();\n\n  private theSelectedSearchHelp: SearchHelpH;\n  private selectedSearchHelpSource = new Subject<SearchHelpH>();\n  theSelectedSearchHelp$ = this.selectedSearchHelpSource.asObservable();\n\n  showSearchList(): void {\n    this.isSearchListShown.next(true);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown.next(false);\n  }\n  updateEntityID(entityID: string) {\n    this.theSelectedEntityType.ENTITY_ID = entityID;\n    this.selectedEntityTypeSource.next(this.theSelectedEntityType);\n  }\n\n  updateEntityDesc(entityDesc: string) {\n    this.theSelectedEntityType.ENTITY_DESC = entityDesc;\n    this.selectedEntityTypeSource.next(this.theSelectedEntityType);\n  }\n\n  setSelectedEntityType(entityType: EntityType): void {\n    this.theSelectedEntityType = entityType;\n  }\n\n  updateRelationID(relationID: string) {\n    this.theSelectedRelation.RELATION_ID = relationID;\n    this.selectedRelationSource.next(this.theSelectedRelation);\n  }\n\n  updateRelationDesc(relationDesc: string) {\n    this.theSelectedRelation.RELATION_DESC = relationDesc;\n    this.selectedRelationSource.next(this.theSelectedRelation);\n  }\n\n  setSelectedRelation(relation: Relation): void {\n    this.theSelectedRelation = relation;\n  }\n\n  updateRelationshipID(relationshipID: string) {\n    this.theSelectedRelationship.RELATIONSHIP_ID = relationshipID;\n    this.selectedRelationshipSource.next(this.theSelectedRelationship);\n  }\n\n  updateRelationshipDesc(relationshipDesc: string) {\n    this.theSelectedRelationship.RELATIONSHIP_DESC = relationshipDesc;\n    this.selectedRelationshipSource.next(this.theSelectedRelationship);\n  }\n\n  setSelectedRelationship(relationship: RelationshipH): void {\n    this.theSelectedRelationship = relationship;\n  }\n\n  updateRoleID(roleID: string) {\n    this.theSelectedRole.ROLE_ID = roleID;\n    this.selectedRoleSource.next(this.theSelectedRole);\n  }\n\n  updateRoleDesc(roleDesc: string) {\n    this.theSelectedRole.ROLE_DESC = roleDesc;\n    this.selectedRoleSource.next(this.theSelectedRole);\n  }\n\n  setSelectedRole(role: RoleH): void {\n    this.theSelectedRole = role;\n  }\n\n  updateDataElementID(elementID: string) {\n    this.theSelectedDataElement.ELEMENT_ID = elementID;\n    this.selectedDataElementSource.next(this.theSelectedDataElement);\n  }\n\n  updateDataElementDesc(elementDesc: string) {\n    this.theSelectedDataElement.ELEMENT_DESC = elementDesc;\n    this.selectedDataElementSource.next(this.theSelectedDataElement);\n  }\n\n  setSelectedDataElement(element: DataElementH): void {\n    this.theSelectedDataElement = element;\n  }\n\n  updateDataDomainID(domainID: string) {\n    this.theSelectedDataDomain.DOMAIN_ID = domainID;\n    this.selectedDataDomainSource.next(this.theSelectedDataDomain);\n  }\n\n  updateDataDomainDesc(domainDesc: string) {\n    this.theSelectedDataDomain.DOMAIN_DESC = domainDesc;\n    this.selectedDataDomainSource.next(this.theSelectedDataDomain);\n  }\n\n  setSelectedDataDomain(domain: DataDomainH): void {\n    this.theSelectedDataDomain = domain;\n  }\n\n  updateSearchHelpID(searchHelpID: string) {\n    this.theSelectedSearchHelp.SEARCH_HELP_ID = searchHelpID;\n    this.selectedSearchHelpSource.next(this.theSelectedSearchHelp);\n  }\n\n  updateSearchHelpDesc(searchHelpDesc: string) {\n    this.theSelectedSearchHelp.SEARCH_HELP_DESC = searchHelpDesc;\n    this.selectedSearchHelpSource.next(this.theSelectedSearchHelp);\n  }\n\n  setSelectedSearchHelp(searchHelp: SearchHelpH): void {\n    this.theSelectedSearchHelp = searchHelp;\n  }\n\n  sendDialogAnswer(answer: string): void {\n    this.dialogAnswer.next(answer);\n  }\n}\n","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {Association, RelationMeta} from 'jor-angular';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {EntityService} from 'jor-angular';\nimport {msgStore} from '../../../msgStore';\nimport {switchMap} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\nimport {AttributeMetaComponent} from '../../attribute-meta/attribute-meta.component';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {UniqueRelationValidator} from '../../model-validators';\nimport {SearchHelpComponent} from 'jor-angular';\nimport {SearchHelp, SearchHelpMethod} from 'jor-angular';\n\n@Component({\n  selector: 'app-relation-detail',\n  templateUrl: './relation-detail.component.html',\n  styleUrls: ['./relation-detail.component.css']\n})\nexport class RelationDetailComponent implements OnInit {\n  relationMeta: RelationMeta;\n  readonly = true;\n  isNewMode = false;\n  isFieldMapShown = false;\n  relationForm: FormGroup;\n  currentAssociationForm: AbstractControl;\n  currentAssociation: Association;\n  currentRightRelationMeta: RelationMeta;\n  changedRelation = {};\n  bypassProtection = false;\n  isSearchListShown = true;\n  relationSearchHelp: SearchHelp;\n\n  @ViewChild(AttributeMetaComponent, {static: false})\n  private attrComponent!: AttributeMetaComponent;\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent!: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueRelationValidator: UniqueRelationValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.messageService.setMessageStore(msgStore, 'EN');\n  }\n\n  get associationFormArray() {\n    return this.relationForm.get('ASSOCIATIONS') as FormArray;\n  }\n  get fieldMapFormArray() {\n    if (this.currentAssociationForm) {\n      return this.currentAssociationForm.get('FIELDS_MAPPING') as FormArray;\n    } else {\n      return null;\n    }\n  }\n  get displayFieldMapModal() {\n    return this.isFieldMapShown ? 'block' : 'none';\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const relationID = params.get('relationID');\n        if (relationID === 'new') {\n          const relation = new RelationMeta();\n          relation.RELATION_ID = 'r_';\n          relation.RELATION_DESC = '';\n          relation.ATTRIBUTES = [];\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return of(relation);\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return this.entityService.getRelationMeta(params.get('relationID'));\n        }\n      })\n    ).subscribe(data => {\n      if ( 'RELATION_ID' in data) { // If the return data is a message\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.relationMeta = <RelationMeta>data;\n        this._generateRelationForm();\n      } else {\n        this.messageService.clearMessages();\n        this.relationMeta = null;\n        this.relationForm = null;\n        if (data instanceof Array) {\n          data.forEach(err => this.messageService.add(err));\n        } else {\n          this.messageService.report(<Message>data);\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  onSearchHelp(fieldName: string, control: AbstractControl, rowID: number): void {\n    if (!this.relationSearchHelp) {\n      this.relationSearchHelp = new SearchHelp();\n      this.relationSearchHelp.OBJECT_NAME = 'Relation';\n      this.relationSearchHelp.METHOD = function (entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listRelation(searchTerm);\n      }(this.entityService);\n      this.relationSearchHelp.BEHAVIOUR = 'A';\n      this.relationSearchHelp.MULTI = false;\n      this.relationSearchHelp.FUZZY_SEARCH = true;\n      this.relationSearchHelp.FIELDS = [\n        {\n          FIELD_NAME: 'RELATION_ID', LIST_HEADER_TEXT: 'Relation', IMPORT: true, EXPORT: true, IE_FIELD_NAME: fieldName,\n          LIST_POSITION: 1, FILTER_POSITION: 0\n        },\n        {FIELD_NAME: 'RELATION_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.relationSearchHelp.READ_ONLY = this.readonly;\n    }\n    const afterExportFn = function (context: any, ruleIdx: number) {\n      return () => context.onChangeRightRelationID(ruleIdx, true);\n    }(this, rowID).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.relationSearchHelp, control, afterExportFn);\n  }\n\n  _generateRelationForm(): void {\n    this.relationForm = this.fb.group({});\n    this.relationForm.addControl('RELATION_ID', new FormControl(this.relationMeta.RELATION_ID, {updateOn: 'blur'}));\n    if (this.isNewMode) {\n      this.relationForm.get('RELATION_ID').setValidators(this._validateRelationId);\n      this.relationForm.get('RELATION_ID').setAsyncValidators(this.uniqueRelationValidator.validate.bind(this.uniqueRelationValidator));\n    }\n    this.relationForm.addControl('RELATION_DESC', new FormControl(this.relationMeta.RELATION_DESC));\n\n    // Compose Associations\n    const formArray = [];\n    if (this.relationMeta.ASSOCIATIONS) {\n      this.relationMeta.ASSOCIATIONS.forEach( association => {\n        const fieldsMapArray = [];\n        association.FIELDS_MAPPING.forEach( fieldsMap => {\n          fieldsMapArray.push(this.fb.group({\n            LEFT_FIELD: [fieldsMap.LEFT_FIELD],\n            RIGHT_FIELD: [fieldsMap.RIGHT_FIELD]\n          }));\n        });\n        formArray.push(this.fb.group({\n          ASSOCIATION_NAME: [association.ASSOCIATION_NAME],\n          RIGHT_RELATION_ID: [association.RIGHT_RELATION_ID],\n          CARDINALITY: [{value: association.CARDINALITY, disabled: this.readonly}],\n          FOREIGN_KEY_CHECK: [{\n            value: association.FOREIGN_KEY_CHECK,\n            disabled: this.readonly || association.CARDINALITY === '[0..1]' || association.CARDINALITY === '[0..N]'}],\n          FIELDS_MAPPING: this.fb.array(fieldsMapArray)\n        }));\n      });\n    }\n\n    if (this.isNewMode) {\n      this._appendEmptyAssociation(formArray);\n    }\n    this.relationForm.addControl('ASSOCIATIONS', new FormArray(formArray));\n  }\n\n  _appendEmptyAssociation(formArray: any) {\n    formArray.push(\n      this.fb.group({\n        ASSOCIATION_NAME: [''],\n        RIGHT_RELATION_ID: [''],\n        CARDINALITY: ['[0..1]'],\n        FOREIGN_KEY_CHECK: [{value: 0, disabled: true}],\n        FIELDS_MAPPING: this.fb.array([])\n    }));\n  }\n\n  _validateRelationId(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Relation ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().toLowerCase().substr(0, 2) !== 'r_') {\n      return {message: 'Relation name must be started with \"r_\"!'};\n    }\n\n    if (c.value.toString().length < 3) {\n      return {message: 'Relation name must have length larger than 2!'};\n    }\n\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Entity Type?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.relationMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.relationForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateRelationForm();\n            this.relationForm.reset(this.relationForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this.readonly = false;\n      this.associationFormArray.controls.forEach(associationFormGroup => {\n        associationFormGroup.get('CARDINALITY').enable();\n        if ( associationFormGroup.get('CARDINALITY').value === '[1..1]' ||\n             associationFormGroup.get('CARDINALITY').value === '[1..N]' ) {\n          associationFormGroup.get('FOREIGN_KEY_CHECK').enable();\n        }\n      });\n      this._appendEmptyAssociation(this.associationFormArray);\n      this.attrComponent.switchEditDisplay(this.readonly);\n    }\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    let lastIndex = this.associationFormArray.length - 1;\n    while (lastIndex >= 0 && this.associationFormArray.controls[lastIndex].get('ASSOCIATION_NAME').value.trim() === '') {\n      this.associationFormArray.removeAt(lastIndex);\n      lastIndex--;\n    }\n    this.associationFormArray.controls.forEach(associationFormGroup => {\n      associationFormGroup.get('CARDINALITY').disable();\n      associationFormGroup.get('FOREIGN_KEY_CHECK').disable();\n    });\n    this.attrComponent.switchEditDisplay(this.readonly);\n  }\n\n  onChangeRelationID(): void {\n    this.modelService.updateRelationID(this.relationForm.get('RELATION_ID').value);\n  }\n\n  onChangeRelationDesc(): void {\n    this.modelService.updateRelationDesc(this.relationForm.get('RELATION_DESC').value);\n  }\n\n  deleteAssociation(index: number): void {\n    if (index !== this.associationFormArray.length - 1) {\n      this.associationFormArray.removeAt(index);\n      this.associationFormArray.markAsDirty();\n    }\n  }\n\n  openFieldMapModal(index: number): void {\n    this.currentAssociationForm = this.associationFormArray.controls[index];\n    if (this.currentAssociationForm.get('RIGHT_RELATION_ID').value.trim() === '') {\n      return;\n    }\n\n    this.entityService.getRelationMeta(this.currentAssociationForm.get('RIGHT_RELATION_ID').value)\n      .subscribe( data => {\n        this.currentRightRelationMeta = <RelationMeta>data;\n      });\n\n    if (this.readonly === false) {\n      this.fieldMapFormArray.push(this.fb.group({LEFT_FIELD: [''], RIGHT_FIELD: ['']}));\n    }\n    this.currentAssociation = this.relationMeta.ASSOCIATIONS ? this.relationMeta.ASSOCIATIONS[index] : null;\n    this.isFieldMapShown = true;\n  }\n\n  closeFieldMapModal(): void {\n    // this.currentAssociationForm.setValue(this.currentAssociationForm.value); // Or the value won't be updated.\n    let lastIndex = this.fieldMapFormArray.length - 1;\n    while (lastIndex >= 0 && this.fieldMapFormArray.controls[lastIndex].get('RIGHT_FIELD').value.trim() === '') {\n      this.fieldMapFormArray.removeAt(lastIndex);\n      lastIndex--;\n    }\n    this.isFieldMapShown = false;\n  }\n\n  deleteFieldMap(index: number): void {\n    if (index !== this.fieldMapFormArray.length - 1) {\n      this.fieldMapFormArray.removeAt(index);\n      this.fieldMapFormArray.markAsDirty();\n    }\n  }\n\n  onChangeAssociationName(index: number): void {\n    const currentAssocFormGroup = this.associationFormArray.at(index);\n    if (this.associationFormArray.controls.findIndex((assocCtrl, i) =>\n      i !== index && assocCtrl.get('ASSOCIATION_NAME').value === currentAssocFormGroup.get('ASSOCIATION_NAME').value\n    ) !== -1) {\n      currentAssocFormGroup.get('ASSOCIATION_NAME').setErrors({message: 'Duplicate association name!'});\n      return;\n    }\n\n    if (index === this.associationFormArray.length - 1 && currentAssocFormGroup.value.ASSOCIATION_NAME.trim() !== '') {\n      this._appendEmptyAssociation(this.associationFormArray);\n    }\n  }\n\n  onChangeRightRelationID(index: number, isExportedFromSH?: boolean): void {\n    const currentAssocFormGroup = this.associationFormArray.controls[index];\n\n    if (currentAssocFormGroup.get('RIGHT_RELATION_ID').value === this.relationMeta.RELATION_ID) {\n      currentAssocFormGroup.get('RIGHT_RELATION_ID').setErrors({message: 'Self association is not allowed'});\n      return;\n    }\n\n    if (!isExportedFromSH) {\n      this.entityService.getRelationDesc(currentAssocFormGroup.value.RIGHT_RELATION_ID)\n        .subscribe(data => {\n          if (data['msgCat']) {\n            currentAssocFormGroup.get('RIGHT_RELATION_ID').setErrors({message: data['msgShortText']});\n          }\n        });\n    }\n  }\n\n  onChangeCardinality(formGroup: AbstractControl): void {\n    const cardinality = formGroup.get('CARDINALITY');\n    if ( cardinality.value === '[1..1]' || cardinality.value === '[1..n]' ) {\n      formGroup.get('FOREIGN_KEY_CHECK').enable();\n    } else {\n      formGroup.get('FOREIGN_KEY_CHECK').setValue(0);\n      formGroup.get('FOREIGN_KEY_CHECK').markAsDirty();\n      formGroup.get('FOREIGN_KEY_CHECK').disable();\n    }\n  }\n\n  onChangeLeftField(index: number): void {\n    const currentFieldMapFormGroup = this.fieldMapFormArray.controls[index];\n    if (this.relationMeta.ATTRIBUTES.findIndex( attribute =>\n        attribute.ATTR_NAME === currentFieldMapFormGroup.get('LEFT_FIELD').value) === -1) {\n      currentFieldMapFormGroup.get('LEFT_FIELD').setErrors({message: 'Field Not Exist'});\n      return;\n    }\n\n    if (this.fieldMapFormArray.controls.findIndex((fieldMapCtrl, i) =>\n      i !== index && fieldMapCtrl.get('LEFT_FIELD') && fieldMapCtrl.get('RIGHT_FIELD') &&\n      fieldMapCtrl.get('LEFT_FIELD').value === currentFieldMapFormGroup.get('LEFT_FIELD').value &&\n      fieldMapCtrl.get('RIGHT_FIELD').value === currentFieldMapFormGroup.get('RIGHT_FIELD').value\n    ) !== -1) {\n      currentFieldMapFormGroup.get('LEFT_FIELD').setErrors({message: 'Duplicate Fields Mapping'});\n      return;\n    }\n\n    if (index === this.fieldMapFormArray.length - 1 && currentFieldMapFormGroup.value.LEFT_FIELD.trim() !== '') {\n      this.fieldMapFormArray.push(\n        this.fb.group( {LEFT_FIELD: [''], RIGHT_FIELD: ['']})\n      );\n    }\n  }\n\n  onChangeRightField(index: number): void {\n    const currentFieldMapFormGroup = this.fieldMapFormArray.controls[index];\n    if (this.currentRightRelationMeta &&\n        this.currentRightRelationMeta.ATTRIBUTES.findIndex( attribute =>\n          attribute.ATTR_NAME === currentFieldMapFormGroup.get('RIGHT_FIELD').value) === -1) {\n      currentFieldMapFormGroup.get('RIGHT_FIELD').setErrors({message: 'Field Not Exist'});\n      return;\n    }\n\n    if (this.fieldMapFormArray.controls.findIndex((fieldMapCtrl, i) =>\n      i !== index && fieldMapCtrl.get('LEFT_FIELD') && fieldMapCtrl.get('RIGHT_FIELD') &&\n      fieldMapCtrl.get('LEFT_FIELD').value === currentFieldMapFormGroup.get('LEFT_FIELD').value &&\n      fieldMapCtrl.get('RIGHT_FIELD').value === currentFieldMapFormGroup.get('RIGHT_FIELD').value\n    ) !== -1) {\n      currentFieldMapFormGroup.get('RIGHT_FIELD').setErrors({message: 'Duplicate Fields Mapping'});\n      return;\n    }\n\n    if (index === this.fieldMapFormArray.length - 1 && currentFieldMapFormGroup.value.RIGHT_FIELD.trim() !== '') {\n      this.fieldMapFormArray.push(\n        this.fb.group( {LEFT_FIELD: [''], RIGHT_FIELD: ['']})\n      );\n    }\n  }\n\n  oldAssociationName(formGroup: AbstractControl): boolean {\n    return this.relationMeta.ASSOCIATIONS ?\n      this.relationMeta.ASSOCIATIONS.findIndex(\n      association => association.ASSOCIATION_NAME === formGroup.get('ASSOCIATION_NAME').value ) !== -1 :\n      false;\n  }\n\n  oldFieldMap(formGroup: AbstractControl): boolean {\n    return this.currentAssociation ?\n      this.currentAssociation.FIELDS_MAPPING.findIndex(\n      fieldMap => fieldMap.LEFT_FIELD === formGroup.get('LEFT_FIELD').value &&\n                            fieldMap.RIGHT_FIELD === formGroup.get('RIGHT_FIELD').value ) !== -1 :\n      false;\n  }\n\n  onGoToRelation(relationID: string): void {\n    this.router.navigate(['/model/relation', relationID]);\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.relationForm && this.relationForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.relationForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (!this.relationForm.valid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedRelation['action'] = 'add';\n      this.changedRelation['RELATION_ID'] = this.relationForm.controls['RELATION_ID'].value;\n    } else {\n      this.changedRelation['action'] = 'update';\n      this.changedRelation['RELATION_ID'] = this.relationMeta.RELATION_ID;\n    }\n    if (this.relationForm.controls['RELATION_DESC'].dirty) {\n      this.changedRelation['RELATION_DESC'] = this.relationForm.controls['RELATION_DESC'].value;\n    }\n\n    const checkErrs = this.attrComponent.checkAttributes();\n    if (checkErrs.length > 0) {\n      checkErrs.forEach( errMsg => this.messageService.add( errMsg ) );\n      return;\n    }\n    this.changedRelation['ATTRIBUTES'] = this.attrComponent.processChangedAttributes();\n    if (!this._processChangedAssociation()) {\n      return;\n    }\n\n    this.entityService.saveRelation(this.changedRelation)\n      .subscribe(data => this._postActivityAfterSavingRelation(data));\n  }\n\n  _processChangedAssociation(): boolean {\n    const changedAssociations = [];\n    const errMessages = [];\n    if (!this.associationFormArray.dirty) { return true; }\n\n    this.changedRelation['ASSOCIATIONS'] = changedAssociations;\n\n    this.associationFormArray.controls.forEach(associationControl => {\n      if (!associationControl.get('ASSOCIATION_NAME').value ||\n          !associationControl.get('RIGHT_RELATION_ID').value) { return; }\n      const changedAssociation = {};\n      const associationMeta = this.relationMeta.ASSOCIATIONS.find(\n        association => associationControl.get('ASSOCIATION_NAME').value === association.ASSOCIATION_NAME);\n      if (!associationMeta) {// New Add Case\n        changedAssociation['action'] = 'add';\n        changedAssociation['ASSOCIATION_NAME'] = associationControl.get('ASSOCIATION_NAME').value;\n        changedAssociation['RIGHT_RELATION_ID'] = associationControl.get('RIGHT_RELATION_ID').value;\n        changedAssociation['CARDINALITY'] = associationControl.get('CARDINALITY').value;\n        changedAssociation['FOREIGN_KEY_CHECK'] = associationControl.get('FOREIGN_KEY_CHECK').value;\n        changedAssociation['FIELDS_MAPPING'] = [];\n        const fieldMapArray = associationControl.get('FIELDS_MAPPING') as FormArray;\n        if (fieldMapArray.length === 0) {\n          errMessages.push(this.messageService.generateMessage(\n            'MODEL', 'MISS_RELATION_ASSOCIATION_FIELD_MAPPING', 'E', changedAssociation['RIGHT_RELATION_ID']));\n          return;\n        }\n        fieldMapArray.controls.forEach(fieldMap => {\n          changedAssociation['FIELDS_MAPPING'].push(\n            {action: 'add', RIGHT_FIELD: fieldMap.get('RIGHT_FIELD').value, LEFT_FIELD: fieldMap.get('LEFT_FIELD').value});\n        });\n        changedAssociations.push(changedAssociation);\n      } else {\n        if (associationControl.dirty) {// Change Case\n          changedAssociation['action'] = 'update';\n          changedAssociation['ASSOCIATION_NAME'] = associationControl.get('ASSOCIATION_NAME').value;\n          if (associationControl.get('RIGHT_RELATION_ID').dirty) {\n            changedAssociation['RIGHT_RELATION_ID'] = associationControl.get('RIGHT_RELATION_ID').value;\n          }\n          if (associationControl.get('CARDINALITY').dirty) {\n            changedAssociation['CARDINALITY'] = associationControl.get('CARDINALITY').value;\n          }\n          if (associationControl.get('FOREIGN_KEY_CHECK').dirty) {\n            changedAssociation['FOREIGN_KEY_CHECK'] = associationControl.get('FOREIGN_KEY_CHECK').value;\n          }\n          if (associationControl.get('FIELDS_MAPPING').dirty) {\n            changedAssociation['FIELDS_MAPPING'] = [];\n            const fieldMapArray = associationControl.get('FIELDS_MAPPING') as FormArray;\n            if (fieldMapArray.length === 0) {\n              errMessages.push(this.messageService.generateMessage(\n                'MODEL', 'MISS_RELATION_ASSOCIATION_FIELD_MAPPING', 'E', changedAssociation['RIGHT_RELATION_ID']));\n              return;\n            }\n            fieldMapArray.controls.forEach(fieldMap => {\n              if (fieldMap.dirty) {\n                changedAssociation['FIELDS_MAPPING'].push(\n                  {action: 'add', RIGHT_FIELD: fieldMap.get('RIGHT_FIELD').value, LEFT_FIELD: fieldMap.get('LEFT_FIELD').value});\n              }\n            });\n            associationMeta.FIELDS_MAPPING.forEach( oldFieldMap => {\n              const index = fieldMapArray.controls.findIndex(fieldMap =>\n                fieldMap.get('LEFT_FIELD').value === oldFieldMap.LEFT_FIELD &&\n                fieldMap.get('RIGHT_FIELD').value === oldFieldMap.RIGHT_FIELD);\n              if (index === -1) {\n                changedAssociation['FIELDS_MAPPING'].push(\n                  {action: 'delete', RIGHT_FIELD: oldFieldMap.LEFT_FIELD, LEFT_FIELD: oldFieldMap.RIGHT_FIELD});\n              }\n            });\n          }\n          changedAssociations.push(changedAssociation);\n        }\n      }\n    });\n    if (errMessages.length > 0) {\n      errMessages.forEach( errMessage => this.messageService.add(errMessage));\n      return false;\n    }\n    // Deletion Case\n    this.relationMeta.ASSOCIATIONS.forEach(associationMeta => {\n      const index = this.associationFormArray.controls.findIndex(\n        associationControl => associationControl.get('ASSOCIATION_NAME').value === associationMeta.ASSOCIATION_NAME);\n      if (index === -1) { // The association must be deleted\n        changedAssociations.push({action: 'delete', ASSOCIATION_NAME: associationMeta.ASSOCIATION_NAME});\n      }\n    });\n    return true;\n  }\n\n  _postActivityAfterSavingRelation(data: any) {\n    this.changedRelation = {};\n    if (data['RELATION_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/relation/' + data['RELATION_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'RELATION_SAVED', 'S', data['RELATION_ID'])}});\n      } else {\n        this.readonly = true;\n        this.relationMeta = data;\n        this._generateRelationForm();\n        this.messageService.reportMessage('MODEL', 'RELATION_SAVED', 'S', data['RELATION_ID']);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport {Relation} from 'jor-angular';\nimport {Subject} from 'rxjs';\nimport {EntityService} from 'jor-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-relation',\n  templateUrl: './relation.component.html',\n  styleUrls: ['./relation.component.css']\n})\nexport class RelationComponent implements OnInit {\n\n  relationList: Relation[];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedRelation: Relation;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listRelation(term)),\n    ).subscribe(data => {\n      this.relationList = data;\n      let relationID;\n      if (this.route.snapshot.firstChild) {\n        relationID = this.route.snapshot.firstChild.paramMap.get('relationID');\n      }\n      if (relationID) {\n        if (relationID === 'new') {\n          this._newRelation();\n        } else {\n          this.onSelect(this.relationList.find(relation => relation.RELATION_ID === relationID));\n        }\n      }\n    });\n    this.searchRelation(''); // The initial list\n\n    this.modelService.theSelectedRelation$.subscribe( data => {\n      if (this.theSelectedRelation) {\n        this.theSelectedRelation.RELATION_ID = data.RELATION_ID;\n        this.theSelectedRelation.RELATION_DESC = data.RELATION_DESC;\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.relationList[0] && !this.relationList[0].CREATE_TIME) {\n        this.relationList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const relationID = this.route.snapshot.firstChild.paramMap.get('relationID');\n        if (relationID) {\n          if (relationID === 'new') {\n            this.onSelect(this.relationList[0]);\n          } else {\n            this.onSelect(this.relationList.find(relation => relation.RELATION_ID === relationID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  searchRelation(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  onSelect(relation: Relation): void {\n    if (relation) {\n      this.theSelectedRelation = relation;\n      this.modelService.setSelectedRelation(relation);\n    }\n  }\n\n  newRelation(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('relationID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newRelation();\n      this.router.navigate(['/model/relation/new']);\n    }\n  }\n\n  _newRelation(): void {\n    this.theSelectedRelation = new Relation();\n    this.theSelectedRelation.RELATION_ID = 'r_new';\n    this.theSelectedRelation.RELATION_DESC = 'description';\n    this.theSelectedRelation.VERSION_NO = 1;\n    this.theSelectedRelation.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedRelation.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedRelation(this.theSelectedRelation);\n    this.relationList.splice(0, 0, this.theSelectedRelation);\n  }\n}\n","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {Attribute, RelationshipMeta} from 'jor-angular';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {AttributeMetaComponent} from '../../attribute-meta/attribute-meta.component';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {EntityService} from 'jor-angular';\nimport {msgStore} from '../../../msgStore';\nimport {switchMap} from 'rxjs/operators';\nimport {forkJoin, Observable, of} from 'rxjs';\nimport {UniqueRelationshipValidator} from '../../model-validators';\nimport {SearchHelp, SearchHelpMethod} from 'jor-angular';\nimport {SearchHelpComponent} from 'jor-angular';\n\n@Component({\n  selector: 'app-relationship-detail',\n  templateUrl: './relationship-detail.component.html',\n  styleUrls: ['./relationship-detail.component.css']\n})\nexport class RelationshipDetailComponent implements OnInit {\n  relationshipMeta: RelationshipMeta;\n  attributes: Attribute[];\n  readonly = true;\n  isNewMode = false;\n  relationshipForm: FormGroup;\n  changedRelationship = {};\n  bypassProtection = false;\n  isSearchListShown = true;\n  roleSearchHelp: SearchHelp;\n\n  @ViewChild(AttributeMetaComponent, {static: false})\n  private attrComponent!: AttributeMetaComponent;\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent!: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueRelationshipValidator: UniqueRelationshipValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.messageService.setMessageStore(msgStore, 'EN');\n  }\n\n  get involveFormArray() {\n    return this.relationshipForm.get('INVOLVES') as FormArray;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const relationshipID = params.get('relationshipID');\n        if (relationshipID === 'new') {\n          const relationship = new RelationshipMeta();\n          relationship.RELATIONSHIP_ID = 'rs_';\n          relationship.RELATIONSHIP_DESC = '';\n          relationship.VALID_PERIOD = 0;\n          relationship.SINGLETON = false;\n          relationship.INVOLVES = [];\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return forkJoin(of(relationship), of([]));\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return forkJoin([\n            this.entityService.getRelationship(relationshipID),\n            this.entityService.getRelationMeta(relationshipID)\n          ]);\n        }\n      })\n    ).subscribe(data => {\n      if ( 'msgName' in data[0]) {\n        this.messageService.clearMessages();\n        this.relationshipMeta = null;\n        this.relationshipForm = null;\n        this.messageService.report(<Message>data[0]);\n      } else {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.relationshipMeta = data[0];\n        this.attributes = 'msgName' in data[1] ? [] : data[1]['ATTRIBUTES'];\n        this._generateRelationshipForm();\n        if (this.readonly) {\n          this.relationshipForm.get('TIME_DEPENDENT').disable();\n          this.relationshipForm.get('SINGLETON').disable();\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  onSearchHelp(control: AbstractControl, rowID: number): void {\n    if (!this.roleSearchHelp) {\n      this.roleSearchHelp = new SearchHelp();\n      this.roleSearchHelp.OBJECT_NAME = 'Role';\n      this.roleSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listRole(searchTerm);\n      }(this.entityService);\n      this.roleSearchHelp.BEHAVIOUR = 'A';\n      this.roleSearchHelp.MULTI = false;\n      this.roleSearchHelp.FUZZY_SEARCH = true;\n      this.roleSearchHelp.FIELDS = [\n        {FIELD_NAME: 'ROLE_ID', LIST_HEADER_TEXT: 'Role', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'ROLE_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.roleSearchHelp.READ_ONLY = this.readonly || this.oldInvolve(control) && control.valid;\n    }\n    const afterExportFn = function (context: any, ruleIdx: number) {\n      return () => context.onChangeRoleID(ruleIdx, true);\n    }(this, rowID).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.roleSearchHelp, control, afterExportFn);\n  }\n\n  _generateRelationshipForm(): void {\n    if (this.relationshipForm) {\n      this.relationshipForm.markAsPristine({onlySelf: false});\n      this.relationshipForm.get('RELATIONSHIP_ID').setValue(this.relationshipMeta.RELATIONSHIP_ID);\n      this.relationshipForm.get('RELATIONSHIP_DESC').setValue(this.relationshipMeta.RELATIONSHIP_DESC);\n      this.relationshipForm.get('TIME_DEPENDENT').setValue(this.relationshipMeta.VALID_PERIOD > 0);\n      this.relationshipForm.get('VALID_PERIOD').setValue(this.relationshipMeta.VALID_PERIOD);\n      this.relationshipForm.get('SINGLETON').setValue(this.relationshipMeta.SINGLETON);\n      this.relationshipForm.removeControl('ATTRIBUTES');\n    } else {\n      this.relationshipForm = this.fb.group({\n        RELATIONSHIP_ID: [this.relationshipMeta.RELATIONSHIP_ID, {updateOn: 'blur'}],\n        RELATIONSHIP_DESC: [this.relationshipMeta.RELATIONSHIP_DESC],\n        TIME_DEPENDENT: [this.relationshipMeta.VALID_PERIOD > 0],\n        VALID_PERIOD: [this.relationshipMeta.VALID_PERIOD, this._validateValidPeriod],\n        SINGLETON: [this.relationshipMeta.SINGLETON]\n      });\n    }\n\n    // Compose Involves\n    const formArray = [];\n    this.relationshipMeta.INVOLVES.forEach( involve => {\n      formArray.push(this.fb.group({\n        ROLE_ID: [involve.ROLE_ID],\n        ROLE_DESC: [involve.ROLE_DESC],\n        CARDINALITY: [{value: involve.CARDINALITY, disabled: this.readonly}],\n        DIRECTION: [involve.DIRECTION]\n      }));\n    });\n\n    if (this.isNewMode) {\n      this.relationshipForm.get('RELATIONSHIP_ID').setValidators(this._validateRelationshipID);\n      this.relationshipForm.get('RELATIONSHIP_ID').setAsyncValidators(\n        this.uniqueRelationshipValidator.validate.bind(this.uniqueRelationshipValidator));\n      this.relationshipForm.get('TIME_DEPENDENT').enable();\n      this.relationshipForm.get('VALID_PERIOD').disable(); // TIME_DEPENDENT by default is not checked\n      formArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CARDINALITY: ['[1..1]'],\n          DIRECTION: ['']\n        }));\n    } else {\n      this.relationshipForm.get('RELATIONSHIP_ID').clearValidators();\n      this.relationshipForm.get('RELATIONSHIP_ID').clearAsyncValidators();\n      this.relationshipForm.get('RELATIONSHIP_ID').updateValueAndValidity();\n    }\n\n    this.relationshipForm.setControl('INVOLVES', new FormArray(formArray));\n  }\n\n  _validateRelationshipID(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Relationship ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().toLowerCase().substr(0, 3) !== 'rs_') {\n      return {message: 'Relationship ID must be started with \"rs_\"!'};\n    }\n\n    if (c.value.toString().length < 4) {\n      return {message: 'Relationship ID must have length larger than 3!'};\n    }\n    if (c.value.toString().length > 32) {\n      return {message: 'Relationship ID must have length less than 32!'};\n    }\n    return null;\n  }\n\n  _validateValidPeriod(c: FormControl) {\n    if (c.parent && c.parent.value.TIME_DEPENDENT && c.value <= 0) {\n      return {message: 'must be larger than 0'};\n    }\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Relationship?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.relationshipMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.relationshipForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateRelationshipForm();\n            this.relationshipForm.reset(this.relationshipForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this.readonly = false;\n      this.relationshipForm.get('TIME_DEPENDENT').enable();\n      if (!this.relationshipForm.get('TIME_DEPENDENT').value) {\n        this.relationshipForm.get('VALID_PERIOD').disable();\n      }\n      this.relationshipForm.get('SINGLETON').enable();\n      this.attrComponent.switchEditDisplay(this.readonly);\n      this.involveFormArray.controls.forEach(involveFormGroup => {\n        involveFormGroup.get('CARDINALITY').enable();\n      });\n      this.involveFormArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CARDINALITY: ['[1..1]'],\n          DIRECTION: ['']\n        })\n      );\n    }\n\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    this.relationshipForm.get('TIME_DEPENDENT').disable();\n    this.relationshipForm.get('SINGLETON').disable();\n    this.attrComponent.switchEditDisplay(this.readonly);\n    let lastIndex = this.involveFormArray.length - 1;\n    while (lastIndex >= 0 && this.involveFormArray.controls[lastIndex].get('ROLE_ID').value.trim() === '') {\n      this.involveFormArray.removeAt(lastIndex);\n      lastIndex--;\n    }\n    this.involveFormArray.controls.forEach(involveFormGroup => {\n      involveFormGroup.get('CARDINALITY').disable();\n    });\n  }\n\n  onChangeRelationshipID(): void {\n    this.modelService.updateRelationshipID(this.relationshipForm.get('RELATIONSHIP_ID').value);\n  }\n\n  onChangeTimeDependency(): void {\n    const timeDependent = this.relationshipForm.get('TIME_DEPENDENT').value;\n    const validPeriodCtrl = this.relationshipForm.get('VALID_PERIOD');\n    const relationID = this.relationshipForm.get('RELATIONSHIP_ID').value;\n    const attrFormArray = this.relationshipForm.get('ATTRIBUTES') as FormArray;\n    if (timeDependent) {\n      validPeriodCtrl.setValue(31536000); // 3600 * 24 * 365\n      validPeriodCtrl.markAsDirty();\n      validPeriodCtrl.enable();\n      const validFromFormGroup = this.fb.group({\n        ATTR_GUID: [''],\n        RELATION_ID: [relationID],\n        ATTR_NAME: ['VALID_FROM'],\n        ATTR_DESC: ['Valid from'],\n        DATA_ELEMENT: [''],\n        DATA_TYPE: [{value: 8, disabled: true}],\n        DATA_LENGTH: [null],\n        DECIMAL: [null],\n        ORDER: [null],\n        PRIMARY_KEY: [false],\n        AUTO_INCREMENT: [false]\n      });\n      validFromFormGroup.markAsDirty();\n      attrFormArray.insert(attrFormArray.length - 1, validFromFormGroup);\n      const validToFormGroup = this.fb.group({\n        ATTR_GUID: [''],\n        RELATION_ID: [relationID],\n        ATTR_NAME: ['VALID_TO'],\n        ATTR_DESC: ['Valid to'],\n        DATA_ELEMENT: [''],\n        DATA_TYPE: [{value: 8, disabled: true}],\n        DATA_LENGTH: [null],\n        DECIMAL: [null],\n        ORDER: [null],\n        PRIMARY_KEY: [false],\n        AUTO_INCREMENT: [false]\n      });\n      validToFormGroup.markAsDirty();\n      attrFormArray.insert(attrFormArray.length - 1, validToFormGroup);\n    } else {\n      validPeriodCtrl.setValue(0);\n      validPeriodCtrl.disable();\n      validPeriodCtrl.markAsDirty();\n      const attributeValidFromIndex = attrFormArray.controls.findIndex(\n        attrCtrl => attrCtrl.get('ATTR_NAME').value === 'VALID_FROM');\n      if (attributeValidFromIndex >= 0) { this.attrComponent.deleteAttribute(attributeValidFromIndex); }\n      const attributeValidToIndex = attrFormArray.controls.findIndex(\n        attrCtrl => attrCtrl.get('ATTR_NAME').value === 'VALID_TO');\n      if (attributeValidToIndex >= 0) { this.attrComponent.deleteAttribute(attributeValidToIndex); }\n    }\n\n  }\n\n  onChangeRelationshipDesc(): void {\n    this.modelService.updateRelationshipDesc(this.relationshipForm.get('RELATIONSHIP_DESC').value);\n  }\n\n  deleteInvolve(index: number): void {\n    if (index !== this.involveFormArray.length - 1) {\n      const currentRoleID = this.involveFormArray.at(index).get('ROLE_ID').value;\n      this.involveFormArray.removeAt(index);\n      this.involveFormArray.markAsDirty();\n      const attrFormArray = this.relationshipForm.get('ATTRIBUTES') as FormArray;\n      const attributeInstanceGUIDIndex = attrFormArray.controls.findIndex(\n        attrCtrl => attrCtrl.get('ATTR_NAME').value === currentRoleID + '_INSTANCE_GUID');\n      if (attributeInstanceGUIDIndex >= 0) { this.attrComponent.deleteAttribute(attributeInstanceGUIDIndex); }\n      const attributeEntityIDIndex = attrFormArray.controls.findIndex(\n        attrCtrl => attrCtrl.get('ATTR_NAME').value === currentRoleID + '_ENTITY_ID');\n      if (attributeEntityIDIndex >= 0) { this.attrComponent.deleteAttribute(attributeEntityIDIndex); }\n    }\n  }\n\n  onChangeRoleID(index: number): void {\n    const currentInvolveFormGroup = this.involveFormArray.controls[index];\n    if (this.involveFormArray.controls.findIndex((involveCtrl, i) =>\n      i !== index && involveCtrl.get('ROLE_ID').value === currentInvolveFormGroup.get('ROLE_ID').value\n    ) !== -1) {\n      currentInvolveFormGroup.get('ROLE_ID').setErrors({message: 'Duplicate roles'});\n      return;\n    }\n\n    if (index === this.involveFormArray.length - 1 && currentInvolveFormGroup.value.ROLE_ID.trim() !== '') {\n      // Only work for the last New line\n      this.involveFormArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CARDINALITY: ['[1..1]'],\n          DIRECTION: ['']\n        })\n      );\n    }\n\n    this.entityService.getRoleDesc(currentInvolveFormGroup.value.ROLE_ID).subscribe(data => {\n      if (data['msgCat']) {\n        currentInvolveFormGroup.get('ROLE_ID').setErrors({message: data['msgShortText']});\n      } else {\n        currentInvolveFormGroup.get('ROLE_DESC').setValue(data);\n        const attrFormArray = this.relationshipForm.get('ATTRIBUTES') as FormArray;\n        const relationID = this.relationshipForm.get('RELATIONSHIP_ID').value;\n        const instanceGUIDFormGroup = this.fb.group({\n          ATTR_GUID: [''],\n          RELATION_ID: [relationID],\n          ATTR_NAME: [currentInvolveFormGroup.value.ROLE_ID + '_INSTANCE_GUID'],\n          ATTR_DESC: ['Entity Instance GUID of role ' + currentInvolveFormGroup.value.ROLE_ID],\n          DATA_ELEMENT: [null],\n          DATA_TYPE: [{value: 1, disabled: true}],\n          DATA_LENGTH: [32],\n          DECIMAL: [null],\n          ORDER: [null],\n          PRIMARY_KEY: [false],\n          AUTO_INCREMENT: [false]\n        });\n        instanceGUIDFormGroup.markAsDirty();\n        attrFormArray.insert(attrFormArray.length - 1, instanceGUIDFormGroup);\n        const entityIDFormGroup = this.fb.group({\n          ATTR_GUID: [''],\n          RELATION_ID: [relationID],\n          ATTR_NAME: [currentInvolveFormGroup.value.ROLE_ID + '_ENTITY_ID'],\n          ATTR_DESC: ['Entity ID of role ' + currentInvolveFormGroup.value.ROLE_ID],\n          DATA_ELEMENT: [null],\n          DATA_TYPE: [{value: 1, disabled: true}],\n          DATA_LENGTH: [32],\n          DECIMAL: [null],\n          ORDER: [null],\n          PRIMARY_KEY: [false],\n          AUTO_INCREMENT: [false]\n        });\n        entityIDFormGroup.markAsDirty();\n        attrFormArray.insert(attrFormArray.length - 1, entityIDFormGroup);\n        attrFormArray.markAsDirty();\n      }\n    });\n  }\n\n  oldInvolve(formGroup: AbstractControl): boolean {\n    return this.relationshipMeta.INVOLVES.findIndex( role => role.ROLE_ID === formGroup.get('ROLE_ID').value ) !== -1;\n  }\n\n  onGoToRole(roleID: string): void {\n    this.router.navigate(['/model/role', roleID]);\n  }\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.relationshipForm && this.relationshipForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.relationshipForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (!this.relationshipForm.valid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedRelationship['action'] = 'add';\n      this.changedRelationship['RELATIONSHIP_ID'] = this.relationshipForm.controls['RELATIONSHIP_ID'].value;\n    } else {\n      this.changedRelationship['action'] = 'update';\n      this.changedRelationship['RELATIONSHIP_ID'] = this.relationshipMeta.RELATIONSHIP_ID;\n    }\n    if (this.relationshipForm.controls['RELATIONSHIP_DESC'].dirty) {\n      this.changedRelationship['RELATIONSHIP_DESC'] = this.relationshipForm.controls['RELATIONSHIP_DESC'].value;\n    }\n    if (this.isNewMode || this.relationshipForm.controls['VALID_PERIOD'].dirty) {\n      this.changedRelationship['VALID_PERIOD'] = this.relationshipForm.controls['VALID_PERIOD'].value;\n    }\n    if (this.isNewMode || this.relationshipForm.controls['SINGLETON'].dirty) {\n      this.changedRelationship['SINGLETON'] = this.relationshipForm.controls['SINGLETON'].value;\n    }\n\n    this.changedRelationship['ATTRIBUTES'] = this.attrComponent.processChangedAttributes();\n\n    if (this._processChangedInvolves()) {\n      // console.log(this.changedRelationship);\n      this.entityService.saveRelationship(this.changedRelationship)\n        .subscribe(data => this._postActivityAfterSavingRelationship(data));\n    }\n  }\n\n  _processChangedInvolves(): boolean {\n    if (this.involveFormArray.length <= 2) { // An empty line is included\n      this.messageService.reportMessage('MODEL', 'RELATIONSHIP_LACK_INVOLVED_ROLES', 'E');\n      return false;\n    }\n    const changedInvolves = [];\n    if (this.involveFormArray.dirty) {\n      this.changedRelationship['INVOLVES'] = changedInvolves;\n\n      this.involveFormArray.controls.forEach(involveControl => {\n        if (involveControl.get('ROLE_ID').value.trim() === '') { return; }\n        let action;\n        const index = this.relationshipMeta.INVOLVES.findIndex(\n          involve => involveControl.get('ROLE_ID').value === involve.ROLE_ID);\n        if (index === -1) { // New Add Case\n          action = 'add';\n        } else { // New Update Case\n          if (involveControl.dirty) { action = 'update'; }\n        }\n        if (action) {\n          changedInvolves.push({ action: action, ROLE_ID: involveControl.get('ROLE_ID').value,\n            CARDINALITY: involveControl.get('CARDINALITY').value, DIRECTION: involveControl.get('DIRECTION').value });\n        }\n      });\n\n      // Deletion Case\n      this.relationshipMeta.INVOLVES.forEach(involve => {\n        const index = this.involveFormArray.controls.findIndex(\n          roleControl => roleControl.get('ROLE_ID').value === involve.ROLE_ID);\n        if (index === -1) { // The attribute must be deleted\n          const deletedRole = {action: 'delete', ROLE_ID: involve.ROLE_ID};\n          changedInvolves.push(deletedRole);\n        }\n      });\n    }\n    return true;\n  }\n\n  _postActivityAfterSavingRelationship(data: any) {\n    this.changedRelationship = {};\n    if (data[0] && data[0]['RELATIONSHIP_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/relationship/' + data[0]['RELATIONSHIP_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'RELATIONSHIP_SAVED', 'S', data[0]['RELATIONSHIP_ID'])}});\n      } else {\n        this.readonly = true;\n        this.relationshipForm.get('TIME_DEPENDENT').disable();\n        this.relationshipForm.get('SINGLETON').disable();\n        this.relationshipMeta = data[0];\n        this.attributes = data[1].ATTRIBUTES;\n        this._generateRelationshipForm();\n        this.messageService.reportMessage(\n          'MODEL', 'RELATIONSHIP_SAVED', 'S', this.relationshipMeta.RELATIONSHIP_ID);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { RelationshipH} from 'jor-angular';\nimport {Subject} from 'rxjs';\nimport {EntityService} from 'jor-angular';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-relationship',\n  templateUrl: './relationship.component.html',\n  styleUrls: ['./relationship.component.css']\n})\nexport class RelationshipComponent implements OnInit {\n  relationshipList: RelationshipH[];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedRelationship: RelationshipH;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listRelationship(term)),\n    ).subscribe(data => {\n      this.relationshipList = data;\n      let relationshipID;\n      if (this.route.snapshot.firstChild) {\n        relationshipID = this.route.snapshot.firstChild.paramMap.get('relationshipID');\n      }\n      if (relationshipID ) {\n        if (relationshipID === 'new') {\n          this._newRelationship();\n        } else {\n          this.onSelect(this.relationshipList.find(relationship => relationship.RELATIONSHIP_ID === relationshipID));\n        }\n      }\n    });\n    this.searchRelationship(''); // The initial list\n\n    this.modelService.theSelectedRelationship$.subscribe( data => {\n      if (this.theSelectedRelationship) {\n        this.theSelectedRelationship.RELATIONSHIP_ID = data['RELATIONSHIP_ID'];\n        this.theSelectedRelationship.RELATIONSHIP_DESC = data['RELATIONSHIP_DESC'];\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.relationshipList[0] && !this.relationshipList[0].CREATE_TIME) {\n        this.relationshipList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const relationshipID = this.route.snapshot.firstChild.paramMap.get('relationshipID');\n        if (relationshipID) {\n          if (relationshipID === 'new') {\n            this.onSelect(this.relationshipList[0]);\n          } else {\n            this.onSelect(this.relationshipList.find(relationship => relationship.RELATIONSHIP_ID === relationshipID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  onSelect(relationship: RelationshipH): void {\n    if (relationship) {\n      this.theSelectedRelationship = relationship;\n      this.modelService.setSelectedRelationship(relationship);\n    }\n  }\n\n  searchRelationship(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  newRelationship(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('relationshipID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newRelationship();\n      this.router.navigate(['/model/relationship/new']);\n    }\n  }\n\n  _newRelationship(): void {\n    this.theSelectedRelationship = new RelationshipH();\n    this.theSelectedRelationship.RELATIONSHIP_ID = 'new';\n    this.theSelectedRelationship.RELATIONSHIP_DESC = 'description';\n    this.theSelectedRelationship.VERSION_NO = 1;\n    this.theSelectedRelationship.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedRelationship.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedRelationship(this.theSelectedRelationship);\n    this.relationshipList.splice(0, 0, this.theSelectedRelationship);\n  }\n}\n","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {RoleMeta} from 'jor-angular';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {EntityService} from 'jor-angular';\nimport {msgStore} from '../../../msgStore';\nimport {switchMap} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\nimport {UniqueRoleValidator} from '../../model-validators';\nimport {SearchHelp, SearchHelpMethod} from 'jor-angular';\nimport {SearchHelpComponent} from 'jor-angular';\nimport {AttributeMetaComponent} from '../../attribute-meta/attribute-meta.component';\n\n@Component({\n  selector: 'app-role-detail',\n  templateUrl: './role-detail.component.html',\n  styleUrls: ['./role-detail.component.css']\n})\nexport class RoleDetailComponent implements OnInit {\n  roleMeta: RoleMeta;\n  readonly = true;\n  isNewMode = false;\n  roleForm: FormGroup;\n  changedRole = {};\n  bypassProtection = false;\n  isSearchListShown = true;\n  relationSearchHelp: SearchHelp;\n\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent!: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueRoleValidator: UniqueRoleValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.messageService.setMessageStore(msgStore, 'EN');\n  }\n\n  get relationFormArray() {\n    return this.roleForm.get('RELATIONS') as FormArray;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const roleID = params.get('roleID');\n        if (roleID === 'new') {\n          const role = new RoleMeta();\n          role.ROLE_ID = '';\n          role.ROLE_DESC = '';\n          role.RELATIONS = [];\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return of(role);\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return this.entityService.getRole(roleID);\n        }\n      })\n    ).subscribe(data => {\n      if ( 'msgName' in data) {\n        this.messageService.clearMessages();\n        this.roleMeta = null;\n        this.roleForm = null;\n        this.messageService.report(<Message>data);\n      } else {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.roleMeta = <RoleMeta>data;\n        this._generateRoleForm();\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  onSearchHelp(control: AbstractControl, rowID: number): void {\n    if (!this.relationSearchHelp) {\n      this.relationSearchHelp = new SearchHelp();\n      this.relationSearchHelp.OBJECT_NAME = 'Relation';\n      this.relationSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listRelation(searchTerm);\n      }(this.entityService);\n      this.relationSearchHelp.BEHAVIOUR = 'A';\n      this.relationSearchHelp.MULTI = false;\n      this.relationSearchHelp.FUZZY_SEARCH = true;\n      this.relationSearchHelp.FIELDS = [\n        {FIELD_NAME: 'RELATION_ID', LIST_HEADER_TEXT: 'Relation', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'RELATION_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.relationSearchHelp.READ_ONLY = this.readonly || this.oldRelation(control) && control.valid;\n    }\n    const afterExportFn = function (context: any, ruleIdx: number) {\n      return () => context.onChangeRelationID(ruleIdx, true);\n    }(this, rowID).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.relationSearchHelp, control, afterExportFn);\n  }\n\n  _generateRoleForm(): void {\n    this.roleForm = this.fb.group({});\n    this.roleForm.addControl('ROLE_ID', new FormControl(this.roleMeta.ROLE_ID, {updateOn: 'blur'}));\n    if (this.isNewMode) {\n      this.roleForm.get('ROLE_ID').setValidators(this._validateRoleID);\n      this.roleForm.get('ROLE_ID').setAsyncValidators(this.uniqueRoleValidator.validate.bind(this.uniqueRoleValidator));\n    }\n    this.roleForm.addControl('ROLE_DESC', new FormControl(this.roleMeta.ROLE_DESC));\n\n    // Compose Involves\n    const formArray = [];\n    this.roleMeta.RELATIONS.forEach( relation => {\n      formArray.push(this.fb.group({\n        RELATION_ID: [relation.RELATION_ID],\n        RELATION_DESC: [relation.RELATION_DESC],\n        CARDINALITY: [{value: relation.CARDINALITY, disabled: this.readonly}]\n      }));\n    });\n    if (this.isNewMode) {\n      formArray.push(\n        this.fb.group({\n          RELATION_ID: [''],\n          RELATION_DESC: [''],\n          CARDINALITY: ['[0..1]']\n        }));\n    }\n    this.roleForm.addControl('RELATIONS', new FormArray(formArray));\n  }\n\n  _validateRoleID(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Role ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Role?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.roleMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.roleForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateRoleForm();\n            this.roleForm.reset(this.roleForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this.readonly = false;\n      this.relationFormArray.controls.forEach(relationFormGroup => {\n        relationFormGroup.get('CARDINALITY').enable();\n      });\n      this.relationFormArray.push(\n        this.fb.group({\n          RELATION_ID: [''],\n          RELATION_DESC: [''],\n          CARDINALITY: ['[0..1]']\n        })\n      );\n    }\n\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    let lastIndex = this.relationFormArray.length - 1;\n    while (lastIndex >= 0 && this.relationFormArray.controls[lastIndex].get('ROLE_ID').value.trim() === '') {\n      this.relationFormArray.removeAt(lastIndex);\n      lastIndex--;\n    }\n    this.relationFormArray.controls.forEach(relationFormGroup => {\n      relationFormGroup.get('CARDINALITY').disable();\n    });\n  }\n\n  onChangeRoleID(): void {\n    this.modelService.updateRoleID(this.roleForm.get('ROLE_ID').value);\n  }\n\n  onChangeRoleDesc(): void {\n    this.modelService.updateRoleDesc(this.roleForm.get('ROLE_DESC').value);\n  }\n\n  deleteRelation(index: number): void {\n    if (index !== this.relationFormArray.length - 1) {\n      this.relationFormArray.removeAt(index);\n      this.relationFormArray.markAsDirty();\n    }\n  }\n\n  onChangeRelationID(index: number, isExportedFromSH?: boolean): void {\n    const currentRelationFormGroup = this.relationFormArray.controls[index];\n    if (this.relationFormArray.controls.findIndex((relationCtrl, i) =>\n      i !== index && relationCtrl.get('RELATION_ID').value === currentRelationFormGroup.get('RELATION_ID').value\n    ) !== -1) {\n      currentRelationFormGroup.get('RELATION_ID').setErrors({message: 'Duplicate Relations'});\n      return;\n    }\n\n    if (index === this.relationFormArray.length - 1 && currentRelationFormGroup.value.RELATION_ID.trim() !== '') {\n      // Only work for the last New line\n      this.relationFormArray.push(\n        this.fb.group({\n          RELATION_ID: [''],\n          RELATION_DESC: [''],\n          CARDINALITY: ['[0..1]']\n        })\n      );\n    }\n\n    if (!isExportedFromSH) {\n      this.entityService.getRelationDesc(currentRelationFormGroup.value.RELATION_ID).subscribe(data => {\n        if (data['msgCat']) {\n          currentRelationFormGroup.get('RELATION_ID').setErrors({message: data['msgShortText']});\n        } else {\n          currentRelationFormGroup.get('RELATION_DESC').setValue(data);\n        }\n      });\n    }\n  }\n\n  oldRelation(formGroup: AbstractControl): boolean {\n    return this.roleMeta.RELATIONS ?\n      this.roleMeta.RELATIONS.findIndex(\n        relation => relation.RELATION_ID === formGroup.get('RELATION_ID').value ) !== -1 :\n      false;\n  }\n\n  onGoToRelation(relationID: string): void {\n    this.router.navigate(['/model/relation', relationID]);\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.roleForm && this.roleForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.roleForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (!this.roleForm.valid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedRole['action'] = 'add';\n      this.changedRole['ROLE_ID'] = this.roleForm.controls['ROLE_ID'].value;\n    } else {\n      this.changedRole['action'] = 'update';\n      this.changedRole['ROLE_ID'] = this.roleMeta.ROLE_ID;\n    }\n    if (this.roleForm.controls['ROLE_DESC'].dirty) {\n      this.changedRole['ROLE_DESC'] = this.roleForm.controls['ROLE_DESC'].value;\n    }\n\n    this._processChangedRelation();\n\n    this.entityService.saveRole(this.changedRole)\n      .subscribe(data => this._postActivityAfterSavingRole(data));\n  }\n\n  _processChangedRelation(): void {\n    const changedRelations = [];\n    if (!this.relationFormArray.dirty) { return; }\n\n    this.changedRole['RELATIONS'] = changedRelations;\n\n    this.relationFormArray.controls.forEach(relationControl => {\n      if (relationControl.get('RELATION_ID').value.trim() === '') { return; }\n      let action;\n      const index = this.roleMeta.RELATIONS.findIndex(\n        relation => relationControl.get('RELATION_ID').value === relation.RELATION_ID);\n      if (index === -1) {// New Add Case\n        action = 'add';\n      } else {\n        if (relationControl.dirty) {// Change Case\n          action = 'update';\n        }\n      }\n      if (action) {\n        changedRelations.push({\n          action: action, RELATION_ID: relationControl.get('RELATION_ID').value, CARDINALITY: relationControl.get('CARDINALITY').value\n        });\n      }\n    });\n\n    // Deletion Case\n    this.roleMeta.RELATIONS.forEach(relation => {\n      const index = this.relationFormArray.controls.findIndex(\n        relationControl => relationControl.get('RELATION_ID').value === relation.RELATION_ID);\n      if (index === -1) { // The attribute must be deleted\n        const deletedRelation = {action: 'delete', RELATION_ID: relation.RELATION_ID};\n        changedRelations.push(deletedRelation);\n      }\n    });\n  }\n\n  _postActivityAfterSavingRole(data: any) {\n    this.changedRole = {};\n    if (data && data['ROLE_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/role/' + data['ROLE_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'ROLE_SAVED', 'S', data['ROLE_ID'])}});\n      } else {\n        this.readonly = true;\n        this.roleMeta = data;\n        this._generateRoleForm();\n        this.messageService.reportMessage('MODEL', 'ROLE_SAVED', 'S', this.roleMeta.ROLE_ID);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n\n}\n","import { Component, OnInit } from '@angular/core';\nimport { RoleH} from 'jor-angular';\nimport {Subject} from 'rxjs';\nimport {EntityService} from 'jor-angular';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-role',\n  templateUrl: './role.component.html',\n  styleUrls: ['./role.component.css']\n})\nexport class RoleComponent implements OnInit {\n  roleList: RoleH[];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedRole: RoleH;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listRole(term)),\n    ).subscribe(data => {\n      this.roleList = data;\n      let roleID;\n      if (this.route.snapshot.firstChild) {\n        roleID = this.route.snapshot.firstChild.paramMap.get('roleID');\n      }\n      if (roleID ) {\n        if (roleID === 'new') {\n          this._newRole();\n        } else {\n          this.onSelect(this.roleList.find(role => role.ROLE_ID === roleID ));\n        }\n      }\n    });\n    this.searchRole(''); // The initial list\n\n    this.modelService.theSelectedRole$.subscribe( data => {\n      if (this.theSelectedRole) {\n        this.theSelectedRole.ROLE_ID = data['ROLE_ID'];\n        this.theSelectedRole.ROLE_DESC = data['ROLE_DESC'];\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.roleList[0] && !this.roleList[0].CREATE_TIME) {\n        this.roleList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const roleID = this.route.snapshot.firstChild.paramMap.get('roleID');\n        if (roleID) {\n          if (roleID === 'new') {\n            this.onSelect(this.roleList[0]);\n          } else {\n            this.onSelect(this.roleList.find(role => role.ROLE_ID === roleID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  onSelect(role: RoleH): void {\n    if (role) {\n      this.theSelectedRole = role;\n      this.modelService.setSelectedRole(role);\n    }\n  }\n\n  searchRole(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  newRole(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('roleID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newRole();\n      this.router.navigate(['/model/role/new']);\n    }\n  }\n\n  _newRole(): void {\n    this.theSelectedRole = new RoleH();\n    this.theSelectedRole.ROLE_ID = 'new';\n    this.theSelectedRole.ROLE_DESC = 'description';\n    this.theSelectedRole.VERSION_NO = 1;\n    this.theSelectedRole.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedRole.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedRole(this.theSelectedRole);\n    this.roleList.splice(0, 0, this.theSelectedRole);\n  }\n\n}\n","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {SearchHelpMeta, EntityService, SearchHelp, SearchHelpComponent, SearchHelpMethod, Attribute, RelationMeta} from 'jor-angular';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {UniqueSearchHelpValidator} from '../../model-validators';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {switchMap} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\n\n@Component({\n  selector: 'app-search-help-detail',\n  templateUrl: './search-help-detail.component.html',\n  styleUrls: ['./search-help-detail.component.css']\n})\nexport class SearchHelpDetailComponent implements OnInit {\n\n  searchHelpMeta: SearchHelpMeta;\n  readonly = true;\n  isNewMode = false;\n  searchHelpForm: FormGroup;\n  changedSearchHelp = {};\n  relationsOfEntity = [];\n  bypassProtection = false;\n  isSearchListShown = true;\n  behaviours = [\n    {key: 'A', value: 'Search automatically when popup'},\n    {key: 'M', value: 'Search manually'}\n  ];\n  relationAttributesMap = {};\n  entitySearchHelp: SearchHelp;\n\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent !: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueSearchHelpValidator: UniqueSearchHelpValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n  }\n\n  get searchHelpFieldsFormArray() {\n    return this.searchHelpForm.get('FIELDS') as FormArray;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const searchHelpID = params.get('searchHelpID');\n        if (searchHelpID === 'new') {\n          const searchHelp = new SearchHelpMeta();\n          searchHelp.SEARCH_HELP_ID = '';\n          searchHelp.SEARCH_HELP_DESC = '';\n          searchHelp.BEHAVIOUR = 'A'; // A: Auto-Trigger Search, M: Manual-Trigger Search\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return of(searchHelp);\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return this.entityService.getSearchHelp(searchHelpID);\n        }\n      })\n    ).subscribe(data => {\n      if ( 'msgName' in data) {\n        this.messageService.clearMessages();\n        this.searchHelpMeta = null;\n        this.searchHelpForm = null;\n        this.messageService.report(<Message>data);\n      } else {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.searchHelpMeta = <SearchHelpMeta>data;\n        this._generateSearchHelpForm();\n        this._getRelationsOfEntity( this.searchHelpForm, false);\n        this.searchHelpFieldsFormArray.controls.forEach( field =>\n          this._getAttributesOfRelation(field, false ));\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  _generateSearchHelpForm(): void {\n    if (this.searchHelpForm) {\n      this.searchHelpForm.markAsPristine({onlySelf: false});\n      this.searchHelpForm.get('SEARCH_HELP_ID').setValue(this.searchHelpMeta.SEARCH_HELP_ID);\n      this.searchHelpForm.get('SEARCH_HELP_DESC').setValue(this.searchHelpMeta.SEARCH_HELP_DESC);\n      this.searchHelpForm.get('ENTITY_ID').setValue(this.searchHelpMeta.ENTITY_ID);\n      this.searchHelpForm.get('RELATION_ID').setValue(this.searchHelpMeta.RELATION_ID);\n      this.searchHelpForm.get('BEHAVIOUR').setValue(this.searchHelpMeta.BEHAVIOUR);\n      this.searchHelpForm.get('MULTI').setValue(this.searchHelpMeta.MULTI);\n      this.searchHelpForm.get('FUZZY_SEARCH').setValue(this.searchHelpMeta.FUZZY_SEARCH);\n      this.searchHelpFieldsFormArray.clear();\n      if (this.readonly) {\n        this.searchHelpForm.get('BEHAVIOUR').disable();\n        this.searchHelpForm.get('MULTI').disable();\n        this.searchHelpForm.get('FUZZY_SEARCH').disable();\n        this.searchHelpForm.get('RELATION_ID').disable();\n      }\n    } else {\n      this.searchHelpForm = this.fb.group({\n        SEARCH_HELP_ID: [this.searchHelpMeta.SEARCH_HELP_ID, {updateOn: 'blur'}],\n        SEARCH_HELP_DESC: [this.searchHelpMeta.SEARCH_HELP_DESC],\n        ENTITY_ID: [this.searchHelpMeta.ENTITY_ID],\n        RELATION_ID: [{value: this.searchHelpMeta.RELATION_ID, disabled: this.readonly}],\n        BEHAVIOUR: [{value: this.searchHelpMeta.BEHAVIOUR, disabled: this.readonly}],\n        MULTI: [{value: this.searchHelpMeta.MULTI, disabled: this.readonly}],\n        FUZZY_SEARCH: [{value: this.searchHelpMeta.FUZZY_SEARCH, disabled: this.readonly}],\n        FIELDS: this.fb.array([])\n      });\n    }\n    this._setNewModeState();\n\n    if (this.searchHelpMeta.FIELDS) {\n      this.searchHelpMeta.FIELDS.forEach( field => {\n        this.searchHelpFieldsFormArray.push(\n          this.fb.group({\n            RELATION_ID: [{value: field.RELATION_ID, disabled: this.readonly}],\n            FIELD_NAME: [{value: field.FIELD_NAME, disabled: this.readonly}],\n            FIELD_DESC: [field.FIELD_DESC],\n            IMPORT: [{value: field.IMPORT, disabled: this.readonly}],\n            EXPORT: [{value: field.EXPORT, disabled: this.readonly}],\n            IE_FIELD_NAME: [field.IE_FIELD_NAME],\n            LIST_POSITION: [field.LIST_POSITION],\n            FILTER_POSITION: [field.FILTER_POSITION],\n            FILTER_DISP_ONLY: [{value: field.FILTER_DISP_ONLY, disabled: this.readonly}],\n            DEFAULT_VALUE: [field.DEFAULT_VALUE]\n          })\n        );\n      });\n    }\n  }\n\n  _setNewModeState() {\n    if (this.isNewMode) {\n      this.searchHelpForm.get('SEARCH_HELP_ID').setValidators(this._validateSearchHelpID);\n      this.searchHelpForm.get('SEARCH_HELP_ID').setAsyncValidators(\n        this.uniqueSearchHelpValidator.validate.bind(this.uniqueSearchHelpValidator));\n      this.searchHelpForm.get('BEHAVIOUR').enable();\n      this.searchHelpForm.get('MULTI').enable();\n      this.searchHelpForm.get('FUZZY_SEARCH').enable();\n      this.searchHelpForm.get('RELATION_ID').enable();\n      this.searchHelpForm.get('BEHAVIOUR').markAsDirty(); // Default value mark as dirty\n    } else {\n      this.searchHelpForm.get('SEARCH_HELP_ID').clearValidators();\n      this.searchHelpForm.get('SEARCH_HELP_ID').clearAsyncValidators();\n      this.searchHelpForm.get('SEARCH_HELP_ID').updateValueAndValidity();\n    }\n  }\n\n  _validateSearchHelpID(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Search Help ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().length > 32) {\n      return {message: 'Search Help ID must have length less than 32!'};\n    }\n    return null;\n  }\n\n  _validateEntityID(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give an entity'};\n    }\n    return null;\n  }\n  _validateRelationID(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a relation'};\n    }\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Search Help?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.searchHelpMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.searchHelpForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateSearchHelpForm();\n            this.searchHelpForm.reset(this.searchHelpForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this._switch2EditMode();\n    }\n\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    this.searchHelpForm.get('BEHAVIOUR').disable();\n    this.searchHelpForm.get('MULTI').disable();\n    this.searchHelpForm.get('FUZZY_SEARCH').disable();\n    this.searchHelpForm.get('RELATION_ID').disable();\n    this.searchHelpFieldsFormArray.controls.forEach(field => {\n      field.get('RELATION_ID').disable();\n      field.get('FIELD_NAME').disable();\n      field.get('IMPORT').disable();\n      field.get('EXPORT').disable();\n      field.get('FILTER_DISP_ONLY').disable();\n    });\n  }\n\n  _switch2EditMode(): void {\n    this.readonly = false;\n    this.searchHelpForm.get('BEHAVIOUR').enable();\n    this.searchHelpForm.get('MULTI').enable();\n    this.searchHelpForm.get('FUZZY_SEARCH').enable();\n    this.searchHelpForm.get('RELATION_ID').enable();\n    this.searchHelpFieldsFormArray.controls.forEach(field => {\n      field.get('RELATION_ID').enable();\n      field.get('FIELD_NAME').enable();\n      field.get('IMPORT').enable();\n      field.get('EXPORT').enable();\n      field.get('FILTER_DISP_ONLY').enable();\n    });\n  }\n\n  onChangeSearchHelpID(): void {\n    this.modelService.updateSearchHelpID(this.searchHelpForm.get('SEARCH_HELP_ID').value);\n  }\n\n  onChangeSearchHelpDesc(): void {\n    this.modelService.updateSearchHelpDesc(this.searchHelpForm.get('SEARCH_HELP_DESC').value);\n  }\n\n  onEntitySearchHelp(control: AbstractControl): void {\n    if (!this.entitySearchHelp) {\n      this.entitySearchHelp = new SearchHelp();\n      this.entitySearchHelp.OBJECT_NAME = 'Entity ID';\n      this.entitySearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listEntityType(searchTerm);\n      }(this.entityService);\n      this.entitySearchHelp.BEHAVIOUR = 'A';\n      this.entitySearchHelp.MULTI = false;\n      this.entitySearchHelp.FUZZY_SEARCH = true;\n      this.entitySearchHelp.FIELDS = [\n        {FIELD_NAME: 'ENTITY_ID', LIST_HEADER_TEXT: 'Entity', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'ENTITY_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.entitySearchHelp.READ_ONLY = this.readonly;\n    }\n    const afterExportFn = function (context: any) {\n      return () => context.onChangeEntityID(control);\n    }(this).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.entitySearchHelp, control, afterExportFn);\n  }\n\n  onChangeEntityID(formGroup: AbstractControl): void {\n    this._getRelationsOfEntity(formGroup, true);\n  }\n\n  _getRelationsOfEntity(searchHelpForm: AbstractControl, setDefault: boolean): void {\n    const domainEntityID = searchHelpForm.get('ENTITY_ID').value;\n    if (!domainEntityID) { return; }\n    this.entityService.getRelationMetaOfEntity(domainEntityID)\n      .subscribe(entityRelations => {\n        if (entityRelations[0]['msgType'] === 'E') {\n          searchHelpForm.get('ENTITY_ID').setErrors({message: entityRelations[0]['msgShortText']});\n        } else {\n          this.relationsOfEntity = entityRelations.map(relationMeta => relationMeta.RELATION_ID )\n            .filter(relationId => relationId.substr(0, 2) !== 'rs' );\n          if (setDefault) {\n            searchHelpForm.get('RELATION_ID').setValue(this.relationsOfEntity[0]);\n            searchHelpForm.get('RELATION_ID').markAsDirty();\n            this._getAttributesOfRelation(searchHelpForm, true);\n          }\n        }\n      });\n  }\n\n  onChangeRelationID(formGroup: AbstractControl): void {\n    this._getAttributesOfRelation(formGroup, true);\n  }\n  _getAttributesOfRelation(formGroup: AbstractControl, afterChanges: boolean): void {\n    const relationID = formGroup.get('RELATION_ID').value;\n    if (!relationID) { return; }\n    if (this.relationAttributesMap[relationID]) {\n      if (afterChanges) {\n        this._afterChangeRelationID(formGroup);\n      } else {\n        this.onChangeField(formGroup);\n      }\n    } else {\n      this.entityService.getRelationMeta(relationID)\n        .subscribe((relationMeta: RelationMeta) => {\n          this.relationAttributesMap[relationID] = relationMeta.ATTRIBUTES;\n          if (afterChanges) {\n            this._afterChangeRelationID(formGroup);\n          } else {\n            this.onChangeField(formGroup);\n          }\n        });\n    }\n  }\n  _afterChangeRelationID(formGroup: AbstractControl): void {\n    const relationID = formGroup.get('RELATION_ID').value;\n    if (formGroup.get('FIELD_NAME')) { // Search help field level relation ID change\n      formGroup.get('FIELD_NAME').setValue(this.relationAttributesMap[relationID][0]['ATTR_NAME']);\n      formGroup.get('FIELD_NAME').markAsDirty();\n      formGroup.get('FIELD_DESC').setValue(this.relationAttributesMap[relationID][0]['ATTR_DESC']);\n    } else { // Search help head level relation ID change\n      this.searchHelpFieldsFormArray.clear();\n      this.relationAttributesMap[relationID].forEach( (attribute: Attribute) => {\n        this.searchHelpFieldsFormArray.push(\n          this.fb.group({\n            RELATION_ID: [attribute.RELATION_ID],\n            FIELD_NAME: [attribute.ATTR_NAME],\n            FIELD_DESC: [attribute.ATTR_DESC],\n            IMPORT: [attribute.PRIMARY_KEY],\n            EXPORT: [attribute.PRIMARY_KEY],\n            IE_FIELD_NAME: [''],\n            LIST_POSITION: [attribute.ORDER],\n            FILTER_POSITION: [attribute.ORDER],\n            FILTER_DISP_ONLY: [false],\n            DEFAULT_VALUE: ['']\n          })\n        );\n      });\n      this.searchHelpFieldsFormArray.markAsDirty();\n    }\n  }\n\n  onChangeField(formGroup: AbstractControl): void {\n    const relationID = formGroup.get('RELATION_ID').value;\n    const currAttr = <Attribute>this.relationAttributesMap[relationID].find(\n      (attribute: Attribute) => attribute.ATTR_NAME === formGroup.get('FIELD_NAME').value);\n    formGroup.get('FIELD_DESC').setValue(currAttr.ATTR_DESC);\n  }\n\n  insertField(index: number): void {\n    const mainRelationID = this.searchHelpForm.get('RELATION_ID').value;\n    const firstAttribute = <Attribute>this.relationAttributesMap[mainRelationID][0];\n    this.searchHelpFieldsFormArray.insert(index, this.fb.group({\n      RELATION_ID: [mainRelationID],\n      FIELD_NAME: [firstAttribute.ATTR_NAME],\n      FIELD_DESC: [firstAttribute.ATTR_DESC],\n      IMPORT: [firstAttribute.PRIMARY_KEY],\n      EXPORT: [firstAttribute.PRIMARY_KEY],\n      IE_FIELD_NAME: [''],\n      LIST_POSITION: [0],\n      FILTER_POSITION: [0],\n      FILTER_DISP_ONLY: [false],\n      DEFAULT_VALUE: ['']\n    }));\n  }\n\n  deleteField(index: number): void {\n    if (this.searchHelpFieldsFormArray.length === 1) {\n      this.messageService.reportMessage('MODEL', 'MINIMUM_ONE_SEARCH_FIELD', 'E');\n      return;\n    }\n    this.searchHelpFieldsFormArray.removeAt(index);\n    this.searchHelpFieldsFormArray.markAsDirty();\n  }\n\n  onGoToEntity(entityID: string): void {\n    this.router.navigate(['/model/entity-type', entityID]);\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.searchHelpForm && this.searchHelpForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.searchHelpForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (this.searchHelpForm.invalid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedSearchHelp['action'] = 'add';\n      this.changedSearchHelp['SEARCH_HELP_ID'] = this.searchHelpForm.get('SEARCH_HELP_ID').value;\n    } else {\n      this.changedSearchHelp['action'] = 'update';\n      this.changedSearchHelp['SEARCH_HELP_ID'] = this.searchHelpMeta.SEARCH_HELP_ID;\n    }\n    if (this.searchHelpForm.get('SEARCH_HELP_DESC').dirty) {\n      this.changedSearchHelp['SEARCH_HELP_DESC'] = this.searchHelpForm.get('SEARCH_HELP_DESC').value;\n    }\n    if (this.searchHelpForm.get('BEHAVIOUR').dirty) {\n      this.changedSearchHelp['BEHAVIOUR'] = this.searchHelpForm.get('BEHAVIOUR').value;\n    }\n    if (this.searchHelpForm.get('MULTI').dirty) {\n      this.changedSearchHelp['MULTI'] = this.searchHelpForm.get('MULTI').value;\n    }\n    if (this.searchHelpForm.get('FUZZY_SEARCH').dirty) {\n      this.changedSearchHelp['FUZZY_SEARCH'] = this.searchHelpForm.get('FUZZY_SEARCH').value;\n    }\n    if (this.searchHelpForm.get('ENTITY_ID').dirty) {\n      this.changedSearchHelp['ENTITY_ID'] = this.searchHelpForm.get('ENTITY_ID').value;\n    }\n    if (this.searchHelpForm.get('RELATION_ID').dirty) {\n      this.changedSearchHelp['RELATION_ID'] = this.searchHelpForm.get('RELATION_ID').value;\n    }\n    if (this.searchHelpForm.get('FIELDS').dirty) {\n      this.changedSearchHelp['FIELDS'] = [];\n      this.searchHelpForm.get('FIELDS').value.forEach( field => {\n        if (field.FIELD_NAME) {\n          this.changedSearchHelp['FIELDS'].push(field);\n        }\n      });\n    }\n    this.entityService.saveSearchHelp(this.changedSearchHelp)\n      .subscribe(data => this._postActivityAfterSavingSearchHelp(data));\n  }\n\n  _postActivityAfterSavingSearchHelp(data: any) {\n    this.changedSearchHelp = {};\n    if (data['SEARCH_HELP_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/search-help/' + data['SEARCH_HELP_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'SEARCH_HELP_SAVED', 'S', data['SEARCH_HELP_ID'])}});\n      } else {\n        this._switch2DisplayMode();\n        this.searchHelpMeta = data;\n        this._generateSearchHelpForm();\n        this.searchHelpFieldsFormArray.controls.forEach( field =>\n          this._getAttributesOfRelation(field, false ));\n        this.messageService.reportMessage('MODEL', 'SEARCH_HELP_SAVED', 'S', data['SEARCH_HELP_ID']);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport {EntityService, SearchHelpH, SearchHelpMeta} from 'jor-angular';\nimport {Subject} from 'rxjs';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-search-help',\n  templateUrl: './search-help.component.html',\n  styleUrls: ['./search-help.component.css']\n})\nexport class SearchHelpComponent implements OnInit {\n\n  searchHelpList: SearchHelpH[] = [];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedSearchHelp: SearchHelpH;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listSearchHelp(term)),\n    ).subscribe(data => {\n      this.searchHelpList = data;\n      let searchHelpID;\n      if (this.route.snapshot.firstChild) {\n        searchHelpID = this.route.snapshot.firstChild.paramMap.get('searchHelpID');\n      }\n      if (searchHelpID ) {\n        if (searchHelpID === 'new') {\n          this._newSearchHelp();\n        } else {\n          this.onSelect(this.searchHelpList.find(searchHelp => searchHelp.SEARCH_HELP_ID === searchHelpID));\n        }\n      }\n    });\n    this.searchSearchHelp(''); // The initial list\n\n    this.modelService.theSelectedSearchHelp$.subscribe( data => {\n      if (this.theSelectedSearchHelp) {\n        this.theSelectedSearchHelp.SEARCH_HELP_ID = data['SEARCH_HELP_ID'];\n        this.theSelectedSearchHelp.SEARCH_HELP_DESC = data['SEARCH_HELP_DESC'];\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.searchHelpList[0] && !this.searchHelpList[0].CREATE_TIME) {\n        this.searchHelpList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const searchHelpID = this.route.snapshot.firstChild.paramMap.get('searchHelpID');\n        if (searchHelpID) {\n          if (searchHelpID === 'new') {\n            this.onSelect(this.searchHelpList[0]);\n          } else {\n            this.onSelect(this.searchHelpList.find(searchHelp => searchHelp.SEARCH_HELP_ID === searchHelpID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  onSelect(searchHelp: SearchHelpH): void {\n    if (searchHelp) {\n      this.theSelectedSearchHelp = searchHelp;\n      this.modelService.setSelectedSearchHelp(searchHelp);\n    }\n  }\n\n  searchSearchHelp(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  newSearchHelp(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('searchHelpID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newSearchHelp();\n      this.router.navigate(['/model/search-help/new']);\n    }\n  }\n\n  _newSearchHelp(): void {\n    this.theSelectedSearchHelp = new SearchHelpMeta();\n    this.theSelectedSearchHelp.SEARCH_HELP_ID = 'new';\n    this.theSelectedSearchHelp.SEARCH_HELP_DESC = 'description';\n    this.theSelectedSearchHelp.VERSION_NO = 1;\n    this.theSelectedSearchHelp.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedSearchHelp.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedSearchHelp(this.theSelectedSearchHelp);\n    this.searchHelpList.splice(0, 0, this.theSelectedSearchHelp);\n  }\n\n}\n","import { Subscriber } from '../Subscriber';\nimport { async } from '../scheduler/async';\nexport function debounceTime(dueTime, scheduler = async) {\n    return (source) => source.lift(new DebounceTimeOperator(dueTime, scheduler));\n}\nclass DebounceTimeOperator {\n    constructor(dueTime, scheduler) {\n        this.dueTime = dueTime;\n        this.scheduler = scheduler;\n    }\n    call(subscriber, source) {\n        return source.subscribe(new DebounceTimeSubscriber(subscriber, this.dueTime, this.scheduler));\n    }\n}\nclass DebounceTimeSubscriber extends Subscriber {\n    constructor(destination, dueTime, scheduler) {\n        super(destination);\n        this.dueTime = dueTime;\n        this.scheduler = scheduler;\n        this.debouncedSubscription = null;\n        this.lastValue = null;\n        this.hasValue = false;\n    }\n    _next(value) {\n        this.clearDebounce();\n        this.lastValue = value;\n        this.hasValue = true;\n        this.add(this.debouncedSubscription = this.scheduler.schedule(dispatchNext, this.dueTime, this));\n    }\n    _complete() {\n        this.debouncedNext();\n        this.destination.complete();\n    }\n    debouncedNext() {\n        this.clearDebounce();\n        if (this.hasValue) {\n            const { lastValue } = this;\n            this.lastValue = null;\n            this.hasValue = false;\n            this.destination.next(lastValue);\n        }\n    }\n    clearDebounce() {\n        const debouncedSubscription = this.debouncedSubscription;\n        if (debouncedSubscription !== null) {\n            this.remove(debouncedSubscription);\n            debouncedSubscription.unsubscribe();\n            this.debouncedSubscription = null;\n        }\n    }\n}\nfunction dispatchNext(subscriber) {\n    subscriber.debouncedNext();\n}\n"],"names":[],"sourceRoot":"webpack:///"}