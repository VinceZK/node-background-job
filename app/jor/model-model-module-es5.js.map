{"version":3,"sources":["webpack:///src/app/model/attribute-meta/attribute-meta.component.css","webpack:///src/app/model/data-domain/data-domain-detail/data-domain-detail.component.ts","webpack:///src/app/model/attribute-meta/attribute-meta.component.ts","webpack:///src/app/model/search-help/search-help.component.css","webpack:///src/app/model/relationship/relationship-detail/relationship-detail.component.css","webpack:///src/app/model/data-element/data-element.component.css","webpack:///src/app/model/relation/relation.component.css","webpack:///src/app/model/data-element/data-element.component.html","webpack:///src/app/model/data-domain/data-domain.component.ts","webpack:///src/app/model/model.component.ts","webpack:///src/app/model/relation/relation.component.ts","webpack:///src/app/model/relation/relation-detail/relation-detail.component.html","webpack:///src/app/model/entity-type/entity-type-detail/entity-type-detail.component.css","webpack:///src/app/model/relationship/relationship-detail/relationship-detail.component.html","webpack:///src/app/model/model.module.ts","webpack:///src/app/model/role/role-detail/role-detail.component.ts","webpack:///src/app/model/model-routing.module.ts","webpack:///src/app/model/entity-type/entity-type.component.html","webpack:///src/app/model/model.component.html","webpack:///src/app/model/role/role.component.html","webpack:///src/app/model/relation/relation.component.html","webpack:///src/app/model/entity-type/entity-type-detail/entity-type-detail.component.html","webpack:///src/app/model/relationship/relationship.component.css","webpack:///src/app/model/search-help/search-help-detail/search-help-detail.component.css","webpack:///src/app/model/data-domain/data-domain.component.html","webpack:///src/app/model/attribute-meta/attribute-meta.component.html","webpack:///src/app/model/search-help/search-help-detail/search-help-detail.component.ts","webpack:///src/app/model/search-help/search-help-detail/search-help-detail.component.html","webpack:///src/app/model/relationship/relationship.component.ts","webpack:///src/app/model/relationship/relationship-detail/relationship-detail.component.ts","webpack:///src/app/model/data-element/data-element-detail/data-element-detail.component.ts","webpack:///src/app/model/role/role.component.ts","webpack:///src/app/model/role/role-detail/role-detail.component.html","webpack:///src/app/model/entity-type/entity-type.component.ts","webpack:///src/app/model/relation/relation-detail/relation-detail.component.css","webpack:///src/app/model/role/role-detail/role-detail.component.css","webpack:///src/app/model/role/role.component.css","webpack:///src/app/model/model.component.css","webpack:///src/app/model/data-domain/data-domain-detail/data-domain-detail.component.html","webpack:///src/app/model/relationship/relationship.component.html","webpack:///src/app/model/data-domain/data-domain-detail/data-domain-detail.component.css","webpack:///src/app/model/search-help/search-help.component.ts","webpack:///src/app/model/model-validators.ts","webpack:///src/app/model/data-element/data-element-detail/data-element-detail.component.css","webpack:///src/app/model/relation/relation-detail/relation-detail.component.ts","webpack:///src/app/model/data-element/data-element-detail/data-element-detail.component.html","webpack:///src/app/model/data-domain/data-domain.component.css","webpack:///src/app/model/model.service.ts","webpack:///src/app/model/entity-type/entity-type.component.css","webpack:///src/app/model/search-help/search-help.component.html","webpack:///src/app/model/entity-type/entity-type-detail/entity-type-detail.component.ts","webpack:///src/app/model/data-element/data-element.component.ts"],"names":["DataDomainDetailComponent","route","router","fb","uniqueDataDomainValidator","messageService","modelService","dialogService","entityService","readonly","isNewMode","dataTypes","changedDataDomain","relationsOfEntity","bypassProtection","isSearchListShown","enableGeneralType","enableRegExpr","enableValueRelation","enableArrayOrInterval","paramMap","pipe","params","domainID","get","dataDomain","DOMAIN_ID","DOMAIN_DESC","DATA_TYPE","DATA_LENGTH","DOMAIN_TYPE","getDataDomain","subscribe","data","clearMessages","dataDomainMeta","dataDomainForm","report","history","state","message","_generateDataDomainForm","_getRelationsOfEntity","isSearchListShown$","showSearchList","markAsPristine","onlySelf","setValue","DECIMAL","UNSIGNED","CAPITAL_ONLY","REG_EXPR","ENTITY_ID","RELATION_ID","clear","disable","group","updateOn","value","disabled","_validateDataLength","_validateDecimal","DOMAIN_VALUES","array","_setNewModeState","forEach","domainValue","domainValueFormArray","push","LOW_VALUE","LOW_VALUE_TEXT","HIGH_VALUE","_setDomainType","_updateLengthAndDecimal","setValidators","_validateDataDomainID","setAsyncValidators","validate","bind","enable","markAsDirty","clearValidators","clearAsyncValidators","updateValueAndValidity","c","trim","toString","toLowerCase","length","enabled","confirm","_switch2DisplayMode","sendDialogAnswer","dirty","reset","_switch2EditMode","updateDataDomainID","updateDataDomainDesc","formGroup","control","entitySearchHelp","OBJECT_NAME","METHOD","searchTerm","listEntityType","BEHAVIOUR","MULTI","FUZZY_SEARCH","FIELDS","FIELD_NAME","LIST_HEADER_TEXT","IMPORT","EXPORT","LIST_POSITION","FILTER_POSITION","READ_ONLY","afterExportFn","context","onChangeEntityID","searchHelpComponent","openSearchHelpModal","setDefault","domainEntityID","getRelationMetaOfEntity","entityRelations","setErrors","map","relationMeta","filter","relationId","substr","_invalidField","_validateEntityID","_validateRelationID","_generateEmptyLines","num","existingLines","i","fieldCtrl","isArray","index","currentDomainValueCtrl","at","indexFound","controls","findIndex","ctrl","valueIndex","insert","removeAt","dialogAnswer","reportMessage","invalid","saveDataDomain","_postActivityAfterSavingDataDomain","navigate","generateMessage","Array","err","add","selector","template","AttributeMetaComponent","deletedAttributes","setMessageStore","generateFormArray","formArray","parentForm","rowID","dataElementSearchHelp","listDataElement","IE_FIELD_NAME","attrIdx","onChangeDataElement","ATTR_GUID","ATTR_NAME","_createAnAttributeFormCtrl","ATTR_DESC","DATA_ELEMENT","ORDER","PRIMARY_KEY","AUTO_INCREMENT","currentAttributeFormCtrl","dataElementCtrl","_disableField","_enableField","attrFormGroup","attributeFormGroup","getDataElement","Messages","changedAttributes","changedAttribute","order","attribute","Object","keys","key","formControl","action","attributes","isDataElementAttribute","isFieldGray","addControl","lastIndex","relationID","dataElementName","DataDomainComponent","identityService","dataDomainList","searchTerms","term","listDataDomain","snapshot","firstChild","_newDataDomain","onSelect","find","searchDataDomain","theSelectedDataDomain$","theSelectedDataDomain","dialogAnswer$","answer","CREATE_TIME","splice","hideSearchList","setSelectedDataDomain","next","VERSION_NO","LAST_CHANGE_BY","Session","USER_ID","LAST_CHANGE_TIME","CurrentTime","ModelComponent","RelationComponent","listRelation","relationList","_newRelation","relation","searchRelation","theSelectedRelation$","theSelectedRelation","RELATION_DESC","setSelectedRelation","ModelModule","imports","declarations","RoleDetailComponent","uniqueRoleValidator","changedRole","roleID","role","ROLE_ID","ROLE_DESC","RELATIONS","getRole","roleMeta","roleForm","_generateRoleForm","relationSearchHelp","oldRelation","valid","ruleIdx","onChangeRelationID","_validateRoleID","CARDINALITY","relationFormArray","relationFormGroup","updateRoleID","updateRoleDesc","isExportedFromSH","currentRelationFormGroup","relationCtrl","getRelationDesc","_processChangedRelation","saveRole","_postActivityAfterSavingRole","changedRelations","relationControl","deletedRelation","routes","path","component","children","canDeactivate","redirectTo","pathMatch","ModelRoutingModule","forChild","exports","SearchHelpDetailComponent","uniqueSearchHelpValidator","changedSearchHelp","behaviours","relationAttributesMap","searchHelpID","searchHelp","SEARCH_HELP_ID","SEARCH_HELP_DESC","getSearchHelp","searchHelpMeta","searchHelpForm","_generateSearchHelpForm","searchHelpFieldsFormArray","field","_getAttributesOfRelation","FIELD_DESC","FILTER_DISP_ONLY","DEFAULT_VALUE","_validateSearchHelpID","updateSearchHelpID","updateSearchHelpDesc","afterChanges","_afterChangeRelationID","onChangeField","getRelationMeta","ATTRIBUTES","currAttr","mainRelationID","firstAttribute","entityID","saveSearchHelp","_postActivityAfterSavingSearchHelp","RelationshipComponent","listRelationship","relationshipList","relationshipID","_newRelationship","relationship","RELATIONSHIP_ID","searchRelationship","theSelectedRelationship$","theSelectedRelationship","RELATIONSHIP_DESC","setSelectedRelationship","RelationshipDetailComponent","uniqueRelationshipValidator","changedRelationship","VALID_PERIOD","SINGLETON","INVOLVES","getRelationship","relationshipMeta","relationshipForm","_generateRelationshipForm","roleSearchHelp","listRole","oldInvolve","onChangeRoleID","removeControl","TIME_DEPENDENT","_validateValidPeriod","involve","DIRECTION","_validateRelationshipID","setControl","parent","attrComponent","switchEditDisplay","involveFormArray","involveFormGroup","updateRelationshipID","timeDependent","validPeriodCtrl","attrFormArray","validFromFormGroup","validToFormGroup","attributeValidFromIndex","attrCtrl","deleteAttribute","attributeValidToIndex","updateRelationshipDesc","currentRoleID","attributeInstanceGUIDIndex","attributeEntityIDIndex","currentInvolveFormGroup","involveCtrl","getRoleDesc","instanceGUIDFormGroup","entityIDFormGroup","processChangedAttributes","_processChangedInvolves","saveRelationship","_postActivityAfterSavingRelationship","changedInvolves","involveControl","roleControl","deletedRole","DataElementDetailComponent","uniqueDataElementValidator","changedDataElement","searchHelpExportField","elementID","dataElement","ELEMENT_ID","ELEMENT_DESC","dataElementMeta","dataElementForm","_generateDataElementForm","_getSearchHelpMeta","dataDomainSearchHelp","onChangeDataDomain","searchHelpSearchHelp","listSearchHelp","onChangeSearchHelp","searchHelpCtrl","searchHelpFields","LABEL_TEXT","SEARCH_HELP_EXPORT_FIELD","PARAMETER_ID","USE_DOMAIN","required","_validateDataElementID","_setUseDomain","updateDataElementID","updateDataElementDesc","dataDomainCtrl","saveDataElement","_postActivityAfterSavingDataElement","RoleComponent","roleList","_newRole","searchRole","theSelectedRole$","theSelectedRole","setSelectedRole","EntityTypeComponent","entityTypeList","_newEntityType","entityType","searchEntityType","theSelectedEntityType$","theSelectedEntityType","ENTITY_DESC","setSelectedEntityType","SearchHelpComponent","searchHelpList","_newSearchHelp","searchSearchHelp","theSelectedSearchHelp$","theSelectedSearchHelp","setSelectedSearchHelp","UniqueSearchHelpValidator","getSearchHelpDesc","providedIn","UniqueDataDomainValidator","getDataDomainDesc","UniqueDataElementValidator","getDataElementDesc","UniqueRoleValidator","UniqueRelationValidator","updateRelationID","UniqueRelationshipValidator","getRelationshipDesc","UniqueEntityTypeValidator","getEntityTypeDesc","updateEntityID","RelationDetailComponent","uniqueRelationValidator","isFieldMapShown","changedRelation","_generateRelationForm","relationForm","fieldName","onChangeRightRelationID","_validateRelationId","ASSOCIATIONS","association","fieldsMapArray","FIELDS_MAPPING","fieldsMap","LEFT_FIELD","RIGHT_FIELD","ASSOCIATION_NAME","RIGHT_RELATION_ID","FOREIGN_KEY_CHECK","_appendEmptyAssociation","associationFormArray","associationFormGroup","updateRelationDesc","currentAssociationForm","currentRightRelationMeta","fieldMapFormArray","currentAssociation","currentAssocFormGroup","assocCtrl","cardinality","currentFieldMapFormGroup","fieldMapCtrl","fieldMap","checkErrs","checkAttributes","errMsg","_processChangedAssociation","saveRelation","_postActivityAfterSavingRelation","changedAssociations","errMessages","associationControl","changedAssociation","associationMeta","fieldMapArray","oldFieldMap","errMessage","ModelService","asObservable","selectedEntityTypeSource","selectedRelationSource","selectedRelationshipSource","selectedRoleSource","selectedDataElementSource","theSelectedDataElement$","selectedDataDomainSource","selectedSearchHelpSource","entityDesc","relationDesc","relationshipDesc","roleDesc","theSelectedDataElement","elementDesc","element","domainDesc","domain","searchHelpDesc","EntityTypeDetailComponent","uniqueEntityTypeValidator","changedEntityType","ROLES","getEntityMeta","entityMeta","_generateEntityTypeForm","entityTypeForm","oldRole","_validateEntityId","CONDITIONAL_ATTR","CONDITIONAL_VALUE","roleFormArray","roleFormGroup","updateEntityDesc","currentRoleFormGroup","roleCtrl","_processChangedRoles","saveEntityType","_postActivityAfterSavingEntityType","changedRoles","existRole","DataElementComponent","dataElementList","_newDataElement","dataEle","searchDataElement","setSelectedDataElement"],"mappings":"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","file":"model-model-module-es5.js","sourcesContent":["export default \".dk-table {\\n  display: block;\\n  overflow-x: auto;\\n  white-space: nowrap;\\n  border: none;\\n}\\n.dk-actions{\\n  width: 6rem;\\n}\\n.dk-description{\\n  min-width: 12rem;\\n  max-width: 20rem;\\n}\\n.dk-dataElement{\\n  min-width: 12rem;\\n  max-width: 20rem;\\n}\\n.dk-number{\\n  min-width: 4rem;\\n  max-width: 6rem;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbW9kZWwvYXR0cmlidXRlLW1ldGEvYXR0cmlidXRlLW1ldGEuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGNBQWM7RUFDZCxnQkFBZ0I7RUFDaEIsbUJBQW1CO0VBQ25CLFlBQVk7QUFDZDtBQUNBO0VBQ0UsV0FBVztBQUNiO0FBQ0E7RUFDRSxnQkFBZ0I7RUFDaEIsZ0JBQWdCO0FBQ2xCO0FBQ0E7RUFDRSxnQkFBZ0I7RUFDaEIsZ0JBQWdCO0FBQ2xCO0FBQ0E7RUFDRSxlQUFlO0VBQ2YsZUFBZTtBQUNqQiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL2F0dHJpYnV0ZS1tZXRhL2F0dHJpYnV0ZS1tZXRhLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuZGstdGFibGUge1xuICBkaXNwbGF5OiBibG9jaztcbiAgb3ZlcmZsb3cteDogYXV0bztcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgYm9yZGVyOiBub25lO1xufVxuLmRrLWFjdGlvbnN7XG4gIHdpZHRoOiA2cmVtO1xufVxuLmRrLWRlc2NyaXB0aW9ue1xuICBtaW4td2lkdGg6IDEycmVtO1xuICBtYXgtd2lkdGg6IDIwcmVtO1xufVxuLmRrLWRhdGFFbGVtZW50e1xuICBtaW4td2lkdGg6IDEycmVtO1xuICBtYXgtd2lkdGg6IDIwcmVtO1xufVxuLmRrLW51bWJlcntcbiAgbWluLXdpZHRoOiA0cmVtO1xuICBtYXgtd2lkdGg6IDZyZW07XG59XG4iXX0= */\";","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {UniqueDataDomainValidator} from '../../model-validators';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {switchMap} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\nimport {DataDomainMeta, SearchHelpComponent, EntityService, SearchHelp, SearchHelpMethod} from 'jor-angular';\n\n@Component({\n  selector: 'app-data-domain-detail',\n  templateUrl: './data-domain-detail.component.html',\n  styleUrls: ['./data-domain-detail.component.css']\n})\nexport class DataDomainDetailComponent implements OnInit {\n\n  dataDomainMeta: DataDomainMeta;\n  readonly = true;\n  isNewMode = false;\n  dataDomainForm: FormGroup;\n  dataTypes = [];\n  changedDataDomain = {};\n  relationsOfEntity = [];\n  bypassProtection = false;\n  isSearchListShown = true;\n  enableGeneralType = false;\n  enableRegExpr = false;\n  enableValueRelation = false;\n  enableArrayOrInterval = false;\n  entitySearchHelp: SearchHelp;\n\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent !: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueDataDomainValidator: UniqueDataDomainValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.dataTypes = this.modelService.dataTypes;\n  }\n\n  get domainValueFormArray() {\n    return this.dataDomainForm.get('DOMAIN_VALUES') as FormArray;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const domainID = params.get('domainID');\n        if (domainID === 'new') {\n          const dataDomain = new DataDomainMeta();\n          dataDomain.DOMAIN_ID = '';\n          dataDomain.DOMAIN_DESC = '';\n          dataDomain.DATA_TYPE = 1; // Char by default\n          dataDomain.DATA_LENGTH = 10;\n          dataDomain.DOMAIN_TYPE = 0;\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return of(dataDomain);\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return this.entityService.getDataDomain(domainID);\n        }\n      })\n    ).subscribe(data => {\n      if ( 'msgName' in data) {\n        this.messageService.clearMessages();\n        this.dataDomainMeta = null;\n        this.dataDomainForm = null;\n        this.messageService.report(<Message>data);\n      } else {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.dataDomainMeta = <DataDomainMeta>data;\n        this._generateDataDomainForm();\n        this._getRelationsOfEntity( this.dataDomainForm, false);\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  _generateDataDomainForm(): void {\n    if (this.dataDomainForm) {\n      this.dataDomainForm.markAsPristine({onlySelf: false});\n      this.dataDomainForm.get('DOMAIN_ID').setValue(this.dataDomainMeta.DOMAIN_ID);\n      this.dataDomainForm.get('DOMAIN_DESC').setValue(this.dataDomainMeta.DOMAIN_DESC);\n      this.dataDomainForm.get('DATA_TYPE').setValue(this.dataDomainMeta.DATA_TYPE);\n      this.dataDomainForm.get('DATA_LENGTH').setValue(this.dataDomainMeta.DATA_LENGTH);\n      this.dataDomainForm.get('DECIMAL').setValue(this.dataDomainMeta.DECIMAL);\n      this.dataDomainForm.get('DOMAIN_TYPE').setValue(this.dataDomainMeta.DOMAIN_TYPE);\n      this.dataDomainForm.get('UNSIGNED').setValue(this.dataDomainMeta.UNSIGNED);\n      this.dataDomainForm.get('CAPITAL_ONLY').setValue(this.dataDomainMeta.CAPITAL_ONLY);\n      this.dataDomainForm.get('REG_EXPR').setValue(this.dataDomainMeta.REG_EXPR);\n      this.dataDomainForm.get('ENTITY_ID').setValue(this.dataDomainMeta.ENTITY_ID);\n      this.dataDomainForm.get('RELATION_ID').setValue(this.dataDomainMeta.RELATION_ID);\n      (<FormArray>this.dataDomainForm.get('DOMAIN_VALUES')).clear();\n      if (this.readonly) {\n        this.dataDomainForm.get('DOMAIN_TYPE').disable();\n        this.dataDomainForm.get('DATA_TYPE').disable();\n      }\n    } else {\n      this.dataDomainForm = this.fb.group({\n        DOMAIN_ID: [this.dataDomainMeta.DOMAIN_ID, {updateOn: 'blur'}],\n        DOMAIN_DESC: [this.dataDomainMeta.DOMAIN_DESC],\n        DATA_TYPE: [{value: this.dataDomainMeta.DATA_TYPE, disabled: this.readonly}],\n        DATA_LENGTH: [this.dataDomainMeta.DATA_LENGTH, [this._validateDataLength]],\n        DECIMAL: [this.dataDomainMeta.DECIMAL, [this._validateDecimal]],\n        DOMAIN_TYPE: [{value: this.dataDomainMeta.DOMAIN_TYPE, disabled: this.readonly}],\n        UNSIGNED: [{value: this.dataDomainMeta.UNSIGNED, disabled: this.readonly}],\n        CAPITAL_ONLY: [{value: this.dataDomainMeta.CAPITAL_ONLY, disabled: this.readonly}],\n        REG_EXPR: [this.dataDomainMeta.REG_EXPR],\n        ENTITY_ID: [this.dataDomainMeta.ENTITY_ID],\n        RELATION_ID: [{value: this.dataDomainMeta.RELATION_ID, disabled: this.readonly}],\n        DOMAIN_VALUES: this.fb.array([])\n      });\n    }\n    this._setNewModeState();\n    if (this.dataDomainMeta.DOMAIN_TYPE >= 3 && this.dataDomainMeta.DOMAIN_VALUES) { // Value Array/Interval\n      this.dataDomainMeta.DOMAIN_VALUES.forEach( domainValue => {\n        this.domainValueFormArray.push(\n          this.fb.group({\n            LOW_VALUE: [domainValue.LOW_VALUE],\n            LOW_VALUE_TEXT: [domainValue.LOW_VALUE_TEXT],\n            HIGH_VALUE: [domainValue.HIGH_VALUE]\n          })\n        );\n      });\n    }\n    this._setDomainType(this.dataDomainForm, false);\n    this._updateLengthAndDecimal(this.dataDomainForm, false);\n  }\n\n  _setNewModeState() {\n    if (this.isNewMode) {\n      this.dataDomainForm.get('DOMAIN_ID').setValidators(this._validateDataDomainID);\n      this.dataDomainForm.get('DOMAIN_ID').setAsyncValidators(\n        this.uniqueDataDomainValidator.validate.bind(this.uniqueDataDomainValidator));\n      this.dataDomainForm.get('DATA_TYPE').enable();\n      this.dataDomainForm.get('DOMAIN_TYPE').enable();\n      this.dataDomainForm.get('DATA_TYPE').markAsDirty(); // Default value mark as dirty\n      this.dataDomainForm.get('DATA_LENGTH').markAsDirty(); // Default value mark as dirty\n      this.dataDomainForm.get('DOMAIN_TYPE').markAsDirty(); // Default value mark as dirty\n    } else {\n      this.dataDomainForm.get('DOMAIN_ID').clearValidators();\n      this.dataDomainForm.get('DOMAIN_ID').clearAsyncValidators();\n      this.dataDomainForm.get('DOMAIN_ID').updateValueAndValidity();\n    }\n  }\n\n  _validateDataDomainID(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Data Domain ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().length > 32) {\n      return {message: 'Data Domain ID must have length less than 32!'};\n    }\n    return null;\n  }\n\n  _validateDataLength(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a Length'};\n    }\n    return null;\n  }\n\n  _validateDecimal(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a decimal place'};\n    }\n    if (c.value < 1 || c.value > 37) {\n      return {message: 'Decimal place can only between 1 and 37'};\n    }\n    return null;\n  }\n  _validateEntityID(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give an entity'};\n    }\n    return null;\n  }\n  _validateRelationID(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a relation'};\n    }\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Data Domain?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.dataDomainMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.dataDomainForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateDataDomainForm();\n            this.dataDomainForm.reset(this.dataDomainForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this._switch2EditMode();\n    }\n\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    this.dataDomainForm.get('DOMAIN_TYPE').disable();\n    this.dataDomainForm.get('DATA_TYPE').disable();\n    this.dataDomainForm.get('UNSIGNED').disable();\n    this.dataDomainForm.get('CAPITAL_ONLY').disable();\n    this.dataDomainForm.get('RELATION_ID').disable();\n  }\n\n  _switch2EditMode(): void {\n    this.readonly = false;\n    this.dataDomainForm.get('DOMAIN_TYPE').enable();\n    this.dataDomainForm.get('DATA_TYPE').enable();\n    this._setDomainType(this.dataDomainForm, false);\n    this._updateLengthAndDecimal(this.dataDomainForm, false);\n  }\n\n  onChangeDataDomainID(): void {\n    this.modelService.updateDataDomainID(this.dataDomainForm.get('DOMAIN_ID').value);\n  }\n\n  onChangeDataDomainDesc(): void {\n    this.modelService.updateDataDomainDesc(this.dataDomainForm.get('DOMAIN_DESC').value);\n  }\n\n  onChangeDomainType(formGroup: AbstractControl): void {\n    this._setDomainType(formGroup, true);\n  }\n\n  onEntitySearchHelp(control: AbstractControl): void {\n    if (!this.entitySearchHelp) {\n      this.entitySearchHelp = new SearchHelp();\n      this.entitySearchHelp.OBJECT_NAME = 'Entity ID';\n      this.entitySearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listEntityType(searchTerm);\n      }(this.entityService);\n      this.entitySearchHelp.BEHAVIOUR = 'A';\n      this.entitySearchHelp.MULTI = false;\n      this.entitySearchHelp.FUZZY_SEARCH = true;\n      this.entitySearchHelp.FIELDS = [\n        {FIELD_NAME: 'ENTITY_ID', LIST_HEADER_TEXT: 'Entity', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'ENTITY_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.entitySearchHelp.READ_ONLY = this.readonly || this.dataDomainForm.get('DOMAIN_TYPE').value !== 2;\n    }\n    const afterExportFn = function (context: any) {\n      return () => context.onChangeEntityID(control);\n    }(this).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.entitySearchHelp, control, afterExportFn);\n  }\n\n  onChangeEntityID(formGroup: AbstractControl): void {\n    this._getRelationsOfEntity(formGroup, true);\n  }\n\n  _getRelationsOfEntity(dataDomainForm: AbstractControl, setDefault: boolean): void {\n    const domainEntityID = dataDomainForm.get('ENTITY_ID').value;\n    if (!domainEntityID) { return; }\n    this.entityService.getRelationMetaOfEntity(domainEntityID)\n      .subscribe(entityRelations => {\n        if (entityRelations[0]['msgType'] === 'E') {\n          dataDomainForm.get('ENTITY_ID').setErrors({message: entityRelations[0]['msgShortText']});\n        } else {\n          this.relationsOfEntity = entityRelations.map(relationMeta => relationMeta.RELATION_ID )\n            .filter(relationId => relationId.substr(0, 2) !== 'rs' );\n          if (setDefault) {\n            dataDomainForm.get('RELATION_ID').setValue(this.relationsOfEntity[0]);\n            dataDomainForm.get('RELATION_ID').markAsDirty();\n          }\n        }\n      });\n  }\n\n  _setDomainType(formGroup: AbstractControl, markAsDirty: boolean): void {\n    if (markAsDirty) { formGroup.get('DOMAIN_TYPE').markAsDirty(); }\n    switch (+formGroup.get('DOMAIN_TYPE').value) {\n      case 0: // General Type\n        if (+formGroup.get('DATA_TYPE').value === 2) {\n          if (!this.readonly) { formGroup.get('UNSIGNED').enable(); }\n          this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        } else if (+formGroup.get('DATA_TYPE').value === 1) {\n          if (!this.readonly) { formGroup.get('CAPITAL_ONLY').enable(); }\n          this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        }\n        this._invalidField(formGroup.get('REG_EXPR'), markAsDirty);\n        this._invalidField(formGroup.get('ENTITY_ID'), markAsDirty);\n        this._invalidField(formGroup.get('RELATION_ID'), markAsDirty);\n        this._invalidField(formGroup.get('DOMAIN_VALUES'), markAsDirty, true);\n        break;\n      case 1: // Regular Expression\n        // formGroup.get('REG_EXPR').setValidators(this._validateRegExpr);\n        if (!this.readonly) { formGroup.get('REG_EXPR').enable(); }\n        this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        this._invalidField(formGroup.get('ENTITY_ID'), markAsDirty);\n        this._invalidField(formGroup.get('RELATION_ID'), markAsDirty);\n        this._invalidField(formGroup.get('DOMAIN_VALUES'), markAsDirty, true);\n        break;\n      case 2: // Value Relation\n        if (!this.readonly) {\n          formGroup.get('ENTITY_ID').enable();\n          formGroup.get('RELATION_ID').enable();\n          formGroup.get('ENTITY_ID').setValidators(this._validateEntityID);\n          formGroup.get('RELATION_ID').setValidators(this._validateRelationID);\n        }\n        this._invalidField(formGroup.get('REG_EXPR'), markAsDirty);\n        this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        this._invalidField(formGroup.get('DOMAIN_VALUES'), markAsDirty, true);\n        break;\n      case 3: // Value Array\n        if (!this.readonly) { formGroup.get('DOMAIN_VALUES').enable(); }\n        this._invalidField(formGroup.get('ENTITY_ID'), markAsDirty);\n        this._invalidField(formGroup.get('RELATION_ID'), markAsDirty);\n        this._invalidField(formGroup.get('REG_EXPR'), markAsDirty);\n        this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        this._generateEmptyLines(5);\n        break;\n      case 4: // Value Interval\n        if (!this.readonly) { formGroup.get('DOMAIN_VALUES').enable(); }\n        this._invalidField(formGroup.get('ENTITY_ID'), markAsDirty);\n        this._invalidField(formGroup.get('RELATION_ID'), markAsDirty);\n        this._invalidField(formGroup.get('REG_EXPR'), markAsDirty);\n        this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        this._generateEmptyLines(5);\n        break;\n      default:\n    }\n  }\n\n  _generateEmptyLines(num: number): void {\n    const existingLines = this.domainValueFormArray.length;\n    for (let i = 0; i < num - existingLines; i++) {\n      this.domainValueFormArray.push(\n        this.fb.group({\n          LOW_VALUE: [''],\n          LOW_VALUE_TEXT: [''],\n          HIGH_VALUE: ['']\n        }));\n    }\n  }\n\n  onChangeDataType(formGroup: AbstractControl): void {\n    switch (+formGroup.get('DATA_TYPE').value) {\n      case 1: // char\n        formGroup.get('DATA_LENGTH').setValue(10);\n        formGroup.get('DECIMAL').setValue(null);\n        break;\n      case 4: // decimal\n        formGroup.get('DATA_LENGTH').setValue(23);\n        formGroup.get('DECIMAL').setValue(2);\n        break;\n      default:\n        formGroup.get('DATA_LENGTH').setValue(null);\n        formGroup.get('DECIMAL').setValue(null);\n    }\n    formGroup.get('DATA_LENGTH').markAsDirty();\n    formGroup.get('DECIMAL').markAsDirty();\n    this._updateLengthAndDecimal(formGroup, true);\n  }\n\n  _updateLengthAndDecimal(formGroup: AbstractControl, markAsDirty: boolean): void {\n    switch (+formGroup.get('DATA_TYPE').value) {\n      case 1: // char\n        if (!this.readonly) {\n          formGroup.get('DATA_LENGTH').enable();\n          formGroup.get('DATA_LENGTH').setValidators(this._validateDataLength);\n        }\n        this._invalidField(formGroup.get('DECIMAL'));\n        if (+formGroup.get('DOMAIN_TYPE').value === 0) {\n          if (!this.readonly) { formGroup.get('CAPITAL_ONLY').enable(); }\n          this._invalidField(formGroup.get('UNSIGNED'));\n        }\n        this.enableGeneralType = true;\n        this.enableRegExpr = true;\n        this.enableValueRelation = true;\n        this.enableArrayOrInterval = true;\n        break;\n      case 2: // Integer\n        formGroup.get('DATA_LENGTH').disable();\n        this._invalidField(formGroup.get('DECIMAL'), markAsDirty);\n        if (+formGroup.get('DOMAIN_TYPE').value === 0) {\n          if (!this.readonly) { formGroup.get('UNSIGNED').enable(); }\n          this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        } else if (+formGroup.get('DOMAIN_TYPE').value === 1 || +formGroup.get('DOMAIN_TYPE').value === 2) {\n          if (!this.readonly) { formGroup.get('DOMAIN_TYPE').setValue(0); }\n          this._setDomainType(formGroup, markAsDirty);\n        }\n        this.enableGeneralType = true;\n        this.enableRegExpr = false;\n        this.enableValueRelation = false;\n        this.enableArrayOrInterval = true;\n        break;\n      case 4: // decimal\n        if (!this.readonly) {\n          formGroup.get('DATA_LENGTH').enable();\n          formGroup.get('DATA_LENGTH').setValidators(this._validateDataLength);\n          formGroup.get('DECIMAL').enable();\n          formGroup.get('DECIMAL').setValidators(this._validateDecimal);\n          formGroup.get('UNSIGNED').enable();\n        }\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        formGroup.get('DOMAIN_TYPE').setValue(0);\n        this._setDomainType(formGroup, markAsDirty);\n        this.enableGeneralType = true;\n        this.enableRegExpr = false;\n        this.enableValueRelation = false;\n        this.enableArrayOrInterval = false;\n        break;\n      case 5: // string\n        this._invalidField(formGroup.get('DATA_LENGTH'), markAsDirty);\n        this._invalidField(formGroup.get('DECIMAL'), markAsDirty);\n        formGroup.get('DOMAIN_TYPE').setValue(1);\n        this._setDomainType(formGroup, markAsDirty);\n        this.enableGeneralType = false;\n        this.enableRegExpr = true;\n        this.enableValueRelation = false;\n        this.enableArrayOrInterval = false;\n        break;\n      default:\n        this._invalidField(formGroup.get('DATA_LENGTH'), markAsDirty);\n        this._invalidField(formGroup.get('DECIMAL'), markAsDirty);\n        this._invalidField(formGroup.get('CAPITAL_ONLY'), markAsDirty);\n        this._invalidField(formGroup.get('UNSIGNED'), markAsDirty);\n        formGroup.get('DOMAIN_TYPE').setValue(0);\n        this._setDomainType(formGroup, markAsDirty);\n        this.enableGeneralType = true;\n        this.enableRegExpr = false;\n        this.enableValueRelation = false;\n        this.enableArrayOrInterval = false;\n    }\n  }\n\n  _invalidField(fieldCtrl: AbstractControl, markAsDirty: boolean = false, isArray: boolean = false): void {\n    fieldCtrl.clearValidators();\n    fieldCtrl.clearAsyncValidators();\n    fieldCtrl.disable();\n    if (markAsDirty) {\n      isArray ? (<FormArray>fieldCtrl).clear() : fieldCtrl.setValue(null);\n      fieldCtrl.markAsDirty();\n    }\n  }\n\n  onChangeDomainValue(index: number): void {\n    const currentDomainValueCtrl = this.domainValueFormArray.at(index);\n    if (!currentDomainValueCtrl.get('LOW_VALUE').value) { return; }\n    const indexFound = this.domainValueFormArray.controls.findIndex(\n      (ctrl, valueIndex) => index !== valueIndex && ctrl.value.LOW_VALUE === currentDomainValueCtrl.value.LOW_VALUE);\n    if (indexFound > -1) {\n      currentDomainValueCtrl.get('LOW_VALUE').setErrors({message: 'Value is duplicated!'});\n    } else {\n      currentDomainValueCtrl.get('LOW_VALUE').setErrors(null);\n    }\n\n    if (this.dataDomainForm.get('DOMAIN_TYPE').value === 4 && currentDomainValueCtrl.get('LOW_VALUE').value) {\n      if (!currentDomainValueCtrl.value.HIGH_VALUE ||\n        currentDomainValueCtrl.value.HIGH_VALUE <=  currentDomainValueCtrl.value.LOW_VALUE ) {\n        currentDomainValueCtrl.get('HIGH_VALUE').setErrors({message: 'High value must be greater!'});\n      } else {\n        currentDomainValueCtrl.get('HIGH_VALUE').setErrors(null);\n      }\n    }\n  }\n\n  insertDomainValue(index: number): void {\n    this.domainValueFormArray.insert(index, this.fb.group({\n        LOW_VALUE: [''],\n        LOW_VALUE_TEXT: [''],\n        HIGH_VALUE: ['']\n      }));\n  }\n\n  deleteDomainValue(index: number): void {\n    this.domainValueFormArray.removeAt(index);\n    this.domainValueFormArray.markAsDirty();\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.dataDomainForm && this.dataDomainForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.dataDomainForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (this.dataDomainForm.invalid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (+this.dataDomainForm.get('DOMAIN_TYPE').value >= 3 && this.domainValueFormArray.length === 0 ) {\n      return this.messageService.reportMessage('MODEL', 'MINIMUM_ONE_DOMAIN_VALUE', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedDataDomain['action'] = 'add';\n      this.changedDataDomain['DOMAIN_ID'] = this.dataDomainForm.get('DOMAIN_ID').value;\n    } else {\n      this.changedDataDomain['action'] = 'update';\n      this.changedDataDomain['DOMAIN_ID'] = this.dataDomainMeta.DOMAIN_ID;\n    }\n    if (this.dataDomainForm.get('DOMAIN_DESC').dirty) {\n      this.changedDataDomain['DOMAIN_DESC'] = this.dataDomainForm.get('DOMAIN_DESC').value;\n    }\n    if (this.dataDomainForm.get('DATA_TYPE').dirty) {\n      this.changedDataDomain['DATA_TYPE'] = this.dataDomainForm.get('DATA_TYPE').value;\n    }\n    if (this.dataDomainForm.get('DATA_LENGTH').dirty) {\n      this.changedDataDomain['DATA_LENGTH'] = this.dataDomainForm.get('DATA_LENGTH').value;\n    }\n    if (this.dataDomainForm.get('DECIMAL').dirty) {\n      this.changedDataDomain['DECIMAL'] = this.dataDomainForm.get('DECIMAL').value;\n    }\n    if (this.dataDomainForm.get('DOMAIN_TYPE').dirty) {\n      this.changedDataDomain['DOMAIN_TYPE'] = this.dataDomainForm.get('DOMAIN_TYPE').value;\n    }\n    if (this.dataDomainForm.get('UNSIGNED').dirty) {\n      this.changedDataDomain['UNSIGNED'] = this.dataDomainForm.get('UNSIGNED').value;\n    }\n    if (this.dataDomainForm.get('CAPITAL_ONLY').dirty) {\n      this.changedDataDomain['CAPITAL_ONLY'] = this.dataDomainForm.get('CAPITAL_ONLY').value;\n    }\n    if (this.dataDomainForm.get('REG_EXPR').dirty) {\n      this.changedDataDomain['REG_EXPR'] = this.dataDomainForm.get('REG_EXPR').value;\n    }\n    if (this.dataDomainForm.get('ENTITY_ID').dirty) {\n      this.changedDataDomain['ENTITY_ID'] = this.dataDomainForm.get('ENTITY_ID').value;\n    }\n    if (this.dataDomainForm.get('RELATION_ID').dirty) {\n      this.changedDataDomain['RELATION_ID'] = this.dataDomainForm.get('RELATION_ID').value;\n    }\n    if (this.dataDomainForm.get('DOMAIN_VALUES').dirty) {\n      this.changedDataDomain['DOMAIN_VALUES'] = [];\n      this.dataDomainForm.get('DOMAIN_VALUES').value.forEach( domainValue => {\n        if (domainValue.LOW_VALUE) {\n          this.changedDataDomain['DOMAIN_VALUES'].push(domainValue);\n        }\n      });\n    }\n    this.entityService.saveDataDomain(this.changedDataDomain)\n      .subscribe(data => this._postActivityAfterSavingDataDomain(data));\n  }\n\n  _postActivityAfterSavingDataDomain(data: any) {\n    this.changedDataDomain = {};\n    if (data['DOMAIN_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/data-domain/' + data['DOMAIN_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'DATA_DOMAIN_SAVED', 'S', data['DOMAIN_ID'])}});\n      } else {\n        this._switch2DisplayMode();\n        this.dataDomainMeta = data;\n        this._generateDataDomainForm();\n        this.messageService.reportMessage('MODEL', 'DATA_DOMAIN_SAVED', 'S', data['DOMAIN_ID']);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n\n\n","import {Component, Input, OnChanges, OnInit, ViewChild} from '@angular/core';\nimport {AbstractControl, FormArray, FormBuilder, FormGroup} from '@angular/forms';\nimport {Attribute} from 'jor-angular';\nimport {ModelService} from '../model.service';\nimport {Observable} from 'rxjs';\nimport {SearchHelpMethod, SearchHelp, EntityService, SearchHelpComponent} from 'jor-angular';\nimport {MessageService, Message} from 'ui-message-angular';\nimport {msgStore} from '../../msgStore';\nimport {Router} from '@angular/router';\n\n@Component({\n  selector: 'app-attribute-meta',\n  templateUrl: './attribute-meta.component.html',\n  styleUrls: ['./attribute-meta.component.css']\n})\nexport class AttributeMetaComponent implements OnInit, OnChanges {\n  dataTypes = [];\n  formArray: FormArray;\n  deletedAttributes = [];\n  dataElementSearchHelp: SearchHelp;\n\n  constructor(private fb: FormBuilder,\n              private router: Router,\n              private entityService: EntityService,\n              private messageService: MessageService,\n              private modelService: ModelService) {\n    this.dataTypes = modelService.dataTypes;\n    this.messageService.setMessageStore(msgStore, 'EN');\n  }\n\n  @Input() parentForm: FormGroup;\n  @Input() attributes: Attribute[];\n  @Input() readonly: boolean;\n  @Input() relationID: string;\n  @Input() isNewMode: boolean;\n\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent !: SearchHelpComponent;\n\n  ngOnInit() {\n  }\n\n  ngOnChanges() {\n    this.generateFormArray();\n    this.formArray = this.parentForm.get('ATTRIBUTES') as FormArray;\n  }\n\n  onSearchHelp(control: AbstractControl, rowID: number): void {\n    if (!this.dataElementSearchHelp) {\n      this.dataElementSearchHelp = new SearchHelp();\n      this.dataElementSearchHelp.OBJECT_NAME = 'Data Element';\n      this.dataElementSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listDataElement(searchTerm);\n      }(this.entityService);\n      this.dataElementSearchHelp.BEHAVIOUR = 'A';\n      this.dataElementSearchHelp.MULTI = false;\n      this.dataElementSearchHelp.FUZZY_SEARCH = true;\n      this.dataElementSearchHelp.FIELDS = [\n        {FIELD_NAME: 'ELEMENT_ID', LIST_HEADER_TEXT: 'Element ID', IE_FIELD_NAME: 'DATA_ELEMENT',\n          IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'ELEMENT_DESC', LIST_HEADER_TEXT: 'Element Description', IE_FIELD_NAME: 'ATTR_DESC',\n          IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.dataElementSearchHelp.READ_ONLY = this.readonly || control.get('DATA_ELEMENT').disabled;\n    }\n    const afterExportFn = function (context: any, attrIdx: number) {\n      return () => context.onChangeDataElement(attrIdx);\n    }(this, rowID).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.dataElementSearchHelp, control, afterExportFn);\n  }\n\n  deleteAttribute(index: number): void {\n    if (index !== this.formArray.length - 1) {\n      this.deletedAttributes.push({\n        ATTR_GUID: this.formArray.at(index).get('ATTR_GUID').value,\n        ATTR_NAME: this.formArray.at(index).get('ATTR_NAME').value\n      });\n      this.formArray.removeAt(index);\n      this.formArray.markAsDirty();\n    }\n  }\n\n  insertAttribute(index: number): void {\n    this.formArray.insert(index, this._createAnAttributeFormCtrl());\n  }\n\n  _createAnAttributeFormCtrl(): FormGroup {\n    return this.fb.group({\n      ATTR_GUID: [''],\n      RELATION_ID: [''],\n      ATTR_NAME: [''],\n      ATTR_DESC: [{value: '', disabled: true}],\n      DATA_ELEMENT: [{value: '', disabled: false}],\n      DATA_TYPE: [{value: '', disabled: true}],\n      DATA_LENGTH: [{value: '', disabled: true}],\n      DECIMAL: [null],\n      ORDER: [null],\n      PRIMARY_KEY: [false],\n      AUTO_INCREMENT: [{value: false, disabled: true}]\n    });\n  }\n\n  switchBtwDEAndDT(index: number): void {\n    const currentAttributeFormCtrl = this.formArray.at(index);\n    const dataElementCtrl = currentAttributeFormCtrl.get('DATA_ELEMENT');\n    if (dataElementCtrl.enabled) {\n      this._disableField(dataElementCtrl);\n      this._enableField(currentAttributeFormCtrl.get('ATTR_DESC'));\n      this._enableField(currentAttributeFormCtrl.get('DATA_TYPE'));\n      this._enableField(currentAttributeFormCtrl.get('DATA_LENGTH'));\n      this._enableField(currentAttributeFormCtrl.get('DECIMAL'));\n      currentAttributeFormCtrl.get('DATA_TYPE').setValue(1);\n      currentAttributeFormCtrl.get('DATA_LENGTH').setValue(10);\n      this._disableField(currentAttributeFormCtrl.get('AUTO_INCREMENT'));\n    } else {\n      dataElementCtrl.enable();\n      this._enableField(dataElementCtrl);\n      this._disableField(currentAttributeFormCtrl.get('ATTR_DESC'));\n      this._disableField(currentAttributeFormCtrl.get('DATA_TYPE'));\n      this._disableField(currentAttributeFormCtrl.get('DATA_LENGTH'));\n      this._disableField(currentAttributeFormCtrl.get('DECIMAL'));\n      this._disableField(currentAttributeFormCtrl.get('AUTO_INCREMENT'));\n    }\n  }\n\n  _enableField(ctrl: AbstractControl) {\n    ctrl.setValue(null);\n    ctrl.enable();\n  }\n\n  _disableField(ctrl: AbstractControl) {\n    if (ctrl.value !== null && ctrl.value !== '') {\n      ctrl.setValue(null);\n      ctrl.markAsDirty();\n    }\n    ctrl.disable();\n  }\n\n  onChangeDataType(attrFormGroup: AbstractControl): void {\n    switch (attrFormGroup.get('DATA_TYPE').value) {\n      case '1': // char\n        attrFormGroup.get('DATA_LENGTH').setValue(10);\n        attrFormGroup.get('DECIMAL').setValue(null);\n        this._disableField(attrFormGroup.get('AUTO_INCREMENT'));\n        break;\n      case '2': // Integer\n        attrFormGroup.get('DATA_LENGTH').setValue(null);\n        attrFormGroup.get('DECIMAL').setValue(null);\n        this._enableField(attrFormGroup.get('AUTO_INCREMENT'));\n        break;\n      case '4': // decimal\n        attrFormGroup.get('DATA_LENGTH').setValue(23);\n        attrFormGroup.get('DECIMAL').setValue(2);\n        this._disableField(attrFormGroup.get('AUTO_INCREMENT'));\n        break;\n      default:\n        attrFormGroup.get('DATA_LENGTH').setValue(null);\n        attrFormGroup.get('DECIMAL').setValue(null);\n        this._disableField(attrFormGroup.get('AUTO_INCREMENT'));\n    }\n    attrFormGroup.get('DATA_LENGTH').markAsDirty();\n  }\n\n  onChangeAttributeName(index: number): void {\n    if (index === this.formArray.length - 1 && !this.formArray.controls[index].value.ATTR_GUID) {\n      // Only work for the last New line\n      this.formArray.push(this._createAnAttributeFormCtrl());\n    }\n  }\n\n  onChangeDataElement(index: number): void {\n    const attributeFormGroup = this.formArray.at(index);\n    const dataElementCtrl = attributeFormGroup.get('DATA_ELEMENT');\n    this.entityService.getDataElement(dataElementCtrl.value).subscribe(data => {\n      if (data['msgCat']) {\n        dataElementCtrl.setErrors({message: data['msgShortText']});\n      } else {\n        attributeFormGroup.get('ATTR_DESC').setValue(data['ELEMENT_DESC']);\n        attributeFormGroup.get('DATA_TYPE').setValue(data['DATA_TYPE']);\n        attributeFormGroup.get('DATA_LENGTH').setValue(data['DATA_LENGTH']);\n        attributeFormGroup.get('DECIMAL').setValue(data['DECIMAL']);\n        if (attributeFormGroup.get('DATA_TYPE').value === 2) {\n          this._enableField(attributeFormGroup.get('AUTO_INCREMENT'));\n        } else {\n          this._disableField(attributeFormGroup.get('AUTO_INCREMENT'));\n        }\n      }\n    });\n  }\n\n  checkAttributes(): Message[] {\n    const Messages: Message[] = [];\n    if ( this.formArray.controls.findIndex( control => control.get('PRIMARY_KEY').value ) === -1 ) {\n      Messages.push(this.messageService.generateMessage(\n        'MODEL', 'RELATION_PRIMARY_KEY_MISSING', 'E'));\n    }\n    return Messages;\n  }\n\n  processChangedAttributes(): any[] {\n    const changedAttributes = [];\n    let changedAttribute;\n    let order = 0;\n    if (this.formArray.dirty) {\n      this.formArray.controls.forEach((attribute, index) => {\n        if (attribute.get('ATTR_NAME').value.trim() === '') { return; }\n        order = index + 1;\n        if (order !== attribute.get('ORDER').value) {\n          attribute.get('ORDER').setValue(order);\n          attribute.get('ORDER').markAsDirty();\n        }\n        if (attribute.dirty) {\n          changedAttribute = {};\n          if (attribute.get('ATTR_GUID').value) { // Update Case\n            changedAttribute['action'] = 'update';\n            changedAttribute['ATTR_GUID'] = attribute.get('ATTR_GUID').value;\n            const attrFormGroup = attribute as FormGroup;\n            Object.keys(attrFormGroup.controls).forEach(key => {\n              const formControl = attrFormGroup.controls[key];\n              if (formControl.dirty) {\n                changedAttribute[key] = formControl.value;\n              }\n            });\n          } else { // New Add Case\n            changedAttribute['action'] = 'add';\n            const attrFormGroup = attribute as FormGroup;\n            Object.keys(attrFormGroup.controls).forEach(key => {\n              const formControl = attrFormGroup.controls[key];\n              changedAttribute[key] = formControl.value;\n            });\n          }\n        } else {\n          changedAttribute = null;\n        }\n        if (changedAttribute) {\n          changedAttributes.push(changedAttribute);\n        }\n      });\n\n      // Deletion Case\n      this.deletedAttributes.forEach(attribute => {\n        changedAttribute = {action: 'delete', ATTR_GUID: attribute.ATTR_GUID, ATTR_NAME: attribute.ATTR_NAME};\n        changedAttributes.push(changedAttribute);\n      });\n\n      return changedAttributes;\n    }\n  }\n\n  generateFormArray(): void {\n    const formArray = [];\n    if (this.attributes) {\n      this.attributes.forEach( attribute => {\n        const isDataElementAttribute = !!attribute.DATA_ELEMENT;\n        formArray.push(this.fb.group({\n          ATTR_GUID: [attribute.ATTR_GUID],\n          RELATION_ID: [attribute.RELATION_ID],\n          ATTR_NAME: [attribute.ATTR_NAME],\n          ATTR_DESC: [{value: attribute.ATTR_DESC, disabled: isDataElementAttribute}],\n          DATA_ELEMENT: [{value: attribute.DATA_ELEMENT, disabled: !isDataElementAttribute}],\n          DATA_TYPE: [{value: attribute.DATA_TYPE, disabled: this.readonly || this.isFieldGray(attribute) || isDataElementAttribute}],\n          DATA_LENGTH: [{value: attribute.DATA_LENGTH, disabled: isDataElementAttribute}],\n          DECIMAL: [{value: attribute.DECIMAL, disabled: isDataElementAttribute}],\n          ORDER: [attribute.ORDER],\n          PRIMARY_KEY: [{value: attribute.PRIMARY_KEY, disabled: this.readonly || this.isFieldGray(attribute)}],\n          AUTO_INCREMENT: [{\n            value: attribute.AUTO_INCREMENT,\n            disabled: this.readonly || this.isFieldGray(attribute) || attribute.DATA_TYPE !== 2}]\n        }));\n      });\n    }\n    if (this.isNewMode) {\n      formArray.push(this._createAnAttributeFormCtrl());\n    }\n    this.parentForm.addControl('ATTRIBUTES', new FormArray(formArray));\n  }\n\n  switchEditDisplay(readonly: boolean) {\n    if (!readonly) { // To Edit Mode\n      this.formArray.controls.forEach(attrFormGroup => {\n        if (!this.isFieldGray(attrFormGroup.value)) {\n          if (!attrFormGroup.get('DATA_ELEMENT').value) {\n            attrFormGroup.get('DATA_TYPE').enable();\n          }\n          attrFormGroup.get('PRIMARY_KEY').enable();\n          if (attrFormGroup.get('DATA_TYPE').value === 2) {\n            attrFormGroup.get('AUTO_INCREMENT').enable();\n          } else {\n            attrFormGroup.get('AUTO_INCREMENT').disable();\n          }\n        }\n      });\n      this.formArray.push(this._createAnAttributeFormCtrl());\n    } else { // To Display Mode\n      let lastIndex = this.formArray.length - 1;\n      while (lastIndex >= 0 && this.formArray.controls[lastIndex].get('ATTR_NAME').value.trim() === '') {\n        this.formArray.removeAt(lastIndex);\n        lastIndex--;\n      }\n      this.formArray.controls.forEach(attrFormGroup => {\n        attrFormGroup.get('DATA_TYPE').disable();\n        attrFormGroup.get('PRIMARY_KEY').disable();\n        attrFormGroup.get('AUTO_INCREMENT').disable();\n      });\n    }\n  }\n\n  isFieldGray(attribute: Attribute): boolean {\n    return this.relationID.substr(0, 3) === 'rs_' &&\n        attribute && attribute.ATTR_NAME &&\n       (attribute.ATTR_NAME === 'VALID_FROM' ||\n        attribute.ATTR_NAME === 'VALID_TO' ||\n        attribute.ATTR_NAME.substr(-14, 14) === '_INSTANCE_GUID' ||\n        attribute.ATTR_NAME.substr(-10, 10) === '_ENTITY_ID');\n  }\n\n  onGoToDataElement(dataElementName: string): void {\n    this.router.navigate(['/model/data-element', dataElementName]);\n  }\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL3NlYXJjaC1oZWxwL3NlYXJjaC1oZWxwLmNvbXBvbmVudC5jc3MifQ== */\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL3JlbGF0aW9uc2hpcC9yZWxhdGlvbnNoaXAtZGV0YWlsL3JlbGF0aW9uc2hpcC1kZXRhaWwuY29tcG9uZW50LmNzcyJ9 */\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL2RhdGEtZWxlbWVudC9kYXRhLWVsZW1lbnQuY29tcG9uZW50LmNzcyJ9 */\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL3JlbGF0aW9uL3JlbGF0aW9uLmNvbXBvbmVudC5jc3MifQ== */\";","export default \"<div class=\\\"row\\\">\\n  <div *ngIf=\\\"isSearchListShown\\\" class=\\\"col-3\\\">\\n    <div class=\\\"btn-toolbar justify-content-between mb-2\\\" role=\\\"toolbar\\\">\\n      <div class=\\\"input-group\\\">\\n        <input type=\\\"text\\\" class=\\\"form-control\\\" placeholder=\\\"Search\\\" #searchBox (keyup)=\\\"searchDataElement(searchBox.value)\\\" >\\n      </div>\\n\\n      <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Hide\\\" (click)=\\\"hideSearchList()\\\" [disabled]=\\\"!theSelectedDataElement\\\">\\n          <span class=\\\"fas fa-arrow-left\\\"></span>\\n        </button>\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Add\\\" (click)=\\\"newDataElement()\\\">\\n          <span class=\\\"fas fa-plus\\\"></span>\\n        </button>\\n      </div>\\n    </div>\\n    <div class=\\\"list-group\\\">\\n      <a *ngFor=\\\"let dataElement of dataElementList\\\" routerLink=\\\"/model/data-element/{{dataElement.ELEMENT_ID}}\\\" routerLinkActive=\\\"active\\\"\\n         (click)=\\\"onSelect(dataElement)\\\" class=\\\"list-group-item list-group-item-action flex-column align-items-start\\\">\\n        <div class=\\\"d-flex w-100 justify-content-between\\\">\\n          <h5 class=\\\"mb-1\\\">{{dataElement.ELEMENT_ID}}</h5>\\n          <small>version: {{dataElement.VERSION_NO}}</small>\\n        </div>\\n        <p class=\\\"mb-1\\\">{{dataElement.ELEMENT_DESC}}</p>\\n        <!--<small>created by: {{entityType.CREATE_BY}} @{{entityType.CREATE_TIME}}</small> <br/>-->\\n        <small>last changed by: {{dataElement.LAST_CHANGE_BY}} @{{dataElement.LAST_CHANGE_TIME}}</small>\\n      </a>\\n    </div>\\n  </div>\\n  <div [ngClass]=\\\"{'col-9': isSearchListShown, 'col-12': !isSearchListShown}\\\">\\n    <router-outlet></router-outlet>\\n  </div>\\n</div>\\n\";","import { Component, OnInit } from '@angular/core';\nimport {Subject} from 'rxjs';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {DataDomainH, DataDomainMeta, EntityService} from 'jor-angular';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-data-domain',\n  templateUrl: './data-domain.component.html',\n  styleUrls: ['./data-domain.component.css']\n})\nexport class DataDomainComponent implements OnInit {\n  dataDomainList: DataDomainH[] = [];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedDataDomain: DataDomainH;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listDataDomain(term)),\n    ).subscribe(data => {\n      this.dataDomainList = data;\n      let domainID;\n      if (this.route.snapshot.firstChild) {\n        domainID = this.route.snapshot.firstChild.paramMap.get('domainID');\n      }\n      if (domainID ) {\n        if (domainID === 'new') {\n          this._newDataDomain();\n        } else {\n          this.onSelect(this.dataDomainList.find(dataDomain => dataDomain.DOMAIN_ID === domainID));\n        }\n      }\n    });\n    this.searchDataDomain(''); // The initial list\n\n    this.modelService.theSelectedDataDomain$.subscribe( data => {\n      if (this.theSelectedDataDomain) {\n        this.theSelectedDataDomain.DOMAIN_ID = data['DOMAIN_ID'];\n        this.theSelectedDataDomain.DOMAIN_DESC = data['DOMAIN_DESC'];\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.dataDomainList[0] && !this.dataDomainList[0].CREATE_TIME) {\n        this.dataDomainList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const domainID = this.route.snapshot.firstChild.paramMap.get('domainID');\n        if (domainID) {\n          if (domainID === 'new') {\n            this.onSelect(this.dataDomainList[0]);\n          } else {\n            this.onSelect(this.dataDomainList.find(dataDomain => dataDomain.DOMAIN_ID === domainID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  onSelect(dataDomain: DataDomainH): void {\n    if (dataDomain) {\n      this.theSelectedDataDomain = dataDomain;\n      this.modelService.setSelectedDataDomain(dataDomain);\n    }\n  }\n\n  searchDataDomain(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  newDataDomian(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('domainID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newDataDomain();\n      this.router.navigate(['/model/data-domain/new']);\n    }\n  }\n\n  _newDataDomain(): void {\n    this.theSelectedDataDomain = new DataDomainMeta();\n    this.theSelectedDataDomain.DOMAIN_ID = 'new';\n    this.theSelectedDataDomain.DOMAIN_DESC = 'description';\n    this.theSelectedDataDomain.VERSION_NO = 1;\n    this.theSelectedDataDomain.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedDataDomain.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedDataDomain(this.theSelectedDataDomain);\n    this.dataDomainList.splice(0, 0, this.theSelectedDataDomain);\n  }\n}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-model',\n  templateUrl: './model.component.html',\n  styleUrls: ['./model.component.css']\n})\nexport class ModelComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","import { Component, OnInit } from '@angular/core';\nimport {Relation} from 'jor-angular';\nimport {Subject} from 'rxjs';\nimport {EntityService} from 'jor-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-relation',\n  templateUrl: './relation.component.html',\n  styleUrls: ['./relation.component.css']\n})\nexport class RelationComponent implements OnInit {\n\n  relationList: Relation[];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedRelation: Relation;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listRelation(term)),\n    ).subscribe(data => {\n      this.relationList = data;\n      let relationID;\n      if (this.route.snapshot.firstChild) {\n        relationID = this.route.snapshot.firstChild.paramMap.get('relationID');\n      }\n      if (relationID) {\n        if (relationID === 'new') {\n          this._newRelation();\n        } else {\n          this.onSelect(this.relationList.find(relation => relation.RELATION_ID === relationID));\n        }\n      }\n    });\n    this.searchRelation(''); // The initial list\n\n    this.modelService.theSelectedRelation$.subscribe( data => {\n      if (this.theSelectedRelation) {\n        this.theSelectedRelation.RELATION_ID = data.RELATION_ID;\n        this.theSelectedRelation.RELATION_DESC = data.RELATION_DESC;\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.relationList[0] && !this.relationList[0].CREATE_TIME) {\n        this.relationList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const relationID = this.route.snapshot.firstChild.paramMap.get('relationID');\n        if (relationID) {\n          if (relationID === 'new') {\n            this.onSelect(this.relationList[0]);\n          } else {\n            this.onSelect(this.relationList.find(relation => relation.RELATION_ID === relationID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  searchRelation(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  onSelect(relation: Relation): void {\n    if (relation) {\n      this.theSelectedRelation = relation;\n      this.modelService.setSelectedRelation(relation);\n    }\n  }\n\n  newRelation(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('relationID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newRelation();\n      this.router.navigate(['/model/relation/new']);\n    }\n  }\n\n  _newRelation(): void {\n    this.theSelectedRelation = new Relation();\n    this.theSelectedRelation.RELATION_ID = 'r_new';\n    this.theSelectedRelation.RELATION_DESC = 'description';\n    this.theSelectedRelation.VERSION_NO = 1;\n    this.theSelectedRelation.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedRelation.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedRelation(this.theSelectedRelation);\n    this.relationList.splice(0, 0, this.theSelectedRelation);\n  }\n}\n","export default \"<div class=\\\"btn-toolbar mb-2\\\"  role=\\\"toolbar\\\"\\n     [ngClass]=\\\"{'justify-content-end': isSearchListShown, 'justify-content-between': !isSearchListShown}\\\" >\\n  <button *ngIf=\\\"!isSearchListShown\\\" class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Show List\\\" (click)=\\\"showSearchList()\\\">\\n    <span class=\\\"fas fa-arrow-right\\\"></span>\\n  </button>\\n\\n  <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Edit/Display\\\" (click)=\\\"switchEditDisplay()\\\">\\n      <span *ngIf=\\\"readonly\\\" class=\\\"fas fa-edit\\\"></span>\\n      <span *ngIf=\\\"!readonly\\\" class=\\\"fas fa-glasses\\\"></span>\\n    </button>\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Save\\\" (click)=\\\"save()\\\">\\n      <span class=\\\"fas fa-save\\\"></span>\\n    </button>\\n  </div>\\n</div>\\n\\n<dk-message></dk-message>\\n<form *ngIf=\\\"relationMeta\\\" [formGroup]=\\\"relationForm\\\">\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"relation\\\" class=\\\"col-form-label form-control-sm\\\">Relation:\\n      <span [class.ng-invalid]=\\\"relationForm.get('RELATION_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n        {{relationForm.get('RELATION_ID').errors?.message}}\\n      </span>\\n    </label>\\n    <input type=\\\"text\\\" class=\\\"form-control form-control-sm\\\" id=\\\"relation\\\" [readonly]=\\\"readonly || !isNewMode\\\"\\n          name=\\\"relation\\\" formControlName=\\\"RELATION_ID\\\" >\\n  </div>\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"relation-desc\\\" class=\\\"col-form-label form-control-sm\\\">Relation Description:</label>\\n    <textarea class=\\\"form-control\\\" id=\\\"relation-desc\\\" name=\\\"relation-desc\\\" rows=\\\"2\\\"\\n              (change)=\\\"onChangeRelationDesc()\\\" formControlName=\\\"RELATION_DESC\\\" [readonly]=\\\"readonly\\\"></textarea>\\n  </div>\\n\\n  <app-attribute-meta [readonly]=\\\"readonly\\\" [parentForm]=\\\"relationForm\\\" [attributes]=\\\"relationMeta.ATTRIBUTES\\\"\\n                      [relationID]=\\\"relationMeta.RELATION_ID\\\" [isNewMode]=\\\"isNewMode\\\">\\n  </app-attribute-meta>\\n\\n  <div class=\\\"card mt-2\\\">\\n    <div class=\\\"card-header\\\"><span class=\\\"fas fa-atlas\\\"></span> Association</div>\\n    <div class=\\\"card-body\\\">\\n      <table class=\\\"table table-bordered table-sm dk-table\\\">\\n        <thead class=\\\"thead-light\\\">\\n        <tr>\\n          <th scope=\\\"col\\\">Action</th>\\n          <th scope=\\\"col\\\">Association</th>\\n          <th scope=\\\"col\\\">Right Relation</th>\\n          <th scope=\\\"col\\\">Cardinality</th>\\n          <th scope=\\\"col\\\" title=\\\"Foreign Key Check\\\">FC</th>\\n        </tr>\\n        </thead>\\n\\n        <tbody formArrayName=\\\"ASSOCIATIONS\\\">\\n        <tr *ngFor=\\\"let associationFormGroup of associationFormArray.controls; let i = index\\\">\\n          <td class=\\\"dk-actions\\\">\\n            <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" [disabled]=\\\"readonly\\\" (click)=\\\"deleteAssociation(i)\\\" title=\\\"Delete\\\">\\n              <span class=\\\"far fa-trash-alt\\\"></span>\\n            </button>\\n            <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" (click)=\\\"openFieldMapModal(i)\\\" title=\\\"Fields Mapping\\\">\\n              <span class=\\\"fas fa-map-signs\\\"></span>\\n            </button>\\n          </td>\\n          <td [formGroup]=\\\"associationFormGroup\\\">\\n            <div class=\\\"input-group\\\">\\n              <input class=\\\"form-control form-control-sm\\\" type=\\\"text\\\" formControlName=\\\"ASSOCIATION_NAME\\\"\\n                     [readonly]=\\\"readonly || oldAssociationName(associationFormGroup) && associationFormGroup.valid\\\"\\n                     (change)=\\\"onChangeAssociationName(i)\\\">\\n              <div class=\\\"invalid-tooltip\\\">\\n                {{associationFormGroup.get('ASSOCIATION_NAME').errors?.message}}\\n              </div>\\n            </div>\\n          </td>\\n          <td [formGroup]=\\\"associationFormGroup\\\">\\n            <div class=\\\"input-group\\\">\\n              <input class=\\\"form-control form-control-sm\\\" type=\\\"text\\\" formControlName=\\\"RIGHT_RELATION_ID\\\"\\n                     [readonly]=\\\"readonly\\\" (change)=\\\"onChangeRightRelationID(i)\\\"\\n                     (dblclick)=\\\"onGoToRelation(associationFormGroup.value['RIGHT_RELATION_ID'])\\\">\\n              <div class=\\\"invalid-tooltip\\\">\\n                {{associationFormGroup.get('RIGHT_RELATION_ID').errors?.message}}\\n              </div>\\n              <div class=\\\"input-group-append\\\">\\n                <button class=\\\"btn btn-outline-secondary btn-sm\\\" type=\\\"button\\\" id=\\\"searchRelation\\\"\\n                        (click)=\\\"onSearchHelp('RIGHT_RELATION_ID', associationFormGroup, i)\\\">\\n                  <span class=\\\"fas fa-search\\\"></span>\\n                </button>\\n              </div>\\n            </div>\\n          </td>\\n          <td [formGroup]=\\\"associationFormGroup\\\">\\n            <select class=\\\"form-control form-control-sm\\\" formControlName=\\\"CARDINALITY\\\"\\n                    (change)=\\\"onChangeCardinality(associationFormGroup)\\\">\\n              <option>[0..1]</option>\\n              <option>[1..1]</option>\\n              <option>[0..n]</option>\\n              <option>[1..n]</option>\\n            </select>\\n          </td>\\n          <td [formGroup]=\\\"associationFormGroup\\\">\\n            <input type=\\\"checkbox\\\" formControlName=\\\"FOREIGN_KEY_CHECK\\\">\\n          </td>\\n        </tr>\\n\\n        <div *ngIf=\\\"currentAssociationForm\\\" class=\\\"modal fade dk-modal-open\\\" [ngClass]=\\\"{'show': isFieldMapShown}\\\"\\n             [ngStyle]=\\\"{'display': displayFieldMapModal}\\\" id=\\\"detailModal\\\" tabindex=\\\"-1\\\" role=\\\"dialog\\\">\\n          <div class=\\\"modal-dialog\\\" role=\\\"document\\\">\\n            <div class=\\\"modal-content\\\">\\n              <div class=\\\"modal-header\\\">\\n                <h5 class=\\\"modal-title\\\" id=\\\"detail\\\">Fields Mapping</h5>\\n                <button type=\\\"button\\\" class=\\\"close\\\" (click)=\\\"closeFieldMapModal()\\\">\\n                  <span aria-hidden=\\\"true\\\">&times;</span>\\n                </button>\\n              </div>\\n              <div class=\\\"modal-body\\\">\\n                <table class=\\\"table table-bordered table-sm dk-table\\\" [formGroup]=\\\"currentAssociationForm\\\">\\n                  <thead class=\\\"thead-light\\\">\\n                  <tr>\\n                    <th scope=\\\"col\\\">Action</th>\\n                    <th scope=\\\"col\\\">Left Table Field</th>\\n                    <th scope=\\\"col\\\">Right Table Field</th>\\n                  </tr>\\n                  </thead>\\n\\n                  <tbody formArrayName=\\\"FIELDS_MAPPING\\\">\\n                    <tr *ngFor=\\\"let fieldMapFormGroup of fieldMapFormArray.controls; let i = index\\\">\\n                      <td class=\\\"dk-actions\\\">\\n                        <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" [disabled]=\\\"readonly\\\" (click)=\\\"deleteFieldMap(i)\\\" title=\\\"Delete\\\">\\n                          <span class=\\\"far fa-trash-alt\\\"></span>\\n                        </button>\\n                      </td>\\n                      <td [formGroup]=\\\"fieldMapFormGroup\\\">\\n                        <div class=\\\"input-group\\\">\\n                          <input class=\\\"form-control form-control-sm\\\" type=\\\"text\\\" formControlName=\\\"LEFT_FIELD\\\"\\n                                 [readonly]=\\\"readonly || oldFieldMap(fieldMapFormGroup) && fieldMapFormGroup.valid\\\" (change)=\\\"onChangeLeftField(i)\\\">\\n                          <div class=\\\"invalid-tooltip\\\">\\n                            {{fieldMapFormGroup.get('LEFT_FIELD').errors?.message}}\\n                          </div>\\n                        </div>\\n                      </td>\\n                      <td [formGroup]=\\\"fieldMapFormGroup\\\">\\n                        <div class=\\\"input-group\\\">\\n                          <input class=\\\"form-control form-control-sm\\\" type=\\\"text\\\" formControlName=\\\"RIGHT_FIELD\\\"\\n                                 [readonly]=\\\"readonly || oldFieldMap(fieldMapFormGroup) && fieldMapFormGroup.valid\\\" (change)=\\\"onChangeRightField(i)\\\">\\n                          <div class=\\\"invalid-tooltip\\\">\\n                            {{fieldMapFormGroup.get('RIGHT_FIELD').errors?.message}}\\n                          </div>\\n                        </div>\\n                      </td>\\n                    </tr>\\n                  </tbody>\\n                </table>\\n              </div>\\n              <div class=\\\"modal-footer\\\">\\n                <button type=\\\"button\\\" class=\\\"btn btn-sm btn-primary\\\" (click)=\\\"closeFieldMapModal()\\\">OK</button>\\n              </div>\\n            </div>\\n          </div>\\n        </div>\\n\\n        </tbody>\\n      </table>\\n    </div>\\n  </div>\\n</form>\\n\\n<dk-app-search-help></dk-app-search-help>\\n\\n\";","export default \".dk-table {\\n  display: block;\\n  overflow-x: auto;\\n  white-space: nowrap;\\n  border: none;\\n}\\n.dk-actions{\\n  width: 3rem;\\n  min-width: 3rem;\\n  max-width: 3rem;\\n}\\n.dk-description{\\n  width: 15rem;\\n  min-width: 15rem;\\n  max-width: 15rem;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbW9kZWwvZW50aXR5LXR5cGUvZW50aXR5LXR5cGUtZGV0YWlsL2VudGl0eS10eXBlLWRldGFpbC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsY0FBYztFQUNkLGdCQUFnQjtFQUNoQixtQkFBbUI7RUFDbkIsWUFBWTtBQUNkO0FBQ0E7RUFDRSxXQUFXO0VBQ1gsZUFBZTtFQUNmLGVBQWU7QUFDakI7QUFDQTtFQUNFLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsZ0JBQWdCO0FBQ2xCIiwiZmlsZSI6InNyYy9hcHAvbW9kZWwvZW50aXR5LXR5cGUvZW50aXR5LXR5cGUtZGV0YWlsL2VudGl0eS10eXBlLWRldGFpbC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmRrLXRhYmxlIHtcbiAgZGlzcGxheTogYmxvY2s7XG4gIG92ZXJmbG93LXg6IGF1dG87XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gIGJvcmRlcjogbm9uZTtcbn1cbi5kay1hY3Rpb25ze1xuICB3aWR0aDogM3JlbTtcbiAgbWluLXdpZHRoOiAzcmVtO1xuICBtYXgtd2lkdGg6IDNyZW07XG59XG4uZGstZGVzY3JpcHRpb257XG4gIHdpZHRoOiAxNXJlbTtcbiAgbWluLXdpZHRoOiAxNXJlbTtcbiAgbWF4LXdpZHRoOiAxNXJlbTtcbn1cbiJdfQ== */\";","export default \"<div class=\\\"btn-toolbar mb-2\\\"  role=\\\"toolbar\\\"\\n     [ngClass]=\\\"{'justify-content-end': isSearchListShown, 'justify-content-between': !isSearchListShown}\\\" >\\n  <button *ngIf=\\\"!isSearchListShown\\\" class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Show List\\\" (click)=\\\"showSearchList()\\\">\\n    <span class=\\\"fas fa-arrow-right\\\"></span>\\n  </button>\\n\\n  <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Edit/Display\\\" (click)=\\\"switchEditDisplay()\\\">\\n      <span *ngIf=\\\"readonly\\\" class=\\\"fas fa-edit\\\"></span>\\n      <span *ngIf=\\\"!readonly\\\" class=\\\"fas fa-glasses\\\"></span>\\n    </button>\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Save\\\" (click)=\\\"save()\\\">\\n      <span class=\\\"fas fa-save\\\"></span>\\n    </button>\\n  </div>\\n</div>\\n\\n<dk-message></dk-message>\\n<form *ngIf=\\\"relationshipMeta\\\" [formGroup]=\\\"relationshipForm\\\">\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"relationship\\\" class=\\\"col-form-label form-control-sm\\\">Relationship:\\n      <span [class.ng-invalid]=\\\"relationshipForm.get('RELATIONSHIP_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n        {{relationshipForm.get('RELATIONSHIP_ID').errors?.message}}\\n      </span>\\n    </label>\\n    <input type=\\\"text\\\" class=\\\"form-control form-control-sm\\\" id=\\\"relationship\\\" [readonly]=\\\"readonly || !isNewMode\\\"\\n           name=\\\"relationship\\\" formControlName=\\\"RELATIONSHIP_ID\\\">\\n  </div>\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"relationship-desc\\\" class=\\\"col-form-label form-control-sm\\\">Relationship Description:</label>\\n    <textarea class=\\\"form-control\\\" id=\\\"relationship-desc\\\" name=\\\"relationship-desc\\\" rows=\\\"2\\\"\\n              formControlName=\\\"RELATIONSHIP_DESC\\\" [readonly]=\\\"readonly\\\" (change)=\\\"onChangeRelationshipDesc()\\\"></textarea>\\n  </div>\\n  <div class=\\\"row ml-2\\\">\\n    <div class=\\\"col-8 col-lg-3 form-check\\\">\\n      <input type=\\\"checkbox\\\" class=\\\"form-check-input\\\" id=\\\"timeDependent\\\" name=\\\"timeDependent\\\"\\n             formControlName=\\\"TIME_DEPENDENT\\\" (change)=\\\"onChangeTimeDependency()\\\">\\n      <label for=\\\"timeDependent\\\" class=\\\"form-check-label\\\">Time Dependent</label>\\n    </div>\\n    <div class=\\\"col-8 col-lg-4 form-group row mx-3\\\">\\n      <label for=\\\"valid_period\\\" class=\\\"col-form-label form-control-sm\\\">Default Period of Validity(seconds):\\n        <span [class.ng-invalid]=\\\"relationshipForm.get('VALID_PERIOD').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n        {{relationshipForm.get('VALID_PERIOD').errors?.message}}\\n      </span>\\n      </label>\\n      <input type=\\\"number\\\" class=\\\"form-control form-control-sm\\\" id=\\\"valid_period\\\" [readonly]=\\\"readonly\\\"\\n             name=\\\"valid_period\\\" formControlName=\\\"VALID_PERIOD\\\">\\n    </div>\\n    <div class=\\\"col-8 col-lg-3 form-check\\\" >\\n      <input type=\\\"checkbox\\\" class=\\\"form-check-input\\\" id=\\\"singleton\\\" name=\\\"singleton\\\"\\n             formControlName=\\\"SINGLETON\\\">\\n      <label for=\\\"singleton\\\" class=\\\"form-check-label\\\">Singleton</label>\\n    </div>\\n  </div>\\n\\n  <app-attribute-meta [readonly]=\\\"readonly\\\" [parentForm]=\\\"relationshipForm\\\" [attributes]=\\\"attributes\\\"\\n                      [relationID]=\\\"relationshipMeta.RELATIONSHIP_ID\\\" [isNewMode]=\\\"isNewMode\\\">\\n  </app-attribute-meta>\\n\\n  <div class=\\\"card mt-2\\\">\\n    <div class=\\\"card-header\\\"><span class=\\\"fas fa-user-check\\\"></span> Involved Roles</div>\\n    <div class=\\\"card-body\\\">\\n      <table class=\\\"table table-bordered table-sm\\\">\\n        <thead class=\\\"thead-light\\\">\\n        <tr>\\n          <th scope=\\\"col\\\">Action</th>\\n          <th scope=\\\"col\\\">Role</th>\\n          <th scope=\\\"col\\\">Description</th>\\n          <th scope=\\\"col\\\">Cardinality</th>\\n          <th scope=\\\"col\\\">Direction</th>\\n        </tr>\\n        </thead>\\n\\n        <tbody formArrayName=\\\"INVOLVES\\\">\\n        <tr *ngFor=\\\"let involveFormGroup of involveFormArray.controls; let i = index\\\">\\n          <td class=\\\"dk-actions\\\">\\n            <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" [disabled]=\\\"readonly\\\" (click)=\\\"deleteInvolve(i)\\\" title=\\\"Delete\\\">\\n              <span class=\\\"far fa-trash-alt\\\"></span>\\n            </button>\\n          </td>\\n          <td [formGroup]=\\\"involveFormGroup\\\">\\n            <div class=\\\"input-group\\\">\\n              <input class=\\\"form-control form-control-sm\\\" type=\\\"text\\\" formControlName=\\\"ROLE_ID\\\"\\n                     [readonly]=\\\"readonly || oldInvolve(involveFormGroup) && involveFormGroup.valid\\\" (change)=\\\"onChangeRoleID(i)\\\"\\n                     (dblclick)=\\\"onGoToRole(involveFormGroup.value['ROLE_ID'])\\\">\\n              <div class=\\\"invalid-tooltip\\\">\\n                {{involveFormGroup.get('ROLE_ID').errors?.message}}\\n              </div>\\n              <div class=\\\"input-group-append\\\">\\n                <button class=\\\"btn btn-outline-secondary btn-sm\\\" type=\\\"button\\\" id=\\\"searchRole\\\"\\n                        (click)=\\\"onSearchHelp(involveFormGroup, i)\\\">\\n                  <span class=\\\"fas fa-search\\\"></span>\\n                </button>\\n              </div>\\n            </div>\\n          </td>\\n          <td [formGroup]=\\\"involveFormGroup\\\">\\n            <input type=\\\"text\\\" formControlName=\\\"ROLE_DESC\\\" readonly class=\\\"form-control form-control-sm dk-description\\\">\\n          </td>\\n          <td [formGroup]=\\\"involveFormGroup\\\">\\n            <select class=\\\"form-control form-control-sm\\\" formControlName=\\\"CARDINALITY\\\">\\n              <option>[1..1]</option>\\n              <option>[1..n]</option>\\n            </select>\\n          </td>\\n          <td [formGroup]=\\\"involveFormGroup\\\">\\n            <input class=\\\"form-control form-control-sm\\\" type=\\\"text\\\" formControlName=\\\"DIRECTION\\\" [readonly]=\\\"readonly\\\">\\n          </td>\\n        </tr>\\n        </tbody>\\n      </table>\\n    </div>\\n  </div>\\n</form>\\n\\n<dk-app-search-help></dk-app-search-help>\\n\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ModelComponent } from './model.component';\nimport { ModelRoutingModule } from './model-routing.module';\nimport {NgbModule} from '@ng-bootstrap/ng-bootstrap';\nimport { EntityTypeComponent } from './entity-type/entity-type.component';\nimport {HttpClientModule} from '@angular/common/http';\nimport { EntityTypeDetailComponent } from './entity-type/entity-type-detail/entity-type-detail.component';\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\nimport { AttributeMetaComponent } from './attribute-meta/attribute-meta.component';\nimport {MessageModule} from 'ui-message-angular';\nimport { RelationComponent } from './relation/relation.component';\nimport {RelationDetailComponent} from './relation/relation-detail/relation-detail.component';\nimport { RelationshipComponent } from './relationship/relationship.component';\nimport { RelationshipDetailComponent } from './relationship/relationship-detail/relationship-detail.component';\nimport { RoleComponent } from './role/role.component';\nimport { RoleDetailComponent } from './role/role-detail/role-detail.component';\nimport { DataElementComponent } from './data-element/data-element.component';\nimport { DataDomainComponent } from './data-domain/data-domain.component';\nimport { DataDomainDetailComponent } from './data-domain/data-domain-detail/data-domain-detail.component';\nimport { DataElementDetailComponent } from './data-element/data-element-detail/data-element-detail.component';\nimport { SearchHelpComponent } from './search-help/search-help.component';\nimport { SearchHelpDetailComponent } from './search-help/search-help-detail/search-help-detail.component';\nimport {JorAngularModule} from 'jor-angular';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    HttpClientModule,\n    FormsModule,\n    ReactiveFormsModule,\n    ModelRoutingModule,\n    MessageModule,\n    NgbModule,\n    JorAngularModule\n  ],\n  declarations: [\n    ModelComponent,\n    EntityTypeComponent,\n    EntityTypeDetailComponent,\n    AttributeMetaComponent,\n    RelationComponent,\n    RelationDetailComponent,\n    RelationshipComponent,\n    RelationshipDetailComponent,\n    RoleComponent,\n    RoleDetailComponent,\n    DataElementComponent,\n    DataElementDetailComponent,\n    DataDomainComponent,\n    DataDomainDetailComponent,\n    SearchHelpComponent,\n    SearchHelpDetailComponent\n  ]\n})\nexport class ModelModule { }\n","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {RoleMeta} from 'jor-angular';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {EntityService} from 'jor-angular';\nimport {msgStore} from '../../../msgStore';\nimport {switchMap} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\nimport {UniqueRoleValidator} from '../../model-validators';\nimport {SearchHelp, SearchHelpMethod} from 'jor-angular';\nimport {SearchHelpComponent} from 'jor-angular';\nimport {AttributeMetaComponent} from '../../attribute-meta/attribute-meta.component';\n\n@Component({\n  selector: 'app-role-detail',\n  templateUrl: './role-detail.component.html',\n  styleUrls: ['./role-detail.component.css']\n})\nexport class RoleDetailComponent implements OnInit {\n  roleMeta: RoleMeta;\n  readonly = true;\n  isNewMode = false;\n  roleForm: FormGroup;\n  changedRole = {};\n  bypassProtection = false;\n  isSearchListShown = true;\n  relationSearchHelp: SearchHelp;\n\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent!: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueRoleValidator: UniqueRoleValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.messageService.setMessageStore(msgStore, 'EN');\n  }\n\n  get relationFormArray() {\n    return this.roleForm.get('RELATIONS') as FormArray;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const roleID = params.get('roleID');\n        if (roleID === 'new') {\n          const role = new RoleMeta();\n          role.ROLE_ID = '';\n          role.ROLE_DESC = '';\n          role.RELATIONS = [];\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return of(role);\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return this.entityService.getRole(roleID);\n        }\n      })\n    ).subscribe(data => {\n      if ( 'msgName' in data) {\n        this.messageService.clearMessages();\n        this.roleMeta = null;\n        this.roleForm = null;\n        this.messageService.report(<Message>data);\n      } else {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.roleMeta = <RoleMeta>data;\n        this._generateRoleForm();\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  onSearchHelp(control: AbstractControl, rowID: number): void {\n    if (!this.relationSearchHelp) {\n      this.relationSearchHelp = new SearchHelp();\n      this.relationSearchHelp.OBJECT_NAME = 'Relation';\n      this.relationSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listRelation(searchTerm);\n      }(this.entityService);\n      this.relationSearchHelp.BEHAVIOUR = 'A';\n      this.relationSearchHelp.MULTI = false;\n      this.relationSearchHelp.FUZZY_SEARCH = true;\n      this.relationSearchHelp.FIELDS = [\n        {FIELD_NAME: 'RELATION_ID', LIST_HEADER_TEXT: 'Relation', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'RELATION_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.relationSearchHelp.READ_ONLY = this.readonly || this.oldRelation(control) && control.valid;\n    }\n    const afterExportFn = function (context: any, ruleIdx: number) {\n      return () => context.onChangeRelationID(ruleIdx, true);\n    }(this, rowID).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.relationSearchHelp, control, afterExportFn);\n  }\n\n  _generateRoleForm(): void {\n    this.roleForm = this.fb.group({});\n    this.roleForm.addControl('ROLE_ID', new FormControl(this.roleMeta.ROLE_ID, {updateOn: 'blur'}));\n    if (this.isNewMode) {\n      this.roleForm.get('ROLE_ID').setValidators(this._validateRoleID);\n      this.roleForm.get('ROLE_ID').setAsyncValidators(this.uniqueRoleValidator.validate.bind(this.uniqueRoleValidator));\n    }\n    this.roleForm.addControl('ROLE_DESC', new FormControl(this.roleMeta.ROLE_DESC));\n\n    // Compose Involves\n    const formArray = [];\n    this.roleMeta.RELATIONS.forEach( relation => {\n      formArray.push(this.fb.group({\n        RELATION_ID: [relation.RELATION_ID],\n        RELATION_DESC: [relation.RELATION_DESC],\n        CARDINALITY: [{value: relation.CARDINALITY, disabled: this.readonly}]\n      }));\n    });\n    if (this.isNewMode) {\n      formArray.push(\n        this.fb.group({\n          RELATION_ID: [''],\n          RELATION_DESC: [''],\n          CARDINALITY: ['[0..1]']\n        }));\n    }\n    this.roleForm.addControl('RELATIONS', new FormArray(formArray));\n  }\n\n  _validateRoleID(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Role ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Role?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.roleMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.roleForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateRoleForm();\n            this.roleForm.reset(this.roleForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this.readonly = false;\n      this.relationFormArray.controls.forEach(relationFormGroup => {\n        relationFormGroup.get('CARDINALITY').enable();\n      });\n      this.relationFormArray.push(\n        this.fb.group({\n          RELATION_ID: [''],\n          RELATION_DESC: [''],\n          CARDINALITY: ['[0..1]']\n        })\n      );\n    }\n\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    let lastIndex = this.relationFormArray.length - 1;\n    while (lastIndex >= 0 && this.relationFormArray.controls[lastIndex].get('ROLE_ID').value.trim() === '') {\n      this.relationFormArray.removeAt(lastIndex);\n      lastIndex--;\n    }\n    this.relationFormArray.controls.forEach(relationFormGroup => {\n      relationFormGroup.get('CARDINALITY').disable();\n    });\n  }\n\n  onChangeRoleID(): void {\n    this.modelService.updateRoleID(this.roleForm.get('ROLE_ID').value);\n  }\n\n  onChangeRoleDesc(): void {\n    this.modelService.updateRoleDesc(this.roleForm.get('ROLE_DESC').value);\n  }\n\n  deleteRelation(index: number): void {\n    if (index !== this.relationFormArray.length - 1) {\n      this.relationFormArray.removeAt(index);\n      this.relationFormArray.markAsDirty();\n    }\n  }\n\n  onChangeRelationID(index: number, isExportedFromSH?: boolean): void {\n    const currentRelationFormGroup = this.relationFormArray.controls[index];\n    if (this.relationFormArray.controls.findIndex((relationCtrl, i) =>\n      i !== index && relationCtrl.get('RELATION_ID').value === currentRelationFormGroup.get('RELATION_ID').value\n    ) !== -1) {\n      currentRelationFormGroup.get('RELATION_ID').setErrors({message: 'Duplicate Relations'});\n      return;\n    }\n\n    if (index === this.relationFormArray.length - 1 && currentRelationFormGroup.value.RELATION_ID.trim() !== '') {\n      // Only work for the last New line\n      this.relationFormArray.push(\n        this.fb.group({\n          RELATION_ID: [''],\n          RELATION_DESC: [''],\n          CARDINALITY: ['[0..1]']\n        })\n      );\n    }\n\n    if (!isExportedFromSH) {\n      this.entityService.getRelationDesc(currentRelationFormGroup.value.RELATION_ID).subscribe(data => {\n        if (data['msgCat']) {\n          currentRelationFormGroup.get('RELATION_ID').setErrors({message: data['msgShortText']});\n        } else {\n          currentRelationFormGroup.get('RELATION_DESC').setValue(data);\n        }\n      });\n    }\n  }\n\n  oldRelation(formGroup: AbstractControl): boolean {\n    return this.roleMeta.RELATIONS ?\n      this.roleMeta.RELATIONS.findIndex(\n        relation => relation.RELATION_ID === formGroup.get('RELATION_ID').value ) !== -1 :\n      false;\n  }\n\n  onGoToRelation(relationID: string): void {\n    this.router.navigate(['/model/relation', relationID]);\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.roleForm && this.roleForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.roleForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (!this.roleForm.valid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedRole['action'] = 'add';\n      this.changedRole['ROLE_ID'] = this.roleForm.controls['ROLE_ID'].value;\n    } else {\n      this.changedRole['action'] = 'update';\n      this.changedRole['ROLE_ID'] = this.roleMeta.ROLE_ID;\n    }\n    if (this.roleForm.controls['ROLE_DESC'].dirty) {\n      this.changedRole['ROLE_DESC'] = this.roleForm.controls['ROLE_DESC'].value;\n    }\n\n    this._processChangedRelation();\n\n    this.entityService.saveRole(this.changedRole)\n      .subscribe(data => this._postActivityAfterSavingRole(data));\n  }\n\n  _processChangedRelation(): void {\n    const changedRelations = [];\n    if (!this.relationFormArray.dirty) { return; }\n\n    this.changedRole['RELATIONS'] = changedRelations;\n\n    this.relationFormArray.controls.forEach(relationControl => {\n      if (relationControl.get('RELATION_ID').value.trim() === '') { return; }\n      let action;\n      const index = this.roleMeta.RELATIONS.findIndex(\n        relation => relationControl.get('RELATION_ID').value === relation.RELATION_ID);\n      if (index === -1) {// New Add Case\n        action = 'add';\n      } else {\n        if (relationControl.dirty) {// Change Case\n          action = 'update';\n        }\n      }\n      if (action) {\n        changedRelations.push({\n          action: action, RELATION_ID: relationControl.get('RELATION_ID').value, CARDINALITY: relationControl.get('CARDINALITY').value\n        });\n      }\n    });\n\n    // Deletion Case\n    this.roleMeta.RELATIONS.forEach(relation => {\n      const index = this.relationFormArray.controls.findIndex(\n        relationControl => relationControl.get('RELATION_ID').value === relation.RELATION_ID);\n      if (index === -1) { // The attribute must be deleted\n        const deletedRelation = {action: 'delete', RELATION_ID: relation.RELATION_ID};\n        changedRelations.push(deletedRelation);\n      }\n    });\n  }\n\n  _postActivityAfterSavingRole(data: any) {\n    this.changedRole = {};\n    if (data && data['ROLE_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/role/' + data['ROLE_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'ROLE_SAVED', 'S', data['ROLE_ID'])}});\n      } else {\n        this.readonly = true;\n        this.roleMeta = data;\n        this._generateRoleForm();\n        this.messageService.reportMessage('MODEL', 'ROLE_SAVED', 'S', this.roleMeta.ROLE_ID);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport {RouterModule, Routes} from '@angular/router';\nimport {ModelComponent} from './model.component';\nimport {EntityTypeComponent} from './entity-type/entity-type.component';\nimport {EntityTypeDetailComponent} from './entity-type/entity-type-detail/entity-type-detail.component';\nimport {RelationComponent} from './relation/relation.component';\nimport {RelationDetailComponent} from './relation/relation-detail/relation-detail.component';\nimport {WorkProtectionGuard} from '../work-protection.guard';\nimport {RelationshipComponent} from './relationship/relationship.component';\nimport {RelationshipDetailComponent} from './relationship/relationship-detail/relationship-detail.component';\nimport {RoleComponent} from './role/role.component';\nimport {RoleDetailComponent} from './role/role-detail/role-detail.component';\nimport {DataElementComponent} from './data-element/data-element.component';\nimport {DataDomainComponent} from './data-domain/data-domain.component';\nimport {DataDomainDetailComponent} from './data-domain/data-domain-detail/data-domain-detail.component';\nimport {DataElementDetailComponent} from './data-element/data-element-detail/data-element-detail.component';\nimport {SearchHelpComponent} from './search-help/search-help.component';\nimport {SearchHelpDetailComponent} from './search-help/search-help-detail/search-help-detail.component';\n\nconst routes: Routes = [\n  { path: '',\n    component: ModelComponent,\n    children: [\n      { path: 'entity-type', component: EntityTypeComponent,\n        children: [{ path: ':entityID', canDeactivate: [WorkProtectionGuard], component: EntityTypeDetailComponent }] },\n      { path: 'role', component: RoleComponent,\n        children: [{ path: ':roleID', canDeactivate: [WorkProtectionGuard], component: RoleDetailComponent }] },\n      { path: 'relation', component: RelationComponent,\n        children: [{ path: ':relationID', canDeactivate: [WorkProtectionGuard], component: RelationDetailComponent }] },\n      { path: 'relationship', component: RelationshipComponent,\n        children: [{ path: ':relationshipID', canDeactivate: [WorkProtectionGuard], component: RelationshipDetailComponent }] },\n      { path: 'data-element', component: DataElementComponent,\n        children: [{ path: ':elementID', canDeactivate: [WorkProtectionGuard], component: DataElementDetailComponent }] },\n      { path: 'data-domain', component: DataDomainComponent,\n        children: [{ path: ':domainID', canDeactivate: [WorkProtectionGuard], component: DataDomainDetailComponent }] },\n      { path: 'search-help', component: SearchHelpComponent,\n        children: [{ path: ':searchHelpID', canDeactivate: [WorkProtectionGuard], component: SearchHelpDetailComponent }] },\n      { path: '**', redirectTo: '/model/entity-type', pathMatch: 'full' },\n    ]\n  }\n];\n\n@NgModule({\n  imports: [\n    RouterModule.forChild(routes)\n  ],\n  exports: [ RouterModule ]\n})\nexport class ModelRoutingModule { }\n","export default \"<div class=\\\"row\\\">\\n  <div *ngIf=\\\"isSearchListShown\\\" class=\\\"col-3\\\">\\n    <div class=\\\"btn-toolbar justify-content-between mb-2\\\" role=\\\"toolbar\\\">\\n      <div class=\\\"input-group\\\">\\n        <input type=\\\"text\\\" class=\\\"form-control\\\" placeholder=\\\"Search\\\" #searchBox (keyup)=\\\"searchEntityType(searchBox.value)\\\" >\\n      </div>\\n      <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Hide\\\" (click)=\\\"hideSearchList()\\\" [disabled]=\\\"!theSelectedEntityType\\\">\\n          <span class=\\\"fas fa-arrow-left\\\"></span>\\n        </button>\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Add\\\" (click)=\\\"newEntityType()\\\">\\n          <span class=\\\"fas fa-plus\\\"></span>\\n        </button>\\n      </div>\\n    </div>\\n    <div class=\\\"list-group\\\">\\n      <a *ngFor=\\\"let entityType of entityTypeList\\\" routerLink=\\\"/model/entity-type/{{entityType.ENTITY_ID}}\\\" routerLinkActive=\\\"active\\\"\\n         (click)=\\\"onSelect(entityType)\\\" class=\\\"list-group-item list-group-item-action flex-column align-items-start\\\">\\n        <div class=\\\"d-flex w-100 justify-content-between\\\">\\n          <h5 class=\\\"mb-1\\\">{{entityType.ENTITY_ID}}</h5>\\n          <small>version: {{entityType.VERSION_NO}}</small>\\n        </div>\\n        <p class=\\\"mb-1\\\">{{entityType.ENTITY_DESC}}</p>\\n        <!--<small>created by: {{entityType.CREATE_BY}} @{{entityType.CREATE_TIME}}</small> <br/>-->\\n        <small>last changed by: {{entityType.LAST_CHANGE_BY}} @{{entityType.LAST_CHANGE_TIME}}</small>\\n      </a>\\n    </div>\\n  </div>\\n  <div [ngClass]=\\\"{'col-9': isSearchListShown, 'col-12': !isSearchListShown}\\\">\\n    <router-outlet></router-outlet>\\n  </div>\\n</div>\\n\";","export default \"<ul class=\\\"nav nav-tabs mt-1\\\">\\n  <li class=\\\"nav-item active\\\">\\n    <a class=\\\"nav-link\\\" routerLink=\\\"/model/entity-type\\\" routerLinkActive=\\\"active\\\">Entity</a>\\n  </li>\\n  <li class=\\\"nav-item\\\">\\n    <a class=\\\"nav-link\\\" routerLink=\\\"/model/role\\\" routerLinkActive=\\\"active\\\">Role</a>\\n  </li>\\n  <li class=\\\"nav-item\\\">\\n    <a class=\\\"nav-link\\\" routerLink=\\\"/model/relation\\\" routerLinkActive=\\\"active\\\">Relation</a>\\n  </li>\\n  <li class=\\\"nav-item\\\">\\n    <a class=\\\"nav-link\\\" routerLink=\\\"/model/relationship\\\" routerLinkActive=\\\"active\\\">Relationship</a>\\n  </li>\\n  <li class=\\\"nav-item\\\">\\n    <a class=\\\"nav-link\\\" routerLink=\\\"/model/data-element\\\" routerLinkActive=\\\"active\\\">Data Element</a>\\n  </li>\\n  <li class=\\\"nav-item\\\">\\n    <a class=\\\"nav-link\\\" routerLink=\\\"/model/data-domain\\\" routerLinkActive=\\\"active\\\">Data Domain</a>\\n  </li>\\n  <li class=\\\"nav-item\\\">\\n    <a class=\\\"nav-link\\\" routerLink=\\\"/model/search-help\\\" routerLinkActive=\\\"active\\\">Search Help</a>\\n  </li>\\n</ul>\\n\\n<div class=\\\"dk-model-content\\\">\\n  <router-outlet></router-outlet>\\n</div>\\n\\n\";","export default \"<div class=\\\"row\\\">\\n  <div *ngIf=\\\"isSearchListShown\\\" class=\\\"col-3\\\">\\n    <div class=\\\"btn-toolbar justify-content-between mb-2\\\" role=\\\"toolbar\\\">\\n      <div class=\\\"input-group\\\">\\n        <input type=\\\"text\\\" class=\\\"form-control\\\" placeholder=\\\"Search\\\" #searchBox (keyup)=\\\"searchRole(searchBox.value)\\\" >\\n      </div>\\n      <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Hide\\\" (click)=\\\"hideSearchList()\\\" [disabled]=\\\"!theSelectedRole\\\">\\n          <span class=\\\"fas fa-arrow-left\\\"></span>\\n        </button>\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Add\\\" (click)=\\\"newRole()\\\">\\n          <span class=\\\"fas fa-plus\\\"></span>\\n        </button>\\n      </div>\\n    </div>\\n    <div class=\\\"list-group\\\">\\n      <a *ngFor=\\\"let role of roleList\\\" routerLink=\\\"/model/role/{{role.ROLE_ID}}\\\" routerLinkActive=\\\"active\\\"\\n         (click)=\\\"onSelect(role)\\\" class=\\\"list-group-item list-group-item-action flex-column align-items-start\\\">\\n        <div class=\\\"d-flex w-100 justify-content-between\\\">\\n          <h5 class=\\\"mb-1\\\">{{role.ROLE_ID}}</h5>\\n          <small>version: {{role.VERSION_NO}}</small>\\n        </div>\\n        <p class=\\\"mb-1\\\">{{role.ROLE_DESC}}</p>\\n        <!--<small>created by: {{entityType.CREATE_BY}} @{{entityType.CREATE_TIME}}</small> <br/>-->\\n        <small>last changed by: {{role.LAST_CHANGE_BY}} @{{role.LAST_CHANGE_TIME}}</small>\\n      </a>\\n    </div>\\n  </div>\\n  <div [ngClass]=\\\"{'col-9': isSearchListShown, 'col-12': !isSearchListShown}\\\">\\n    <router-outlet></router-outlet>\\n  </div>\\n</div>\\n\";","export default \"<div class=\\\"row\\\">\\n  <div *ngIf=\\\"isSearchListShown\\\" class=\\\"col-3\\\">\\n    <div class=\\\"btn-toolbar justify-content-between mb-2\\\" role=\\\"toolbar\\\">\\n      <div class=\\\"input-group\\\">\\n        <input type=\\\"text\\\" class=\\\"form-control\\\" placeholder=\\\"Search\\\" #searchBox (keyup)=\\\"searchRelation(searchBox.value)\\\" >\\n      </div>\\n\\n      <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Hide\\\" (click)=\\\"hideSearchList()\\\" [disabled]=\\\"!theSelectedRelation\\\">\\n          <span class=\\\"fas fa-arrow-left\\\"></span>\\n        </button>\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Add\\\" (click)=\\\"newRelation()\\\">\\n          <span class=\\\"fas fa-plus\\\"></span>\\n        </button>\\n      </div>\\n    </div>\\n    <div class=\\\"list-group\\\">\\n      <a *ngFor=\\\"let relation of relationList\\\" routerLink=\\\"/model/relation/{{relation.RELATION_ID}}\\\" routerLinkActive=\\\"active\\\"\\n         (click)=\\\"onSelect(relation)\\\" class=\\\"list-group-item list-group-item-action flex-column align-items-start\\\">\\n        <div class=\\\"d-flex w-100 justify-content-between\\\">\\n          <h5 class=\\\"mb-1\\\">{{relation.RELATION_ID}}</h5>\\n          <small>version: {{relation.VERSION_NO}}</small>\\n        </div>\\n        <p class=\\\"mb-1\\\">{{relation.RELATION_DESC}}</p>\\n        <!--<small>created by: {{entityType.CREATE_BY}} @{{entityType.CREATE_TIME}}</small> <br/>-->\\n        <small>last changed by: {{relation.LAST_CHANGE_BY}} @{{relation.LAST_CHANGE_TIME}}</small>\\n      </a>\\n    </div>\\n  </div>\\n  <div [ngClass]=\\\"{'col-9': isSearchListShown, 'col-12': !isSearchListShown}\\\">\\n    <router-outlet></router-outlet>\\n  </div>\\n</div>\\n\";","export default \"<div class=\\\"btn-toolbar mb-2\\\"  role=\\\"toolbar\\\"\\n     [ngClass]=\\\"{'justify-content-end': isSearchListShown, 'justify-content-between': !isSearchListShown}\\\" >\\n  <button *ngIf=\\\"!isSearchListShown\\\" class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Show List\\\" (click)=\\\"showSearchList()\\\">\\n    <span class=\\\"fas fa-arrow-right\\\"></span>\\n  </button>\\n\\n  <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Edit/Display\\\" (click)=\\\"switchEditDisplay()\\\">\\n      <span *ngIf=\\\"readonly\\\" class=\\\"fas fa-edit\\\"></span>\\n      <span *ngIf=\\\"!readonly\\\" class=\\\"fas fa-glasses\\\"></span>\\n    </button>\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Save\\\" (click)=\\\"save()\\\">\\n      <span class=\\\"fas fa-save\\\"></span>\\n    </button>\\n  </div>\\n</div>\\n\\n<dk-message></dk-message>\\n<form *ngIf=\\\"entityMeta\\\" [formGroup]=\\\"entityTypeForm\\\">\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"entity-type\\\" class=\\\"col-form-label form-control-sm\\\">Entity Type:\\n      <span [class.ng-invalid]=\\\"entityTypeForm.get('ENTITY_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n        {{entityTypeForm.get('ENTITY_ID').errors?.message}}\\n      </span>\\n    </label>\\n    <input type=\\\"text\\\" class=\\\"form-control form-control-sm\\\" id=\\\"entity-type\\\" [readonly]=\\\"readonly || !isNewMode\\\"\\n           name=\\\"entity-type\\\" formControlName=\\\"ENTITY_ID\\\">\\n  </div>\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"entity-desc\\\" class=\\\"col-form-label form-control-sm\\\">Entity Description:</label>\\n    <textarea class=\\\"form-control\\\" id=\\\"entity-desc\\\" name=\\\"entity-desc\\\" rows=\\\"2\\\"\\n              formControlName=\\\"ENTITY_DESC\\\" [readonly]=\\\"readonly\\\" (change)=\\\"onChangeEntityDesc()\\\"></textarea>\\n  </div>\\n\\n  <app-attribute-meta [readonly]=\\\"readonly\\\" [parentForm]=\\\"entityTypeForm\\\" [attributes]=\\\"attributes\\\"\\n                      [relationID]=\\\"entityMeta.ENTITY_ID\\\" [isNewMode]=\\\"isNewMode\\\">\\n  </app-attribute-meta>\\n\\n  <div class=\\\"card mt-2\\\">\\n    <div class=\\\"card-header\\\"><span class=\\\"fas fa-user-check\\\"></span> Role</div>\\n    <div class=\\\"card-body\\\">\\n      <table class=\\\"table table-bordered table-sm dk-table\\\">\\n        <thead class=\\\"thead-light\\\">\\n          <tr>\\n            <th scope=\\\"col\\\">Action</th>\\n            <th scope=\\\"col\\\">Role</th>\\n            <th scope=\\\"col\\\">Description</th>\\n            <th scope=\\\"col\\\">Conditional Attribute</th>\\n            <th scope=\\\"col\\\">Conditional Value</th>\\n          </tr>\\n        </thead>\\n\\n        <tbody formArrayName=\\\"ROLES\\\">\\n        <tr *ngFor=\\\"let roleFormGroup of roleFormArray.controls; let i = index\\\">\\n          <td class=\\\"dk-actions\\\">\\n            <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" [disabled]=\\\"readonly\\\" (click)=\\\"deleteRole(i)\\\" title=\\\"Delete\\\">\\n              <span class=\\\"far fa-trash-alt\\\"></span>\\n            </button>\\n          </td>\\n          <td [formGroup]=\\\"roleFormGroup\\\">\\n            <div class=\\\"input-group\\\">\\n              <input class=\\\"form-control form-control-sm\\\" type=\\\"text\\\" formControlName=\\\"ROLE_ID\\\"\\n                     [readonly]=\\\"readonly || oldRole(roleFormGroup) && roleFormGroup.valid\\\" (change)=\\\"onChangeRoleID(i)\\\"\\n                     (dblclick)=\\\"onGoToRole(roleFormGroup.value['ROLE_ID'])\\\">\\n              <div class=\\\"invalid-tooltip\\\">\\n                {{roleFormGroup.get('ROLE_ID').errors?.message}}\\n              </div>\\n              <div class=\\\"input-group-append\\\">\\n                <button class=\\\"btn btn-outline-secondary btn-sm\\\" type=\\\"button\\\" id=\\\"searchRole\\\"\\n                        (click)=\\\"onSearchHelp(roleFormGroup, i)\\\">\\n                  <span class=\\\"fas fa-search\\\"></span>\\n                </button>\\n              </div>\\n            </div>\\n          </td>\\n          <td [formGroup]=\\\"roleFormGroup\\\">\\n            <input type=\\\"text\\\" formControlName=\\\"ROLE_DESC\\\" readonly class=\\\"form-control form-control-sm dk-description\\\">\\n          </td>\\n          <td [formGroup]=\\\"roleFormGroup\\\">\\n            <select formControlName=\\\"CONDITIONAL_ATTR\\\"  class=\\\"form-control form-control-sm\\\">\\n              <option *ngFor=\\\"let opt of attrFormArray.controls\\\" [value]=\\\"opt.value.ATTR_NAME\\\">{{opt.value.ATTR_NAME}}</option>\\n            </select>\\n          </td>\\n          <td [formGroup]=\\\"roleFormGroup\\\">\\n            <input type=\\\"text\\\" formControlName=\\\"CONDITIONAL_VALUE\\\" [readonly]=\\\"readonly\\\" class=\\\"form-control form-control-sm\\\">\\n          </td>\\n        </tr>\\n        </tbody>\\n      </table>\\n    </div>\\n  </div>\\n</form>\\n\\n<dk-app-search-help></dk-app-search-help>\\n\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL3JlbGF0aW9uc2hpcC9yZWxhdGlvbnNoaXAuY29tcG9uZW50LmNzcyJ9 */\";","export default \".dk-table {\\n  display: block;\\n  overflow-x: auto;\\n  white-space: nowrap;\\n  border: none;\\n}\\n.dk-actions{\\n  width: 4rem;\\n  min-width: 4rem;\\n  max-width: 4rem;\\n}\\n.dk-selection{\\n  width: 15rem;\\n  min-width: 10rem;\\n}\\n.dk-string{\\n  width: 15rem;\\n  min-width: 10rem;\\n}\\n.dk-number{\\n  width: 10rem;\\n  min-width: 5rem;\\n}\\n.dk-description{\\n  width: 15rem;\\n  min-width: 10rem;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbW9kZWwvc2VhcmNoLWhlbHAvc2VhcmNoLWhlbHAtZGV0YWlsL3NlYXJjaC1oZWxwLWRldGFpbC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsY0FBYztFQUNkLGdCQUFnQjtFQUNoQixtQkFBbUI7RUFDbkIsWUFBWTtBQUNkO0FBQ0E7RUFDRSxXQUFXO0VBQ1gsZUFBZTtFQUNmLGVBQWU7QUFDakI7QUFDQTtFQUNFLFlBQVk7RUFDWixnQkFBZ0I7QUFDbEI7QUFDQTtFQUNFLFlBQVk7RUFDWixnQkFBZ0I7QUFDbEI7QUFDQTtFQUNFLFlBQVk7RUFDWixlQUFlO0FBQ2pCO0FBQ0E7RUFDRSxZQUFZO0VBQ1osZ0JBQWdCO0FBQ2xCIiwiZmlsZSI6InNyYy9hcHAvbW9kZWwvc2VhcmNoLWhlbHAvc2VhcmNoLWhlbHAtZGV0YWlsL3NlYXJjaC1oZWxwLWRldGFpbC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmRrLXRhYmxlIHtcbiAgZGlzcGxheTogYmxvY2s7XG4gIG92ZXJmbG93LXg6IGF1dG87XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gIGJvcmRlcjogbm9uZTtcbn1cbi5kay1hY3Rpb25ze1xuICB3aWR0aDogNHJlbTtcbiAgbWluLXdpZHRoOiA0cmVtO1xuICBtYXgtd2lkdGg6IDRyZW07XG59XG4uZGstc2VsZWN0aW9ue1xuICB3aWR0aDogMTVyZW07XG4gIG1pbi13aWR0aDogMTByZW07XG59XG4uZGstc3RyaW5ne1xuICB3aWR0aDogMTVyZW07XG4gIG1pbi13aWR0aDogMTByZW07XG59XG4uZGstbnVtYmVye1xuICB3aWR0aDogMTByZW07XG4gIG1pbi13aWR0aDogNXJlbTtcbn1cbi5kay1kZXNjcmlwdGlvbntcbiAgd2lkdGg6IDE1cmVtO1xuICBtaW4td2lkdGg6IDEwcmVtO1xufVxuIl19 */\";","export default \"<div class=\\\"row\\\">\\n  <div *ngIf=\\\"isSearchListShown\\\" class=\\\"col-3\\\">\\n    <div class=\\\"btn-toolbar justify-content-between mb-2\\\" role=\\\"toolbar\\\">\\n      <div class=\\\"input-group\\\">\\n        <input type=\\\"text\\\" class=\\\"form-control\\\" placeholder=\\\"Search\\\" #searchBox (keyup)=\\\"searchDataDomain(searchBox.value)\\\" >\\n      </div>\\n\\n      <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Hide\\\" (click)=\\\"hideSearchList()\\\" [disabled]=\\\"!theSelectedDataDomain\\\">\\n          <span class=\\\"fas fa-arrow-left\\\"></span>\\n        </button>\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Add\\\" (click)=\\\"newDataDomian()\\\">\\n          <span class=\\\"fas fa-plus\\\"></span>\\n        </button>\\n      </div>\\n    </div>\\n    <div class=\\\"list-group\\\">\\n      <a *ngFor=\\\"let dataDomain of dataDomainList\\\" routerLink=\\\"/model/data-domain/{{dataDomain.DOMAIN_ID}}\\\" routerLinkActive=\\\"active\\\"\\n         (click)=\\\"onSelect(dataDomain)\\\" class=\\\"list-group-item list-group-item-action flex-column align-items-start\\\">\\n        <div class=\\\"d-flex w-100 justify-content-between\\\">\\n          <h5 class=\\\"mb-1\\\">{{dataDomain.DOMAIN_ID}}</h5>\\n          <small>version: {{dataDomain.VERSION_NO}}</small>\\n        </div>\\n        <p class=\\\"mb-1\\\">{{dataDomain.DOMAIN_DESC}}</p>\\n        <!--<small>created by: {{entityType.CREATE_BY}} @{{entityType.CREATE_TIME}}</small> <br/>-->\\n        <small>last changed by: {{dataDomain.LAST_CHANGE_BY}} @{{dataDomain.LAST_CHANGE_TIME}}</small>\\n      </a>\\n    </div>\\n  </div>\\n  <div [ngClass]=\\\"{'col-9': isSearchListShown, 'col-12': !isSearchListShown}\\\">\\n    <router-outlet></router-outlet>\\n  </div>\\n</div>\\n\";","export default \"<div class=\\\"card mt-2\\\">\\n  <div class=\\\"card-header\\\"><span class=\\\"fab fa-elementor\\\"></span> Attribute</div>\\n  <div class=\\\"card-body\\\">\\n    <table class=\\\"table table-bordered table-sm dk-table\\\" [formGroup]=\\\"parentForm\\\">\\n      <thead class=\\\"thead-light\\\">\\n        <tr>\\n          <th scope=\\\"col\\\">Action</th>\\n          <th scope=\\\"col\\\">Attribute Name</th>\\n          <th scope=\\\"col\\\">Description</th>\\n          <th scope=\\\"col\\\">Data Element</th>\\n          <th scope=\\\"col\\\">Data Type</th>\\n          <th scope=\\\"col\\\">Length</th>\\n          <th scope=\\\"col\\\">Decimal</th>\\n          <th scope=\\\"col\\\" title=\\\"Primary Key\\\" [hidden]=\\\"relationID.substring(0,2) !== 'r_'\\\">PK</th>\\n          <th scope=\\\"col\\\" title=\\\"Auto Incremental\\\" [hidden]=\\\"relationID.substring(0,2) !== 'r_'\\\">AI</th>\\n        </tr>\\n      </thead>\\n\\n      <tbody formArrayName=\\\"ATTRIBUTES\\\">\\n        <tr *ngFor=\\\"let attrFormGroup of formArray.controls; let i = index\\\">\\n          <td class=\\\"dk-actions\\\">\\n            <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" id=\\\"delete\\\" [disabled]=\\\"readonly || isFieldGray(attrFormGroup.value)\\\"\\n                    (click)=\\\"deleteAttribute(i)\\\" title=\\\"Delete\\\">\\n              <span class=\\\"far fa-trash-alt\\\"></span>\\n            </button>\\n            <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" id=\\\"add\\\" [disabled]=\\\"readonly || isFieldGray(attrFormGroup.value)\\\"\\n                    (click)=\\\"insertAttribute(i)\\\" title=\\\"Insert\\\">\\n              <span class=\\\"fas fa-plus\\\"></span>\\n            </button>\\n            <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" id=\\\"switch\\\" [disabled]=\\\"readonly || isFieldGray(attrFormGroup.value)\\\"\\n                    (click)=\\\"switchBtwDEAndDT(i)\\\" title=\\\"Switch btw Data Element and Data Type\\\">\\n              <span class=\\\"far fa-lightbulb\\\"></span>\\n            </button>\\n          </td>\\n          <td [formGroup]=\\\"attrFormGroup\\\">\\n            <input type=\\\"text\\\" formControlName=\\\"ATTR_NAME\\\" [readonly]=\\\"readonly || isFieldGray(attrFormGroup.value)\\\"\\n                   class=\\\"form-control form-control-sm\\\" (change)=\\\"onChangeAttributeName(i)\\\">\\n          </td>\\n          <td [formGroup]=\\\"attrFormGroup\\\">\\n            <input type=\\\"text\\\" formControlName=\\\"ATTR_DESC\\\" class=\\\"form-control form-control-sm dk-description\\\"\\n                   [readonly]=\\\"readonly || isFieldGray(attrFormGroup.value)\\\">\\n          </td>\\n          <td [formGroup]=\\\"attrFormGroup\\\">\\n            <div class=\\\"input-group dk-dataElement\\\">\\n              <input type=\\\"text\\\" formControlName=\\\"DATA_ELEMENT\\\" [readonly]=\\\"readonly || isFieldGray(attrFormGroup.value)\\\"\\n                     class=\\\"form-control form-control-sm\\\" (change)=\\\"onChangeDataElement(i)\\\"\\n                     (dblclick)=\\\"onGoToDataElement(attrFormGroup.value['DATA_ELEMENT'])\\\">\\n              <div class=\\\"invalid-tooltip\\\">\\n                {{attrFormGroup.get('DATA_ELEMENT').errors?.message}}\\n              </div>\\n              <div class=\\\"input-group-append\\\">\\n                <button class=\\\"btn btn-outline-secondary btn-sm\\\" type=\\\"button\\\" id=\\\"searchDataElement\\\"\\n                        (click)=\\\"onSearchHelp(attrFormGroup, i)\\\">\\n                  <span class=\\\"fas fa-search\\\"></span>\\n                </button>\\n              </div>\\n            </div>\\n          </td>\\n          <td [formGroup]=\\\"attrFormGroup\\\">\\n            <select formControlName=\\\"DATA_TYPE\\\" (change)=\\\"onChangeDataType(attrFormGroup)\\\" class=\\\"form-control form-control-sm\\\">\\n              <option *ngFor=\\\"let opt of dataTypes\\\" [value]=\\\"opt.key\\\">{{opt.value}}</option>\\n            </select>\\n          </td>\\n          <td [formGroup]=\\\"attrFormGroup\\\">\\n            <input type=\\\"number\\\" formControlName=\\\"DATA_LENGTH\\\" class=\\\"form-control form-control-sm dk-number\\\"\\n                   [readonly]=\\\"(+attrFormGroup.value.DATA_TYPE !== 1 && +attrFormGroup.value.DATA_TYPE !== 4) || readonly || isFieldGray(attrFormGroup.value)\\\">\\n          </td>\\n          <td [formGroup]=\\\"attrFormGroup\\\">\\n            <input type=\\\"number\\\" formControlName=\\\"DECIMAL\\\" class=\\\"form-control form-control-sm dk-number\\\"\\n                   [readonly]=\\\"+attrFormGroup.value.DATA_TYPE !== 4 || readonly || isFieldGray(attrFormGroup.value)\\\">\\n          </td>\\n          <td [formGroup]=\\\"attrFormGroup\\\" [hidden]=\\\"relationID.substring(0,2) !== 'r_'\\\">\\n            <input type=\\\"checkbox\\\" formControlName=\\\"PRIMARY_KEY\\\">\\n          </td>\\n          <td [formGroup]=\\\"attrFormGroup\\\" [hidden]=\\\"relationID.substring(0,2) !== 'r_'\\\">\\n            <input type=\\\"checkbox\\\" formControlName=\\\"AUTO_INCREMENT\\\">\\n          </td>\\n        </tr>\\n      </tbody>\\n    </table>\\n  </div>\\n</div>\\n<dk-app-search-help></dk-app-search-help>\\n\";","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {SearchHelpMeta, EntityService, SearchHelp, SearchHelpComponent, SearchHelpMethod, Attribute, RelationMeta} from 'jor-angular';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {UniqueSearchHelpValidator} from '../../model-validators';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {switchMap} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\n\n@Component({\n  selector: 'app-search-help-detail',\n  templateUrl: './search-help-detail.component.html',\n  styleUrls: ['./search-help-detail.component.css']\n})\nexport class SearchHelpDetailComponent implements OnInit {\n\n  searchHelpMeta: SearchHelpMeta;\n  readonly = true;\n  isNewMode = false;\n  searchHelpForm: FormGroup;\n  changedSearchHelp = {};\n  relationsOfEntity = [];\n  bypassProtection = false;\n  isSearchListShown = true;\n  behaviours = [\n    {key: 'A', value: 'Search automatically when popup'},\n    {key: 'M', value: 'Search manually'}\n  ];\n  relationAttributesMap = {};\n  entitySearchHelp: SearchHelp;\n\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent !: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueSearchHelpValidator: UniqueSearchHelpValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n  }\n\n  get searchHelpFieldsFormArray() {\n    return this.searchHelpForm.get('FIELDS') as FormArray;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const searchHelpID = params.get('searchHelpID');\n        if (searchHelpID === 'new') {\n          const searchHelp = new SearchHelpMeta();\n          searchHelp.SEARCH_HELP_ID = '';\n          searchHelp.SEARCH_HELP_DESC = '';\n          searchHelp.BEHAVIOUR = 'A'; // A: Auto-Trigger Search, M: Manual-Trigger Search\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return of(searchHelp);\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return this.entityService.getSearchHelp(searchHelpID);\n        }\n      })\n    ).subscribe(data => {\n      if ( 'msgName' in data) {\n        this.messageService.clearMessages();\n        this.searchHelpMeta = null;\n        this.searchHelpForm = null;\n        this.messageService.report(<Message>data);\n      } else {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.searchHelpMeta = <SearchHelpMeta>data;\n        this._generateSearchHelpForm();\n        this._getRelationsOfEntity( this.searchHelpForm, false);\n        this.searchHelpFieldsFormArray.controls.forEach( field =>\n          this._getAttributesOfRelation(field, false ));\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  _generateSearchHelpForm(): void {\n    if (this.searchHelpForm) {\n      this.searchHelpForm.markAsPristine({onlySelf: false});\n      this.searchHelpForm.get('SEARCH_HELP_ID').setValue(this.searchHelpMeta.SEARCH_HELP_ID);\n      this.searchHelpForm.get('SEARCH_HELP_DESC').setValue(this.searchHelpMeta.SEARCH_HELP_DESC);\n      this.searchHelpForm.get('ENTITY_ID').setValue(this.searchHelpMeta.ENTITY_ID);\n      this.searchHelpForm.get('RELATION_ID').setValue(this.searchHelpMeta.RELATION_ID);\n      this.searchHelpForm.get('BEHAVIOUR').setValue(this.searchHelpMeta.BEHAVIOUR);\n      this.searchHelpForm.get('MULTI').setValue(this.searchHelpMeta.MULTI);\n      this.searchHelpForm.get('FUZZY_SEARCH').setValue(this.searchHelpMeta.FUZZY_SEARCH);\n      this.searchHelpFieldsFormArray.clear();\n      if (this.readonly) {\n        this.searchHelpForm.get('BEHAVIOUR').disable();\n        this.searchHelpForm.get('MULTI').disable();\n        this.searchHelpForm.get('FUZZY_SEARCH').disable();\n        this.searchHelpForm.get('RELATION_ID').disable();\n      }\n    } else {\n      this.searchHelpForm = this.fb.group({\n        SEARCH_HELP_ID: [this.searchHelpMeta.SEARCH_HELP_ID, {updateOn: 'blur'}],\n        SEARCH_HELP_DESC: [this.searchHelpMeta.SEARCH_HELP_DESC],\n        ENTITY_ID: [this.searchHelpMeta.ENTITY_ID],\n        RELATION_ID: [{value: this.searchHelpMeta.RELATION_ID, disabled: this.readonly}],\n        BEHAVIOUR: [{value: this.searchHelpMeta.BEHAVIOUR, disabled: this.readonly}],\n        MULTI: [{value: this.searchHelpMeta.MULTI, disabled: this.readonly}],\n        FUZZY_SEARCH: [{value: this.searchHelpMeta.FUZZY_SEARCH, disabled: this.readonly}],\n        FIELDS: this.fb.array([])\n      });\n    }\n    this._setNewModeState();\n\n    if (this.searchHelpMeta.FIELDS) {\n      this.searchHelpMeta.FIELDS.forEach( field => {\n        this.searchHelpFieldsFormArray.push(\n          this.fb.group({\n            RELATION_ID: [{value: field.RELATION_ID, disabled: this.readonly}],\n            FIELD_NAME: [{value: field.FIELD_NAME, disabled: this.readonly}],\n            FIELD_DESC: [field.FIELD_DESC],\n            IMPORT: [{value: field.IMPORT, disabled: this.readonly}],\n            EXPORT: [{value: field.EXPORT, disabled: this.readonly}],\n            IE_FIELD_NAME: [field.IE_FIELD_NAME],\n            LIST_POSITION: [field.LIST_POSITION],\n            FILTER_POSITION: [field.FILTER_POSITION],\n            FILTER_DISP_ONLY: [{value: field.FILTER_DISP_ONLY, disabled: this.readonly}],\n            DEFAULT_VALUE: [field.DEFAULT_VALUE]\n          })\n        );\n      });\n    }\n  }\n\n  _setNewModeState() {\n    if (this.isNewMode) {\n      this.searchHelpForm.get('SEARCH_HELP_ID').setValidators(this._validateSearchHelpID);\n      this.searchHelpForm.get('SEARCH_HELP_ID').setAsyncValidators(\n        this.uniqueSearchHelpValidator.validate.bind(this.uniqueSearchHelpValidator));\n      this.searchHelpForm.get('BEHAVIOUR').enable();\n      this.searchHelpForm.get('MULTI').enable();\n      this.searchHelpForm.get('FUZZY_SEARCH').enable();\n      this.searchHelpForm.get('RELATION_ID').enable();\n      this.searchHelpForm.get('BEHAVIOUR').markAsDirty(); // Default value mark as dirty\n    } else {\n      this.searchHelpForm.get('SEARCH_HELP_ID').clearValidators();\n      this.searchHelpForm.get('SEARCH_HELP_ID').clearAsyncValidators();\n      this.searchHelpForm.get('SEARCH_HELP_ID').updateValueAndValidity();\n    }\n  }\n\n  _validateSearchHelpID(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Search Help ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().length > 32) {\n      return {message: 'Search Help ID must have length less than 32!'};\n    }\n    return null;\n  }\n\n  _validateEntityID(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give an entity'};\n    }\n    return null;\n  }\n  _validateRelationID(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a relation'};\n    }\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Search Help?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.searchHelpMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.searchHelpForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateSearchHelpForm();\n            this.searchHelpForm.reset(this.searchHelpForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this._switch2EditMode();\n    }\n\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    this.searchHelpForm.get('BEHAVIOUR').disable();\n    this.searchHelpForm.get('MULTI').disable();\n    this.searchHelpForm.get('FUZZY_SEARCH').disable();\n    this.searchHelpForm.get('RELATION_ID').disable();\n    this.searchHelpFieldsFormArray.controls.forEach(field => {\n      field.get('RELATION_ID').disable();\n      field.get('FIELD_NAME').disable();\n      field.get('IMPORT').disable();\n      field.get('EXPORT').disable();\n      field.get('FILTER_DISP_ONLY').disable();\n    });\n  }\n\n  _switch2EditMode(): void {\n    this.readonly = false;\n    this.searchHelpForm.get('BEHAVIOUR').enable();\n    this.searchHelpForm.get('MULTI').enable();\n    this.searchHelpForm.get('FUZZY_SEARCH').enable();\n    this.searchHelpForm.get('RELATION_ID').enable();\n    this.searchHelpFieldsFormArray.controls.forEach(field => {\n      field.get('RELATION_ID').enable();\n      field.get('FIELD_NAME').enable();\n      field.get('IMPORT').enable();\n      field.get('EXPORT').enable();\n      field.get('FILTER_DISP_ONLY').enable();\n    });\n  }\n\n  onChangeSearchHelpID(): void {\n    this.modelService.updateSearchHelpID(this.searchHelpForm.get('SEARCH_HELP_ID').value);\n  }\n\n  onChangeSearchHelpDesc(): void {\n    this.modelService.updateSearchHelpDesc(this.searchHelpForm.get('SEARCH_HELP_DESC').value);\n  }\n\n  onEntitySearchHelp(control: AbstractControl): void {\n    if (!this.entitySearchHelp) {\n      this.entitySearchHelp = new SearchHelp();\n      this.entitySearchHelp.OBJECT_NAME = 'Entity ID';\n      this.entitySearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listEntityType(searchTerm);\n      }(this.entityService);\n      this.entitySearchHelp.BEHAVIOUR = 'A';\n      this.entitySearchHelp.MULTI = false;\n      this.entitySearchHelp.FUZZY_SEARCH = true;\n      this.entitySearchHelp.FIELDS = [\n        {FIELD_NAME: 'ENTITY_ID', LIST_HEADER_TEXT: 'Entity', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'ENTITY_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.entitySearchHelp.READ_ONLY = this.readonly;\n    }\n    const afterExportFn = function (context: any) {\n      return () => context.onChangeEntityID(control);\n    }(this).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.entitySearchHelp, control, afterExportFn);\n  }\n\n  onChangeEntityID(formGroup: AbstractControl): void {\n    this._getRelationsOfEntity(formGroup, true);\n  }\n\n  _getRelationsOfEntity(searchHelpForm: AbstractControl, setDefault: boolean): void {\n    const domainEntityID = searchHelpForm.get('ENTITY_ID').value;\n    if (!domainEntityID) { return; }\n    this.entityService.getRelationMetaOfEntity(domainEntityID)\n      .subscribe(entityRelations => {\n        if (entityRelations[0]['msgType'] === 'E') {\n          searchHelpForm.get('ENTITY_ID').setErrors({message: entityRelations[0]['msgShortText']});\n        } else {\n          this.relationsOfEntity = entityRelations.map(relationMeta => relationMeta.RELATION_ID )\n            .filter(relationId => relationId.substr(0, 2) !== 'rs' );\n          if (setDefault) {\n            searchHelpForm.get('RELATION_ID').setValue(this.relationsOfEntity[0]);\n            searchHelpForm.get('RELATION_ID').markAsDirty();\n            this._getAttributesOfRelation(searchHelpForm, true);\n          }\n        }\n      });\n  }\n\n  onChangeRelationID(formGroup: AbstractControl): void {\n    this._getAttributesOfRelation(formGroup, true);\n  }\n  _getAttributesOfRelation(formGroup: AbstractControl, afterChanges: boolean): void {\n    const relationID = formGroup.get('RELATION_ID').value;\n    if (!relationID) { return; }\n    if (this.relationAttributesMap[relationID]) {\n      if (afterChanges) {\n        this._afterChangeRelationID(formGroup);\n      } else {\n        this.onChangeField(formGroup);\n      }\n    } else {\n      this.entityService.getRelationMeta(relationID)\n        .subscribe((relationMeta: RelationMeta) => {\n          this.relationAttributesMap[relationID] = relationMeta.ATTRIBUTES;\n          if (afterChanges) {\n            this._afterChangeRelationID(formGroup);\n          } else {\n            this.onChangeField(formGroup);\n          }\n        });\n    }\n  }\n  _afterChangeRelationID(formGroup: AbstractControl): void {\n    const relationID = formGroup.get('RELATION_ID').value;\n    if (formGroup.get('FIELD_NAME')) { // Search help field level relation ID change\n      formGroup.get('FIELD_NAME').setValue(this.relationAttributesMap[relationID][0]['ATTR_NAME']);\n      formGroup.get('FIELD_NAME').markAsDirty();\n      formGroup.get('FIELD_DESC').setValue(this.relationAttributesMap[relationID][0]['ATTR_DESC']);\n    } else { // Search help head level relation ID change\n      this.searchHelpFieldsFormArray.clear();\n      this.relationAttributesMap[relationID].forEach( (attribute: Attribute) => {\n        this.searchHelpFieldsFormArray.push(\n          this.fb.group({\n            RELATION_ID: [attribute.RELATION_ID],\n            FIELD_NAME: [attribute.ATTR_NAME],\n            FIELD_DESC: [attribute.ATTR_DESC],\n            IMPORT: [attribute.PRIMARY_KEY],\n            EXPORT: [attribute.PRIMARY_KEY],\n            IE_FIELD_NAME: [''],\n            LIST_POSITION: [attribute.ORDER],\n            FILTER_POSITION: [attribute.ORDER],\n            FILTER_DISP_ONLY: [false],\n            DEFAULT_VALUE: ['']\n          })\n        );\n      });\n      this.searchHelpFieldsFormArray.markAsDirty();\n    }\n  }\n\n  onChangeField(formGroup: AbstractControl): void {\n    const relationID = formGroup.get('RELATION_ID').value;\n    const currAttr = <Attribute>this.relationAttributesMap[relationID].find(\n      (attribute: Attribute) => attribute.ATTR_NAME === formGroup.get('FIELD_NAME').value);\n    formGroup.get('FIELD_DESC').setValue(currAttr.ATTR_DESC);\n  }\n\n  insertField(index: number): void {\n    const mainRelationID = this.searchHelpForm.get('RELATION_ID').value;\n    const firstAttribute = <Attribute>this.relationAttributesMap[mainRelationID][0];\n    this.searchHelpFieldsFormArray.insert(index, this.fb.group({\n      RELATION_ID: [mainRelationID],\n      FIELD_NAME: [firstAttribute.ATTR_NAME],\n      FIELD_DESC: [firstAttribute.ATTR_DESC],\n      IMPORT: [firstAttribute.PRIMARY_KEY],\n      EXPORT: [firstAttribute.PRIMARY_KEY],\n      IE_FIELD_NAME: [''],\n      LIST_POSITION: [0],\n      FILTER_POSITION: [0],\n      FILTER_DISP_ONLY: [false],\n      DEFAULT_VALUE: ['']\n    }));\n  }\n\n  deleteField(index: number): void {\n    if (this.searchHelpFieldsFormArray.length === 1) {\n      this.messageService.reportMessage('MODEL', 'MINIMUM_ONE_SEARCH_FIELD', 'E');\n      return;\n    }\n    this.searchHelpFieldsFormArray.removeAt(index);\n    this.searchHelpFieldsFormArray.markAsDirty();\n  }\n\n  onGoToEntity(entityID: string): void {\n    this.router.navigate(['/model/entity-type', entityID]);\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.searchHelpForm && this.searchHelpForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.searchHelpForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (this.searchHelpForm.invalid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedSearchHelp['action'] = 'add';\n      this.changedSearchHelp['SEARCH_HELP_ID'] = this.searchHelpForm.get('SEARCH_HELP_ID').value;\n    } else {\n      this.changedSearchHelp['action'] = 'update';\n      this.changedSearchHelp['SEARCH_HELP_ID'] = this.searchHelpMeta.SEARCH_HELP_ID;\n    }\n    if (this.searchHelpForm.get('SEARCH_HELP_DESC').dirty) {\n      this.changedSearchHelp['SEARCH_HELP_DESC'] = this.searchHelpForm.get('SEARCH_HELP_DESC').value;\n    }\n    if (this.searchHelpForm.get('BEHAVIOUR').dirty) {\n      this.changedSearchHelp['BEHAVIOUR'] = this.searchHelpForm.get('BEHAVIOUR').value;\n    }\n    if (this.searchHelpForm.get('MULTI').dirty) {\n      this.changedSearchHelp['MULTI'] = this.searchHelpForm.get('MULTI').value;\n    }\n    if (this.searchHelpForm.get('FUZZY_SEARCH').dirty) {\n      this.changedSearchHelp['FUZZY_SEARCH'] = this.searchHelpForm.get('FUZZY_SEARCH').value;\n    }\n    if (this.searchHelpForm.get('ENTITY_ID').dirty) {\n      this.changedSearchHelp['ENTITY_ID'] = this.searchHelpForm.get('ENTITY_ID').value;\n    }\n    if (this.searchHelpForm.get('RELATION_ID').dirty) {\n      this.changedSearchHelp['RELATION_ID'] = this.searchHelpForm.get('RELATION_ID').value;\n    }\n    if (this.searchHelpForm.get('FIELDS').dirty) {\n      this.changedSearchHelp['FIELDS'] = [];\n      this.searchHelpForm.get('FIELDS').value.forEach( field => {\n        if (field.FIELD_NAME) {\n          this.changedSearchHelp['FIELDS'].push(field);\n        }\n      });\n    }\n    this.entityService.saveSearchHelp(this.changedSearchHelp)\n      .subscribe(data => this._postActivityAfterSavingSearchHelp(data));\n  }\n\n  _postActivityAfterSavingSearchHelp(data: any) {\n    this.changedSearchHelp = {};\n    if (data['SEARCH_HELP_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/search-help/' + data['SEARCH_HELP_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'SEARCH_HELP_SAVED', 'S', data['SEARCH_HELP_ID'])}});\n      } else {\n        this._switch2DisplayMode();\n        this.searchHelpMeta = data;\n        this._generateSearchHelpForm();\n        this.searchHelpFieldsFormArray.controls.forEach( field =>\n          this._getAttributesOfRelation(field, false ));\n        this.messageService.reportMessage('MODEL', 'SEARCH_HELP_SAVED', 'S', data['SEARCH_HELP_ID']);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n","export default \"<div class=\\\"btn-toolbar mb-2\\\"  role=\\\"toolbar\\\"\\n     [ngClass]=\\\"{'justify-content-end': isSearchListShown, 'justify-content-between': !isSearchListShown}\\\" >\\n  <button *ngIf=\\\"!isSearchListShown\\\" class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Show List\\\" (click)=\\\"showSearchList()\\\">\\n    <span class=\\\"fas fa-arrow-right\\\"></span>\\n  </button>\\n\\n  <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Edit/Display\\\" (click)=\\\"switchEditDisplay()\\\">\\n      <span *ngIf=\\\"readonly\\\" class=\\\"fas fa-edit\\\"></span>\\n      <span *ngIf=\\\"!readonly\\\" class=\\\"fas fa-glasses\\\"></span>\\n    </button>\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Save\\\" (click)=\\\"save()\\\">\\n      <span class=\\\"fas fa-save\\\"></span>\\n    </button>\\n  </div>\\n</div>\\n\\n<dk-message></dk-message>\\n<form *ngIf=\\\"searchHelpMeta\\\" [formGroup]=\\\"searchHelpForm\\\">\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"searchHelp\\\" class=\\\"col-form-label form-control-sm\\\">Search Help:\\n      <span [class.ng-invalid]=\\\"searchHelpForm.get('SEARCH_HELP_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n        {{searchHelpForm.get('SEARCH_HELP_ID').errors?.message}}\\n      </span>\\n    </label>\\n    <input type=\\\"text\\\" class=\\\"form-control form-control-sm\\\" id=\\\"searchHelp\\\" [readonly]=\\\"readonly || !isNewMode\\\"\\n           (change)=\\\"onChangeSearchHelpID()\\\" name=\\\"searchHelp\\\" formControlName=\\\"SEARCH_HELP_ID\\\">\\n  </div>\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"searchHelp-desc\\\" class=\\\"col-form-label form-control-sm\\\">Search Help Description:</label>\\n    <textarea class=\\\"form-control\\\" id=\\\"searchHelp-desc\\\" name=\\\"searchHelp-desc\\\" rows=\\\"2\\\"\\n              formControlName=\\\"SEARCH_HELP_DESC\\\" [readonly]=\\\"readonly\\\" (change)=\\\"onChangeSearchHelpDesc()\\\"></textarea>\\n  </div>\\n\\n  <div class=\\\"card mt-2\\\">\\n    <div class=\\\"card-header\\\">Search Help Definition</div>\\n    <div class=\\\"card-body\\\">\\n      <div class=\\\"card mb-2\\\">\\n        <div class=\\\"ml-4 mt-2\\\">\\n          <label class=\\\"col-form-label col-form-label-sm\\\" for=\\\"ENTITY_ID\\\">Entity and Relation:\\n            <span [class.ng-invalid]=\\\"searchHelpForm.get('ENTITY_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n                  {{searchHelpForm.get('ENTITY_ID').errors?.message}}\\n            </span>\\n          </label>\\n        </div>\\n        <div class=\\\"card-body row\\\">\\n          <div class=\\\"input-group col-lg-4 ml-1\\\">\\n            <input type=\\\"text\\\" formControlName=\\\"ENTITY_ID\\\" id=\\\"ENTITY_ID\\\" name=\\\"ENTITY_ID\\\" placeholder=\\\"Entity Type\\\"\\n                   class=\\\"form-control form-control-sm\\\" [readonly]=\\\"readonly\\\" (change)=\\\"onChangeEntityID(searchHelpForm)\\\"\\n                   (dblclick)=\\\"onGoToEntity(searchHelpForm.get('ENTITY_ID').value)\\\">\\n            <div class=\\\"input-group-append\\\">\\n              <button class=\\\"btn btn-outline-secondary btn-sm\\\" type=\\\"button\\\" id=\\\"searchEntity\\\"\\n                      (click)=\\\"onEntitySearchHelp(searchHelpForm)\\\">\\n                <span class=\\\"fas fa-search\\\"></span>\\n              </button>\\n            </div>\\n          </div>\\n          <select formControlName=\\\"RELATION_ID\\\" class=\\\"form-control form-control-sm col-lg-4 ml-2 mr-3\\\"\\n                  (change)=\\\"onChangeRelationID(searchHelpForm)\\\">\\n            <option *ngFor=\\\"let relation of relationsOfEntity\\\" [value]=\\\"relation\\\">{{relation}}</option>\\n          </select>\\n        </div>\\n      </div>\\n\\n      <div class=\\\"card mb-2\\\">\\n        <div class=\\\"card-body row\\\">\\n          <div class=\\\"form-group row col-lg-5 mr-2\\\">\\n            <label class=\\\"col-form-label col-form-label-sm col-4 text-right\\\" for=\\\"behaviour\\\">Behaviour:</label>\\n            <select formControlName=\\\"BEHAVIOUR\\\" class=\\\"form-control form-control-sm col-8\\\" id=\\\"behaviour\\\">\\n              <option *ngFor=\\\"let opt of behaviours\\\" [value]=\\\"opt.key\\\">{{opt.value}}</option>\\n            </select>\\n          </div>\\n          <div class=\\\"form-check col-lg-3 ml-4\\\">\\n            <input type=\\\"checkbox\\\" class=\\\"form-check-input\\\" formControlName=\\\"MULTI\\\" id=\\\"Multiple\\\">\\n            <label class=\\\"form-check-label\\\" for=\\\"Multiple\\\">Multiple Values</label>\\n          </div>\\n<!--          <div class=\\\"form-check col-lg-3 ml-4\\\">-->\\n<!--            <input type=\\\"checkbox\\\" class=\\\"form-check-input\\\" formControlName=\\\"FUZZY_SEARCH\\\" id=\\\"fuzzySearch\\\">-->\\n<!--            <label class=\\\"form-check-label\\\" for=\\\"fuzzySearch\\\">Fuzzy Search</label>-->\\n<!--          </div>-->\\n        </div>\\n      </div>\\n\\n    </div>\\n  </div>\\n\\n  <div class=\\\"card mt-2\\\">\\n    <div class=\\\"card-header\\\">Search Help Fields</div>\\n    <div class=\\\"card-body\\\">\\n      <table class=\\\"table table-bordered dk-table\\\">\\n        <thead class=\\\"thead-light\\\">\\n        <tr>\\n          <th scope=\\\"col\\\">Relation</th>\\n          <th scope=\\\"col\\\">Field Name</th>\\n          <th scope=\\\"col\\\">Field Description</th>\\n          <th scope=\\\"col\\\" title=\\\"Import the value to the filter\\\">I</th>\\n          <th scope=\\\"col\\\" title=\\\"Export the value when selected\\\">E</th>\\n          <th scope=\\\"col\\\">Alias</th>\\n          <th scope=\\\"col\\\" title=\\\"Position in the list\\\">L.P.</th>\\n          <th scope=\\\"col\\\" title=\\\"Position in the filter\\\">F.P.</th>\\n          <th scope=\\\"col\\\" title=\\\"Display on in the filter\\\">Disp</th>\\n          <th scope=\\\"col\\\" title=\\\"Default value in the filter\\\">Default</th>\\n          <th scope=\\\"col\\\">Actions</th>\\n        </tr>\\n        </thead>\\n\\n        <tbody formArrayName=\\\"FIELDS\\\">\\n        <tr *ngFor=\\\"let fieldForm of searchHelpFieldsFormArray.controls; let i = index\\\">\\n          <td [formGroup]=\\\"fieldForm\\\" class=\\\"dk-selection\\\">\\n            <div class=\\\"input-group\\\">\\n              <select formControlName=\\\"RELATION_ID\\\" class=\\\"form-control form-control-sm\\\"\\n                      (change)=\\\"onChangeRelationID(fieldForm)\\\">\\n                <option *ngFor=\\\"let relation of relationsOfEntity\\\" [value]=\\\"relation\\\">{{relation}}</option>\\n              </select>\\n            </div>\\n          </td>\\n          <td [formGroup]=\\\"fieldForm\\\" class=\\\"dk-selection\\\">\\n            <div class=\\\"input-group\\\">\\n              <select formControlName=\\\"FIELD_NAME\\\" class=\\\"form-control form-control-sm\\\"\\n                      (change)=\\\"onChangeField(fieldForm)\\\">\\n                <option *ngFor=\\\"let attribute of relationAttributesMap[fieldForm.get('RELATION_ID').value]\\\"\\n                        [value]=\\\"attribute['ATTR_NAME']\\\">{{attribute['ATTR_NAME']}}</option>\\n              </select>\\n            </div>\\n          </td>\\n          <td [formGroup]=\\\"fieldForm\\\" class=\\\"dk-description\\\">\\n            <input  type=\\\"text\\\" formControlName=\\\"FIELD_DESC\\\" class=\\\"form-control\\\" maxlength=\\\"100\\\" readonly>\\n          </td>\\n          <td [formGroup]=\\\"fieldForm\\\">\\n            <input type=\\\"checkbox\\\" formControlName=\\\"IMPORT\\\">\\n          </td>\\n          <td [formGroup]=\\\"fieldForm\\\">\\n            <input type=\\\"checkbox\\\" formControlName=\\\"EXPORT\\\">\\n          </td>\\n          <td [formGroup]=\\\"fieldForm\\\" class=\\\"dk-string\\\">\\n            <input  type=\\\"text\\\" formControlName=\\\"IE_FIELD_NAME\\\" class=\\\"form-control form-control-sm\\\"  [readonly]=\\\"readonly\\\">\\n          </td>\\n          <td [formGroup]=\\\"fieldForm\\\" class=\\\"dk-number\\\">\\n            <input type=\\\"number\\\" min=\\\"0\\\" formControlName=\\\"LIST_POSITION\\\" class=\\\"form-control form-control-sm\\\" [readonly]=\\\"readonly\\\">\\n          </td>\\n          <td [formGroup]=\\\"fieldForm\\\" class=\\\"dk-number\\\">\\n            <input type=\\\"number\\\" min=\\\"0\\\" formControlName=\\\"FILTER_POSITION\\\" class=\\\"form-control form-control-sm\\\" [readonly]=\\\"readonly\\\">\\n          </td>\\n          <td [formGroup]=\\\"fieldForm\\\">\\n            <input type=\\\"checkbox\\\" formControlName=\\\"FILTER_DISP_ONLY\\\">\\n          </td>\\n          <td [formGroup]=\\\"fieldForm\\\" class=\\\"dk-string\\\">\\n            <input  type=\\\"text\\\" formControlName=\\\"DEFAULT_VALUE\\\" class=\\\"form-control form-control-sm\\\"  [readonly]=\\\"readonly\\\">\\n          </td>\\n          <td class=\\\"dk-actions\\\">\\n            <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" [disabled]=\\\"readonly\\\" (click)=\\\"insertField(i)\\\" title=\\\"Insert\\\">\\n              <span class=\\\"fas fa-plus\\\"></span>\\n            </button>\\n            <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" [disabled]=\\\"readonly\\\" (click)=\\\"deleteField(i)\\\" title=\\\"Delete\\\">\\n              <span class=\\\"far fa-trash-alt\\\"></span>\\n            </button>\\n          </td>\\n        </tr>\\n        </tbody>\\n      </table>\\n    </div>\\n  </div>\\n</form>\\n\\n<dk-app-search-help></dk-app-search-help>\\n\";","import { Component, OnInit } from '@angular/core';\nimport { RelationshipH} from 'jor-angular';\nimport {Subject} from 'rxjs';\nimport {EntityService} from 'jor-angular';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-relationship',\n  templateUrl: './relationship.component.html',\n  styleUrls: ['./relationship.component.css']\n})\nexport class RelationshipComponent implements OnInit {\n  relationshipList: RelationshipH[];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedRelationship: RelationshipH;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listRelationship(term)),\n    ).subscribe(data => {\n      this.relationshipList = data;\n      let relationshipID;\n      if (this.route.snapshot.firstChild) {\n        relationshipID = this.route.snapshot.firstChild.paramMap.get('relationshipID');\n      }\n      if (relationshipID ) {\n        if (relationshipID === 'new') {\n          this._newRelationship();\n        } else {\n          this.onSelect(this.relationshipList.find(relationship => relationship.RELATIONSHIP_ID === relationshipID));\n        }\n      }\n    });\n    this.searchRelationship(''); // The initial list\n\n    this.modelService.theSelectedRelationship$.subscribe( data => {\n      if (this.theSelectedRelationship) {\n        this.theSelectedRelationship.RELATIONSHIP_ID = data['RELATIONSHIP_ID'];\n        this.theSelectedRelationship.RELATIONSHIP_DESC = data['RELATIONSHIP_DESC'];\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.relationshipList[0] && !this.relationshipList[0].CREATE_TIME) {\n        this.relationshipList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const relationshipID = this.route.snapshot.firstChild.paramMap.get('relationshipID');\n        if (relationshipID) {\n          if (relationshipID === 'new') {\n            this.onSelect(this.relationshipList[0]);\n          } else {\n            this.onSelect(this.relationshipList.find(relationship => relationship.RELATIONSHIP_ID === relationshipID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  onSelect(relationship: RelationshipH): void {\n    if (relationship) {\n      this.theSelectedRelationship = relationship;\n      this.modelService.setSelectedRelationship(relationship);\n    }\n  }\n\n  searchRelationship(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  newRelationship(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('relationshipID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newRelationship();\n      this.router.navigate(['/model/relationship/new']);\n    }\n  }\n\n  _newRelationship(): void {\n    this.theSelectedRelationship = new RelationshipH();\n    this.theSelectedRelationship.RELATIONSHIP_ID = 'new';\n    this.theSelectedRelationship.RELATIONSHIP_DESC = 'description';\n    this.theSelectedRelationship.VERSION_NO = 1;\n    this.theSelectedRelationship.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedRelationship.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedRelationship(this.theSelectedRelationship);\n    this.relationshipList.splice(0, 0, this.theSelectedRelationship);\n  }\n}\n","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {Attribute, RelationshipMeta} from 'jor-angular';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {AttributeMetaComponent} from '../../attribute-meta/attribute-meta.component';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {EntityService} from 'jor-angular';\nimport {msgStore} from '../../../msgStore';\nimport {switchMap} from 'rxjs/operators';\nimport {forkJoin, Observable, of} from 'rxjs';\nimport {UniqueRelationshipValidator} from '../../model-validators';\nimport {SearchHelp, SearchHelpMethod} from 'jor-angular';\nimport {SearchHelpComponent} from 'jor-angular';\n\n@Component({\n  selector: 'app-relationship-detail',\n  templateUrl: './relationship-detail.component.html',\n  styleUrls: ['./relationship-detail.component.css']\n})\nexport class RelationshipDetailComponent implements OnInit {\n  relationshipMeta: RelationshipMeta;\n  attributes: Attribute[];\n  readonly = true;\n  isNewMode = false;\n  relationshipForm: FormGroup;\n  changedRelationship = {};\n  bypassProtection = false;\n  isSearchListShown = true;\n  roleSearchHelp: SearchHelp;\n\n  @ViewChild(AttributeMetaComponent, {static: false})\n  private attrComponent!: AttributeMetaComponent;\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent!: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueRelationshipValidator: UniqueRelationshipValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.messageService.setMessageStore(msgStore, 'EN');\n  }\n\n  get involveFormArray() {\n    return this.relationshipForm.get('INVOLVES') as FormArray;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const relationshipID = params.get('relationshipID');\n        if (relationshipID === 'new') {\n          const relationship = new RelationshipMeta();\n          relationship.RELATIONSHIP_ID = 'rs_';\n          relationship.RELATIONSHIP_DESC = '';\n          relationship.VALID_PERIOD = 0;\n          relationship.SINGLETON = false;\n          relationship.INVOLVES = [];\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return forkJoin(of(relationship), of([]));\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return forkJoin([\n            this.entityService.getRelationship(relationshipID),\n            this.entityService.getRelationMeta(relationshipID)\n          ]);\n        }\n      })\n    ).subscribe(data => {\n      if ( 'msgName' in data[0]) {\n        this.messageService.clearMessages();\n        this.relationshipMeta = null;\n        this.relationshipForm = null;\n        this.messageService.report(<Message>data[0]);\n      } else {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.relationshipMeta = data[0];\n        this.attributes = 'msgName' in data[1] ? [] : data[1]['ATTRIBUTES'];\n        this._generateRelationshipForm();\n        if (this.readonly) {\n          this.relationshipForm.get('TIME_DEPENDENT').disable();\n          this.relationshipForm.get('SINGLETON').disable();\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  onSearchHelp(control: AbstractControl, rowID: number): void {\n    if (!this.roleSearchHelp) {\n      this.roleSearchHelp = new SearchHelp();\n      this.roleSearchHelp.OBJECT_NAME = 'Role';\n      this.roleSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listRole(searchTerm);\n      }(this.entityService);\n      this.roleSearchHelp.BEHAVIOUR = 'A';\n      this.roleSearchHelp.MULTI = false;\n      this.roleSearchHelp.FUZZY_SEARCH = true;\n      this.roleSearchHelp.FIELDS = [\n        {FIELD_NAME: 'ROLE_ID', LIST_HEADER_TEXT: 'Role', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'ROLE_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.roleSearchHelp.READ_ONLY = this.readonly || this.oldInvolve(control) && control.valid;\n    }\n    const afterExportFn = function (context: any, ruleIdx: number) {\n      return () => context.onChangeRoleID(ruleIdx, true);\n    }(this, rowID).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.roleSearchHelp, control, afterExportFn);\n  }\n\n  _generateRelationshipForm(): void {\n    if (this.relationshipForm) {\n      this.relationshipForm.markAsPristine({onlySelf: false});\n      this.relationshipForm.get('RELATIONSHIP_ID').setValue(this.relationshipMeta.RELATIONSHIP_ID);\n      this.relationshipForm.get('RELATIONSHIP_DESC').setValue(this.relationshipMeta.RELATIONSHIP_DESC);\n      this.relationshipForm.get('TIME_DEPENDENT').setValue(this.relationshipMeta.VALID_PERIOD > 0);\n      this.relationshipForm.get('VALID_PERIOD').setValue(this.relationshipMeta.VALID_PERIOD);\n      this.relationshipForm.get('SINGLETON').setValue(this.relationshipMeta.SINGLETON);\n      this.relationshipForm.removeControl('ATTRIBUTES');\n    } else {\n      this.relationshipForm = this.fb.group({\n        RELATIONSHIP_ID: [this.relationshipMeta.RELATIONSHIP_ID, {updateOn: 'blur'}],\n        RELATIONSHIP_DESC: [this.relationshipMeta.RELATIONSHIP_DESC],\n        TIME_DEPENDENT: [this.relationshipMeta.VALID_PERIOD > 0],\n        VALID_PERIOD: [this.relationshipMeta.VALID_PERIOD, this._validateValidPeriod],\n        SINGLETON: [this.relationshipMeta.SINGLETON]\n      });\n    }\n\n    // Compose Involves\n    const formArray = [];\n    this.relationshipMeta.INVOLVES.forEach( involve => {\n      formArray.push(this.fb.group({\n        ROLE_ID: [involve.ROLE_ID],\n        ROLE_DESC: [involve.ROLE_DESC],\n        CARDINALITY: [{value: involve.CARDINALITY, disabled: this.readonly}],\n        DIRECTION: [involve.DIRECTION]\n      }));\n    });\n\n    if (this.isNewMode) {\n      this.relationshipForm.get('RELATIONSHIP_ID').setValidators(this._validateRelationshipID);\n      this.relationshipForm.get('RELATIONSHIP_ID').setAsyncValidators(\n        this.uniqueRelationshipValidator.validate.bind(this.uniqueRelationshipValidator));\n      this.relationshipForm.get('TIME_DEPENDENT').enable();\n      this.relationshipForm.get('VALID_PERIOD').disable(); // TIME_DEPENDENT by default is not checked\n      formArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CARDINALITY: ['[1..1]'],\n          DIRECTION: ['']\n        }));\n    } else {\n      this.relationshipForm.get('RELATIONSHIP_ID').clearValidators();\n      this.relationshipForm.get('RELATIONSHIP_ID').clearAsyncValidators();\n      this.relationshipForm.get('RELATIONSHIP_ID').updateValueAndValidity();\n    }\n\n    this.relationshipForm.setControl('INVOLVES', new FormArray(formArray));\n  }\n\n  _validateRelationshipID(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Relationship ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().toLowerCase().substr(0, 3) !== 'rs_') {\n      return {message: 'Relationship ID must be started with \"rs_\"!'};\n    }\n\n    if (c.value.toString().length < 4) {\n      return {message: 'Relationship ID must have length larger than 3!'};\n    }\n    if (c.value.toString().length > 32) {\n      return {message: 'Relationship ID must have length less than 32!'};\n    }\n    return null;\n  }\n\n  _validateValidPeriod(c: FormControl) {\n    if (c.parent && c.parent.value.TIME_DEPENDENT && c.value <= 0) {\n      return {message: 'must be larger than 0'};\n    }\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Relationship?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.relationshipMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.relationshipForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateRelationshipForm();\n            this.relationshipForm.reset(this.relationshipForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this.readonly = false;\n      this.relationshipForm.get('TIME_DEPENDENT').enable();\n      if (!this.relationshipForm.get('TIME_DEPENDENT').value) {\n        this.relationshipForm.get('VALID_PERIOD').disable();\n      }\n      this.relationshipForm.get('SINGLETON').enable();\n      this.attrComponent.switchEditDisplay(this.readonly);\n      this.involveFormArray.controls.forEach(involveFormGroup => {\n        involveFormGroup.get('CARDINALITY').enable();\n      });\n      this.involveFormArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CARDINALITY: ['[1..1]'],\n          DIRECTION: ['']\n        })\n      );\n    }\n\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    this.relationshipForm.get('TIME_DEPENDENT').disable();\n    this.relationshipForm.get('SINGLETON').disable();\n    this.attrComponent.switchEditDisplay(this.readonly);\n    let lastIndex = this.involveFormArray.length - 1;\n    while (lastIndex >= 0 && this.involveFormArray.controls[lastIndex].get('ROLE_ID').value.trim() === '') {\n      this.involveFormArray.removeAt(lastIndex);\n      lastIndex--;\n    }\n    this.involveFormArray.controls.forEach(involveFormGroup => {\n      involveFormGroup.get('CARDINALITY').disable();\n    });\n  }\n\n  onChangeRelationshipID(): void {\n    this.modelService.updateRelationshipID(this.relationshipForm.get('RELATIONSHIP_ID').value);\n  }\n\n  onChangeTimeDependency(): void {\n    const timeDependent = this.relationshipForm.get('TIME_DEPENDENT').value;\n    const validPeriodCtrl = this.relationshipForm.get('VALID_PERIOD');\n    const relationID = this.relationshipForm.get('RELATIONSHIP_ID').value;\n    const attrFormArray = this.relationshipForm.get('ATTRIBUTES') as FormArray;\n    if (timeDependent) {\n      validPeriodCtrl.setValue(31536000); // 3600 * 24 * 365\n      validPeriodCtrl.markAsDirty();\n      validPeriodCtrl.enable();\n      const validFromFormGroup = this.fb.group({\n        ATTR_GUID: [''],\n        RELATION_ID: [relationID],\n        ATTR_NAME: ['VALID_FROM'],\n        ATTR_DESC: ['Valid from'],\n        DATA_ELEMENT: [''],\n        DATA_TYPE: [{value: 8, disabled: true}],\n        DATA_LENGTH: [null],\n        DECIMAL: [null],\n        ORDER: [null],\n        PRIMARY_KEY: [false],\n        AUTO_INCREMENT: [false]\n      });\n      validFromFormGroup.markAsDirty();\n      attrFormArray.insert(attrFormArray.length - 1, validFromFormGroup);\n      const validToFormGroup = this.fb.group({\n        ATTR_GUID: [''],\n        RELATION_ID: [relationID],\n        ATTR_NAME: ['VALID_TO'],\n        ATTR_DESC: ['Valid to'],\n        DATA_ELEMENT: [''],\n        DATA_TYPE: [{value: 8, disabled: true}],\n        DATA_LENGTH: [null],\n        DECIMAL: [null],\n        ORDER: [null],\n        PRIMARY_KEY: [false],\n        AUTO_INCREMENT: [false]\n      });\n      validToFormGroup.markAsDirty();\n      attrFormArray.insert(attrFormArray.length - 1, validToFormGroup);\n    } else {\n      validPeriodCtrl.setValue(0);\n      validPeriodCtrl.disable();\n      validPeriodCtrl.markAsDirty();\n      const attributeValidFromIndex = attrFormArray.controls.findIndex(\n        attrCtrl => attrCtrl.get('ATTR_NAME').value === 'VALID_FROM');\n      if (attributeValidFromIndex >= 0) { this.attrComponent.deleteAttribute(attributeValidFromIndex); }\n      const attributeValidToIndex = attrFormArray.controls.findIndex(\n        attrCtrl => attrCtrl.get('ATTR_NAME').value === 'VALID_TO');\n      if (attributeValidToIndex >= 0) { this.attrComponent.deleteAttribute(attributeValidToIndex); }\n    }\n\n  }\n\n  onChangeRelationshipDesc(): void {\n    this.modelService.updateRelationshipDesc(this.relationshipForm.get('RELATIONSHIP_DESC').value);\n  }\n\n  deleteInvolve(index: number): void {\n    if (index !== this.involveFormArray.length - 1) {\n      const currentRoleID = this.involveFormArray.at(index).get('ROLE_ID').value;\n      this.involveFormArray.removeAt(index);\n      this.involveFormArray.markAsDirty();\n      const attrFormArray = this.relationshipForm.get('ATTRIBUTES') as FormArray;\n      const attributeInstanceGUIDIndex = attrFormArray.controls.findIndex(\n        attrCtrl => attrCtrl.get('ATTR_NAME').value === currentRoleID + '_INSTANCE_GUID');\n      if (attributeInstanceGUIDIndex >= 0) { this.attrComponent.deleteAttribute(attributeInstanceGUIDIndex); }\n      const attributeEntityIDIndex = attrFormArray.controls.findIndex(\n        attrCtrl => attrCtrl.get('ATTR_NAME').value === currentRoleID + '_ENTITY_ID');\n      if (attributeEntityIDIndex >= 0) { this.attrComponent.deleteAttribute(attributeEntityIDIndex); }\n    }\n  }\n\n  onChangeRoleID(index: number): void {\n    const currentInvolveFormGroup = this.involveFormArray.controls[index];\n    if (this.involveFormArray.controls.findIndex((involveCtrl, i) =>\n      i !== index && involveCtrl.get('ROLE_ID').value === currentInvolveFormGroup.get('ROLE_ID').value\n    ) !== -1) {\n      currentInvolveFormGroup.get('ROLE_ID').setErrors({message: 'Duplicate roles'});\n      return;\n    }\n\n    if (index === this.involveFormArray.length - 1 && currentInvolveFormGroup.value.ROLE_ID.trim() !== '') {\n      // Only work for the last New line\n      this.involveFormArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CARDINALITY: ['[1..1]'],\n          DIRECTION: ['']\n        })\n      );\n    }\n\n    this.entityService.getRoleDesc(currentInvolveFormGroup.value.ROLE_ID).subscribe(data => {\n      if (data['msgCat']) {\n        currentInvolveFormGroup.get('ROLE_ID').setErrors({message: data['msgShortText']});\n      } else {\n        currentInvolveFormGroup.get('ROLE_DESC').setValue(data);\n        const attrFormArray = this.relationshipForm.get('ATTRIBUTES') as FormArray;\n        const relationID = this.relationshipForm.get('RELATIONSHIP_ID').value;\n        const instanceGUIDFormGroup = this.fb.group({\n          ATTR_GUID: [''],\n          RELATION_ID: [relationID],\n          ATTR_NAME: [currentInvolveFormGroup.value.ROLE_ID + '_INSTANCE_GUID'],\n          ATTR_DESC: ['Entity Instance GUID of role ' + currentInvolveFormGroup.value.ROLE_ID],\n          DATA_ELEMENT: [null],\n          DATA_TYPE: [{value: 1, disabled: true}],\n          DATA_LENGTH: [32],\n          DECIMAL: [null],\n          ORDER: [null],\n          PRIMARY_KEY: [false],\n          AUTO_INCREMENT: [false]\n        });\n        instanceGUIDFormGroup.markAsDirty();\n        attrFormArray.insert(attrFormArray.length - 1, instanceGUIDFormGroup);\n        const entityIDFormGroup = this.fb.group({\n          ATTR_GUID: [''],\n          RELATION_ID: [relationID],\n          ATTR_NAME: [currentInvolveFormGroup.value.ROLE_ID + '_ENTITY_ID'],\n          ATTR_DESC: ['Entity ID of role ' + currentInvolveFormGroup.value.ROLE_ID],\n          DATA_ELEMENT: [null],\n          DATA_TYPE: [{value: 1, disabled: true}],\n          DATA_LENGTH: [32],\n          DECIMAL: [null],\n          ORDER: [null],\n          PRIMARY_KEY: [false],\n          AUTO_INCREMENT: [false]\n        });\n        entityIDFormGroup.markAsDirty();\n        attrFormArray.insert(attrFormArray.length - 1, entityIDFormGroup);\n        attrFormArray.markAsDirty();\n      }\n    });\n  }\n\n  oldInvolve(formGroup: AbstractControl): boolean {\n    return this.relationshipMeta.INVOLVES.findIndex( role => role.ROLE_ID === formGroup.get('ROLE_ID').value ) !== -1;\n  }\n\n  onGoToRole(roleID: string): void {\n    this.router.navigate(['/model/role', roleID]);\n  }\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.relationshipForm && this.relationshipForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.relationshipForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (!this.relationshipForm.valid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedRelationship['action'] = 'add';\n      this.changedRelationship['RELATIONSHIP_ID'] = this.relationshipForm.controls['RELATIONSHIP_ID'].value;\n    } else {\n      this.changedRelationship['action'] = 'update';\n      this.changedRelationship['RELATIONSHIP_ID'] = this.relationshipMeta.RELATIONSHIP_ID;\n    }\n    if (this.relationshipForm.controls['RELATIONSHIP_DESC'].dirty) {\n      this.changedRelationship['RELATIONSHIP_DESC'] = this.relationshipForm.controls['RELATIONSHIP_DESC'].value;\n    }\n    if (this.isNewMode || this.relationshipForm.controls['VALID_PERIOD'].dirty) {\n      this.changedRelationship['VALID_PERIOD'] = this.relationshipForm.controls['VALID_PERIOD'].value;\n    }\n    if (this.isNewMode || this.relationshipForm.controls['SINGLETON'].dirty) {\n      this.changedRelationship['SINGLETON'] = this.relationshipForm.controls['SINGLETON'].value;\n    }\n\n    this.changedRelationship['ATTRIBUTES'] = this.attrComponent.processChangedAttributes();\n\n    if (this._processChangedInvolves()) {\n      // console.log(this.changedRelationship);\n      this.entityService.saveRelationship(this.changedRelationship)\n        .subscribe(data => this._postActivityAfterSavingRelationship(data));\n    }\n  }\n\n  _processChangedInvolves(): boolean {\n    if (this.involveFormArray.length <= 2) { // An empty line is included\n      this.messageService.reportMessage('MODEL', 'RELATIONSHIP_LACK_INVOLVED_ROLES', 'E');\n      return false;\n    }\n    const changedInvolves = [];\n    if (this.involveFormArray.dirty) {\n      this.changedRelationship['INVOLVES'] = changedInvolves;\n\n      this.involveFormArray.controls.forEach(involveControl => {\n        if (involveControl.get('ROLE_ID').value.trim() === '') { return; }\n        let action;\n        const index = this.relationshipMeta.INVOLVES.findIndex(\n          involve => involveControl.get('ROLE_ID').value === involve.ROLE_ID);\n        if (index === -1) { // New Add Case\n          action = 'add';\n        } else { // New Update Case\n          if (involveControl.dirty) { action = 'update'; }\n        }\n        if (action) {\n          changedInvolves.push({ action: action, ROLE_ID: involveControl.get('ROLE_ID').value,\n            CARDINALITY: involveControl.get('CARDINALITY').value, DIRECTION: involveControl.get('DIRECTION').value });\n        }\n      });\n\n      // Deletion Case\n      this.relationshipMeta.INVOLVES.forEach(involve => {\n        const index = this.involveFormArray.controls.findIndex(\n          roleControl => roleControl.get('ROLE_ID').value === involve.ROLE_ID);\n        if (index === -1) { // The attribute must be deleted\n          const deletedRole = {action: 'delete', ROLE_ID: involve.ROLE_ID};\n          changedInvolves.push(deletedRole);\n        }\n      });\n    }\n    return true;\n  }\n\n  _postActivityAfterSavingRelationship(data: any) {\n    this.changedRelationship = {};\n    if (data[0] && data[0]['RELATIONSHIP_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/relationship/' + data[0]['RELATIONSHIP_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'RELATIONSHIP_SAVED', 'S', data[0]['RELATIONSHIP_ID'])}});\n      } else {\n        this.readonly = true;\n        this.relationshipForm.get('TIME_DEPENDENT').disable();\n        this.relationshipForm.get('SINGLETON').disable();\n        this.relationshipMeta = data[0];\n        this.attributes = data[1].ATTRIBUTES;\n        this._generateRelationshipForm();\n        this.messageService.reportMessage(\n          'MODEL', 'RELATIONSHIP_SAVED', 'S', this.relationshipMeta.RELATIONSHIP_ID);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {AbstractControl, FormBuilder, FormControl, FormGroup, Validators} from '@angular/forms';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {UniqueDataElementValidator} from '../../model-validators';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {msgStore} from '../../../msgStore';\nimport {switchMap} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\nimport {DataElementMeta, EntityService, SearchHelp, SearchHelpComponent, SearchHelpField, SearchHelpMethod} from 'jor-angular';\n\n@Component({\n  selector: 'app-data-element-detail',\n  templateUrl: './data-element-detail.component.html',\n  styleUrls: ['./data-element-detail.component.css']\n})\nexport class DataElementDetailComponent implements OnInit {\n  dataElementMeta: DataElementMeta;\n  readonly = true;\n  isNewMode = false;\n  dataElementForm: FormGroup;\n  dataTypes = [];\n  changedDataElement = {};\n  bypassProtection = false;\n  isSearchListShown = true;\n  searchHelpExportField = [];\n  dataDomainSearchHelp: SearchHelp;\n  searchHelpSearchHelp: SearchHelp;\n\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent !: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueDataElementValidator: UniqueDataElementValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.messageService.setMessageStore(msgStore, 'EN');\n    this.dataTypes = this.modelService.dataTypes;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const elementID = params.get('elementID');\n        if (elementID === 'new') {\n          const dataElement = new DataElementMeta();\n          dataElement.ELEMENT_ID = '';\n          dataElement.ELEMENT_DESC = '';\n          dataElement.DATA_TYPE = 1;\n          dataElement.DATA_LENGTH = 10;\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return of(dataElement);\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return this.entityService.getDataElement(elementID);\n        }})\n    ).subscribe(data => {\n      if ( 'msgName' in data) {\n        this.messageService.clearMessages();\n        this.dataElementMeta = null;\n        this.dataElementForm = null;\n        this.messageService.report(<Message>data);\n      } else {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.dataElementMeta = <DataElementMeta>data;\n        this._generateDataElementForm();\n        this._getSearchHelpMeta(this.dataElementForm, false);\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  onDataDomainSearchHelp(control: AbstractControl): void {\n    if (!this.dataDomainSearchHelp) {\n      this.dataDomainSearchHelp = new SearchHelp();\n      this.dataDomainSearchHelp.OBJECT_NAME = 'Data Domain';\n      this.dataDomainSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listDataDomain(searchTerm);\n      }(this.entityService);\n      this.dataDomainSearchHelp.BEHAVIOUR = 'A';\n      this.dataDomainSearchHelp.MULTI = false;\n      this.dataDomainSearchHelp.FUZZY_SEARCH = true;\n      this.dataDomainSearchHelp.FIELDS = [\n        {FIELD_NAME: 'DOMAIN_ID', LIST_HEADER_TEXT: 'Domain', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'DOMAIN_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.dataDomainSearchHelp.READ_ONLY = this.readonly || !this.dataElementForm.get('USE_DOMAIN').value;\n    }\n    const afterExportFn = function (context: any) {\n      return () => context.onChangeDataDomain(control);\n    }(this).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.dataDomainSearchHelp, control, afterExportFn);\n  }\n\n  onSearchHelpSearchHelp(control: AbstractControl): void {\n    if (!this.searchHelpSearchHelp) {\n      this.searchHelpSearchHelp = new SearchHelp();\n      this.searchHelpSearchHelp.OBJECT_NAME = 'Search Help';\n      this.searchHelpSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listSearchHelp(searchTerm);\n      }(this.entityService);\n      this.searchHelpSearchHelp.BEHAVIOUR = 'A';\n      this.searchHelpSearchHelp.MULTI = false;\n      this.searchHelpSearchHelp.FUZZY_SEARCH = true;\n      this.searchHelpSearchHelp.FIELDS = [\n        {FIELD_NAME: 'SEARCH_HELP_ID', LIST_HEADER_TEXT: 'Search Help', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'SEARCH_HELP_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.searchHelpSearchHelp.READ_ONLY = this.readonly;\n    }\n    const afterExportFn = function (context: any) {\n      return () => context.onChangeSearchHelp(control);\n    }(this).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.searchHelpSearchHelp, control, afterExportFn);\n  }\n\n  onChangeSearchHelp(formGroup: AbstractControl): void {\n    this._getSearchHelpMeta(formGroup, true);\n  }\n\n  _getSearchHelpMeta(formGroup: AbstractControl, setDefault: boolean): void {\n    const searchHelpCtrl = formGroup.get('SEARCH_HELP_ID');\n    if (!searchHelpCtrl.value) {\n      if (!this.readonly) {\n        formGroup.get('SEARCH_HELP_EXPORT_FIELD').setValue('');\n        formGroup.get('SEARCH_HELP_EXPORT_FIELD').markAsDirty();\n      }\n      return;\n    }\n    this.entityService.getSearchHelp(searchHelpCtrl.value).subscribe(data => {\n      if (data['msgCat']) {\n        searchHelpCtrl.setErrors({message: data['msgShortText']});\n        if (setDefault) {\n          formGroup.get('SEARCH_HELP_EXPORT_FIELD').setValue('');\n          formGroup.get('SEARCH_HELP_EXPORT_FIELD').markAsDirty();\n        }\n      } else {\n        this.searchHelpExportField = [];\n        const searchHelpFields = <SearchHelpField[]>data['FIELDS'];\n        searchHelpFields.forEach( field => {\n          if (field.EXPORT) {\n            this.searchHelpExportField.push( field.IE_FIELD_NAME || field.FIELD_NAME );\n          }\n        });\n        if (setDefault) {\n          formGroup.get('SEARCH_HELP_EXPORT_FIELD').setValue(this.searchHelpExportField[0]);\n          formGroup.get('SEARCH_HELP_EXPORT_FIELD').markAsDirty();\n        }\n      }\n    });\n  }\n\n  _generateDataElementForm(): void {\n    if (this.dataElementForm) {\n      this.dataElementForm.markAsPristine({onlySelf: false});\n      this.dataElementForm.get('ELEMENT_ID').setValue(this.dataElementMeta.ELEMENT_ID);\n      this.dataElementForm.get('ELEMENT_DESC').setValue(this.dataElementMeta.ELEMENT_DESC);\n      this.dataElementForm.get('LABEL_TEXT').setValue(this.dataElementMeta.LABEL_TEXT);\n      this.dataElementForm.get('LIST_HEADER_TEXT').setValue(this.dataElementMeta.LIST_HEADER_TEXT);\n      this.dataElementForm.get('DOMAIN_ID').setValue(this.dataElementMeta.DOMAIN_ID);\n      this.dataElementForm.get('DATA_TYPE').setValue(this.dataElementMeta.DATA_TYPE);\n      this.dataElementForm.get('DATA_LENGTH').setValue(this.dataElementMeta.DATA_LENGTH);\n      this.dataElementForm.get('DECIMAL').setValue(this.dataElementMeta.DECIMAL);\n      this.dataElementForm.get('SEARCH_HELP_ID').setValue(this.dataElementMeta.SEARCH_HELP_ID);\n      this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').setValue(this.dataElementMeta.SEARCH_HELP_EXPORT_FIELD);\n      this.dataElementForm.get('PARAMETER_ID').setValue(this.dataElementMeta.PARAMETER_ID);\n      if (this.dataElementMeta.DOMAIN_ID) {\n        this.dataElementForm.get('USE_DOMAIN').setValue(1);\n        this.dataElementForm.get('DATA_TYPE').disable();\n      } else {\n        this.dataElementForm.get('USE_DOMAIN').setValue(0);\n        this.dataElementForm.get('DATA_TYPE').enable();\n      }\n      if (this.readonly) {\n        this.dataElementForm.get('USE_DOMAIN').disable();\n        this.dataElementForm.get('DOMAIN_ID').disable();\n        this.dataElementForm.get('DATA_TYPE').disable();\n        this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').disable();\n      } else {\n        this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').enable();\n      }\n    } else {\n      this.dataElementForm = this.fb.group({\n        ELEMENT_ID: [this.dataElementMeta.ELEMENT_ID, {updateOn: 'blur'}],\n        ELEMENT_DESC: [this.dataElementMeta.ELEMENT_DESC],\n        LABEL_TEXT: [this.dataElementMeta.LABEL_TEXT],\n        LIST_HEADER_TEXT: [this.dataElementMeta.LIST_HEADER_TEXT],\n        DOMAIN_ID: [this.dataElementMeta.DOMAIN_ID],\n        DATA_TYPE: [{value: this.dataElementMeta.DATA_TYPE, disabled: this.readonly}],\n        DATA_LENGTH: [this.dataElementMeta.DATA_LENGTH, [this._validateDataLength]],\n        DECIMAL: [this.dataElementMeta.DECIMAL, [this._validateDecimal]],\n        SEARCH_HELP_ID: [this.dataElementMeta.SEARCH_HELP_ID],\n        SEARCH_HELP_EXPORT_FIELD: [{value: this.dataElementMeta.SEARCH_HELP_EXPORT_FIELD, disabled: this.readonly}],\n        PARAMETER_ID: [this.dataElementMeta.PARAMETER_ID],\n        USE_DOMAIN: [{value: this.dataElementMeta.DOMAIN_ID ? 1 : 0, disabled: this.readonly}]\n      });\n    }\n    this._setNewModeState();\n    if (this.dataElementForm.get('USE_DOMAIN').value) {\n      this.dataElementForm.get('DOMAIN_ID').setValidators(Validators.required);\n      this.onChangeDataDomain(this.dataElementForm);\n    } else {\n      this.dataElementForm.get('DOMAIN_ID').setErrors(null);\n      this.dataElementForm.get('DOMAIN_ID').clearValidators();\n    }\n    this._updateLengthAndDecimal(this.dataElementForm);\n  }\n\n  _setNewModeState() {\n    if (this.isNewMode) {\n      this.dataElementForm.get('ELEMENT_ID').setValidators(this._validateDataElementID);\n      this.dataElementForm.get('ELEMENT_ID').setAsyncValidators(\n        this.uniqueDataElementValidator.validate.bind(this.uniqueDataElementValidator));\n      this.dataElementForm.get('USE_DOMAIN').enable();\n      this.dataElementForm.get('DATA_TYPE').enable();\n      this.dataElementForm.get('DATA_TYPE').markAsDirty(); // Default value mark as dirty\n      this.dataElementForm.get('DATA_LENGTH').markAsDirty(); // Default value mark as dirty\n    } else {\n      this.dataElementForm.get('ELEMENT_ID').clearValidators();\n      this.dataElementForm.get('ELEMENT_ID').clearAsyncValidators() ;\n      this.dataElementForm.get('ELEMENT_ID').updateValueAndValidity();\n    }\n  }\n\n  _validateDataElementID(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Data Element ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().length > 32) {\n      return {message: 'Data Element ID must have length less than 32!'};\n    }\n    return null;\n  }\n\n  _validateDataLength(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a Length'};\n    }\n    return null;\n  }\n\n  _validateDecimal(c: FormControl) {\n    if (c.enabled && !c.value) {\n      return {message: 'Please give a decimal place'};\n    }\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Data Element?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.dataElementMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.dataElementForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateDataElementForm();\n            this.dataElementForm.reset(this.dataElementForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this._switch2EditMode();\n    }\n\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    this.dataElementForm.get('USE_DOMAIN').disable();\n    this.dataElementForm.get('DATA_TYPE').disable();\n    this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').disable();\n  }\n\n  _switch2EditMode(): void {\n    this.readonly = false;\n    this.dataElementForm.get('USE_DOMAIN').enable();\n    this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').enable();\n    this._setUseDomain(this.dataElementForm);\n  }\n\n  onChangeDataElementID(): void {\n    this.modelService.updateDataElementID(this.dataElementForm.get('ELEMENT_ID').value);\n  }\n\n  onChangeDataElementDesc(): void {\n    this.modelService.updateDataElementDesc(this.dataElementForm.get('ELEMENT_DESC').value);\n  }\n\n  onChangeUseDomain(formGroup: AbstractControl): void {\n    this._setUseDomain(formGroup, true);\n  }\n\n  onChangeDataDomain(formGroup: AbstractControl): void {\n    const dataDomainCtrl = formGroup.get('DOMAIN_ID');\n    this.entityService.getDataDomain(dataDomainCtrl.value).subscribe(data => {\n      if (data['msgCat']) {\n        dataDomainCtrl.setErrors({message: data['msgShortText']});\n      } else {\n        formGroup.get('DATA_TYPE').setValue(data['DATA_TYPE']);\n        formGroup.get('DATA_LENGTH').setValue(data['DATA_LENGTH']);\n        formGroup.get('DECIMAL').setValue(data['DECIMAL']);\n      }\n    });\n  }\n\n  _setUseDomain(formGroup: AbstractControl, markAsDirty: boolean = false): void {\n    if (formGroup.get('USE_DOMAIN').value) {\n      formGroup.get('DOMAIN_ID').enable();\n      formGroup.get('DOMAIN_ID').setValidators(Validators.required);\n      this._invalidField(formGroup.get('DATA_TYPE'), markAsDirty);\n      this._invalidField(formGroup.get('DATA_LENGTH'), markAsDirty);\n      this._invalidField(formGroup.get('DECIMAL'), markAsDirty);\n    } else {\n      this._invalidField(formGroup.get('DOMAIN_ID'), markAsDirty);\n      formGroup.get('DATA_TYPE').enable();\n      formGroup.get('DATA_TYPE').markAsDirty();\n      formGroup.get('DATA_LENGTH').enable();\n      formGroup.get('DATA_LENGTH').markAsDirty();\n      formGroup.get('DECIMAL').enable();\n      formGroup.get('DECIMAL').markAsDirty();\n      if (!formGroup.get('DATA_TYPE').value) {\n        formGroup.get('DATA_TYPE').setValue(1);\n        if (!formGroup.get('DATA_LENGTH').value) {\n          formGroup.get('DATA_LENGTH').setValue(10);\n        }\n      }\n      this._updateLengthAndDecimal(formGroup);\n    }\n  }\n\n  _invalidField(fieldCtrl: AbstractControl, markAsDirty: boolean = false): void {\n    fieldCtrl.clearValidators();\n    fieldCtrl.clearAsyncValidators();\n    fieldCtrl.disable();\n    if (markAsDirty) {\n      fieldCtrl.setValue(null);\n      fieldCtrl.markAsDirty();\n    }\n  }\n\n  onChangeDataType(formGroup: AbstractControl): void {\n    switch (+formGroup.get('DATA_TYPE').value) {\n      case 1: // char\n        formGroup.get('DATA_LENGTH').setValue(10);\n        formGroup.get('DECIMAL').setValue(null);\n        break;\n      case 4: // decimal\n        formGroup.get('DATA_LENGTH').setValue(23);\n        formGroup.get('DECIMAL').setValue(2);\n        break;\n      default:\n        formGroup.get('DATA_LENGTH').setValue(null);\n        formGroup.get('DECIMAL').setValue(null);\n    }\n    formGroup.get('DATA_LENGTH').markAsDirty();\n    formGroup.get('DECIMAL').markAsDirty();\n    this._updateLengthAndDecimal(formGroup);\n  }\n\n  _updateLengthAndDecimal(formGroup: AbstractControl): void {\n    switch (+formGroup.get('DATA_TYPE').value) {\n      case 1: // char\n        formGroup.get('DATA_LENGTH').enable();\n        formGroup.get('DATA_LENGTH').setValidators(this._validateDataLength);\n        formGroup.get('DECIMAL').disable();\n        break;\n      case 4: // decimal\n        formGroup.get('DATA_LENGTH').enable();\n        formGroup.get('DATA_LENGTH').setValidators(this._validateDataLength);\n        formGroup.get('DECIMAL').enable();\n        formGroup.get('DATA_LENGTH').setValidators(this._validateDecimal);\n        break;\n      default:\n        formGroup.get('DATA_LENGTH').disable();\n        formGroup.get('DECIMAL').disable();\n    }\n  }\n\n  onGoToDataDomain(domainID: string): void {\n    this.router.navigate(['/model/data-domain', domainID]);\n  }\n\n  onGoToSearchHelp(searchHelpID: string): void {\n    this.router.navigate(['/model/search-help', searchHelpID]);\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.dataElementForm && this.dataElementForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.dataElementForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (this.dataElementForm.invalid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedDataElement['action'] = 'add';\n      this.changedDataElement['ELEMENT_ID'] = this.dataElementForm.get('ELEMENT_ID').value;\n    } else {\n      this.changedDataElement['action'] = 'update';\n      this.changedDataElement['ELEMENT_ID'] = this.dataElementMeta.ELEMENT_ID;\n    }\n    if (this.dataElementForm.get('ELEMENT_DESC').dirty) {\n      this.changedDataElement['ELEMENT_DESC'] = this.dataElementForm.get('ELEMENT_DESC').value;\n    }\n    if (this.dataElementForm.get('DOMAIN_ID').dirty) {\n      this.changedDataElement['DOMAIN_ID'] = this.dataElementForm.get('DOMAIN_ID').value;\n    }\n    if (this.dataElementForm.get('DATA_TYPE').dirty) {\n      this.changedDataElement['DATA_TYPE'] = this.dataElementForm.get('USE_DOMAIN').value ?\n        null : this.dataElementForm.get('DATA_TYPE').value;\n    }\n    if (this.dataElementForm.get('DATA_LENGTH').dirty) {\n      this.changedDataElement['DATA_LENGTH'] = this.dataElementForm.get('USE_DOMAIN').value ?\n        null : this.dataElementForm.get('DATA_LENGTH').value;\n    }\n    if (this.dataElementForm.get('DECIMAL').dirty) {\n      this.changedDataElement['DECIMAL'] = this.dataElementForm.get('USE_DOMAIN').value ?\n        null : this.dataElementForm.get('DECIMAL').value;\n    }\n    if (this.dataElementForm.get('LABEL_TEXT').dirty) {\n      this.changedDataElement['LABEL_TEXT'] = this.dataElementForm.get('LABEL_TEXT').value;\n    }\n    if (this.dataElementForm.get('LIST_HEADER_TEXT').dirty) {\n      this.changedDataElement['LIST_HEADER_TEXT'] = this.dataElementForm.get('LIST_HEADER_TEXT').value;\n    }\n    if (this.dataElementForm.get('SEARCH_HELP_ID').dirty) {\n      this.changedDataElement['SEARCH_HELP_ID'] = this.dataElementForm.get('SEARCH_HELP_ID').value;\n    }\n    if (this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').dirty) {\n      this.changedDataElement['SEARCH_HELP_EXPORT_FIELD'] = this.dataElementForm.get('SEARCH_HELP_EXPORT_FIELD').value;\n    }\n    if (this.dataElementForm.get('PARAMETER_ID').dirty) {\n      this.changedDataElement['PARAMETER_ID'] = this.dataElementForm.get('PARAMETER_ID').value;\n    }\n    this.entityService.saveDataElement(this.changedDataElement)\n      .subscribe(data => this._postActivityAfterSavingDataElement(data));\n  }\n\n  _postActivityAfterSavingDataElement(data: any) {\n    this.changedDataElement = {};\n    if (data['ELEMENT_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/data-element/' + data['ELEMENT_ID']],\n          {state: {message: this.messageService.generateMessage(\n            'MODEL', 'DATA_ELEMENT_SAVED', 'S', data['ELEMENT_ID'])}});\n      } else {\n        this._switch2DisplayMode();\n        this.dataElementMeta = data;\n        this._generateDataElementForm();\n        this.messageService.reportMessage(\n          'MODEL', 'DATA_ELEMENT_SAVED', 'S', data['ELEMENT_ID']);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { RoleH} from 'jor-angular';\nimport {Subject} from 'rxjs';\nimport {EntityService} from 'jor-angular';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-role',\n  templateUrl: './role.component.html',\n  styleUrls: ['./role.component.css']\n})\nexport class RoleComponent implements OnInit {\n  roleList: RoleH[];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedRole: RoleH;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listRole(term)),\n    ).subscribe(data => {\n      this.roleList = data;\n      let roleID;\n      if (this.route.snapshot.firstChild) {\n        roleID = this.route.snapshot.firstChild.paramMap.get('roleID');\n      }\n      if (roleID ) {\n        if (roleID === 'new') {\n          this._newRole();\n        } else {\n          this.onSelect(this.roleList.find(role => role.ROLE_ID === roleID ));\n        }\n      }\n    });\n    this.searchRole(''); // The initial list\n\n    this.modelService.theSelectedRole$.subscribe( data => {\n      if (this.theSelectedRole) {\n        this.theSelectedRole.ROLE_ID = data['ROLE_ID'];\n        this.theSelectedRole.ROLE_DESC = data['ROLE_DESC'];\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.roleList[0] && !this.roleList[0].CREATE_TIME) {\n        this.roleList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const roleID = this.route.snapshot.firstChild.paramMap.get('roleID');\n        if (roleID) {\n          if (roleID === 'new') {\n            this.onSelect(this.roleList[0]);\n          } else {\n            this.onSelect(this.roleList.find(role => role.ROLE_ID === roleID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  onSelect(role: RoleH): void {\n    if (role) {\n      this.theSelectedRole = role;\n      this.modelService.setSelectedRole(role);\n    }\n  }\n\n  searchRole(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  newRole(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('roleID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newRole();\n      this.router.navigate(['/model/role/new']);\n    }\n  }\n\n  _newRole(): void {\n    this.theSelectedRole = new RoleH();\n    this.theSelectedRole.ROLE_ID = 'new';\n    this.theSelectedRole.ROLE_DESC = 'description';\n    this.theSelectedRole.VERSION_NO = 1;\n    this.theSelectedRole.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedRole.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedRole(this.theSelectedRole);\n    this.roleList.splice(0, 0, this.theSelectedRole);\n  }\n\n}\n","export default \"<div class=\\\"btn-toolbar mb-2\\\"  role=\\\"toolbar\\\"\\n     [ngClass]=\\\"{'justify-content-end': isSearchListShown, 'justify-content-between': !isSearchListShown}\\\" >\\n  <button *ngIf=\\\"!isSearchListShown\\\" class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Show List\\\" (click)=\\\"showSearchList()\\\">\\n    <span class=\\\"fas fa-arrow-right\\\"></span>\\n  </button>\\n\\n  <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Edit/Display\\\" (click)=\\\"switchEditDisplay()\\\">\\n      <span *ngIf=\\\"readonly\\\" class=\\\"fas fa-edit\\\"></span>\\n      <span *ngIf=\\\"!readonly\\\" class=\\\"fas fa-glasses\\\"></span>\\n    </button>\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Save\\\" (click)=\\\"save()\\\">\\n      <span class=\\\"fas fa-save\\\"></span>\\n    </button>\\n  </div>\\n</div>\\n\\n<dk-message></dk-message>\\n<form *ngIf=\\\"roleMeta\\\" [formGroup]=\\\"roleForm\\\">\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"role\\\" class=\\\"col-form-label form-control-sm\\\">Role:\\n      <span [class.ng-invalid]=\\\"roleForm.get('ROLE_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n        {{roleForm.get('ROLE_ID').errors?.message}}\\n      </span>\\n    </label>\\n    <input type=\\\"text\\\" class=\\\"form-control form-control-sm\\\" id=\\\"role\\\" [readonly]=\\\"readonly || !isNewMode\\\"\\n           name=\\\"role\\\" formControlName=\\\"ROLE_ID\\\">\\n  </div>\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"role-desc\\\" class=\\\"col-form-label form-control-sm\\\">Role Description:</label>\\n    <textarea class=\\\"form-control\\\" id=\\\"role-desc\\\" name=\\\"role-desc\\\" rows=\\\"2\\\"\\n              formControlName=\\\"ROLE_DESC\\\" [readonly]=\\\"readonly\\\" (change)=\\\"onChangeRoleDesc()\\\"></textarea>\\n  </div>\\n\\n  <div class=\\\"card mt-2\\\">\\n    <div class=\\\"card-header\\\"><span class=\\\"fas fa-user-check\\\"></span> Relation</div>\\n    <div class=\\\"card-body\\\">\\n      <table class=\\\"table table-bordered table-sm\\\">\\n        <thead class=\\\"thead-light\\\">\\n        <tr>\\n          <th scope=\\\"col\\\">Action</th>\\n          <th scope=\\\"col\\\">Relation</th>\\n          <th scope=\\\"col\\\">Description</th>\\n          <th scope=\\\"col\\\">Cardinality</th>\\n        </tr>\\n        </thead>\\n\\n        <tbody formArrayName=\\\"RELATIONS\\\">\\n        <tr *ngFor=\\\"let relationFormGroup of relationFormArray.controls; let i = index\\\">\\n          <td class=\\\"dk-actions\\\">\\n            <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" [disabled]=\\\"readonly\\\" (click)=\\\"deleteRelation(i)\\\" title=\\\"Delete\\\">\\n              <span class=\\\"far fa-trash-alt\\\"></span>\\n            </button>\\n          </td>\\n          <td [formGroup]=\\\"relationFormGroup\\\">\\n            <div class=\\\"input-group\\\">\\n              <input class=\\\"form-control form-control-sm\\\" type=\\\"text\\\" formControlName=\\\"RELATION_ID\\\"\\n                     [readonly]=\\\"readonly || oldRelation(relationFormGroup) && relationFormGroup.valid\\\" (change)=\\\"onChangeRelationID(i)\\\"\\n                     (dblclick)=\\\"onGoToRelation(relationFormGroup.value['RELATION_ID'])\\\">\\n              <div class=\\\"invalid-tooltip\\\">\\n                {{relationFormGroup.get('RELATION_ID').errors?.message}}\\n              </div>\\n              <div class=\\\"input-group-append\\\">\\n                <button class=\\\"btn btn-outline-secondary btn-sm\\\" type=\\\"button\\\" id=\\\"searchRelation\\\"\\n                        (click)=\\\"onSearchHelp(relationFormGroup, i)\\\">\\n                  <span class=\\\"fas fa-search\\\"></span>\\n                </button>\\n              </div>\\n            </div>\\n          </td>\\n          <td [formGroup]=\\\"relationFormGroup\\\">\\n            <input type=\\\"text\\\" formControlName=\\\"RELATION_DESC\\\" readonly class=\\\"form-control form-control-sm dk-description\\\">\\n          </td>\\n          <td [formGroup]=\\\"relationFormGroup\\\">\\n            <select class=\\\"form-control form-control-sm\\\" formControlName=\\\"CARDINALITY\\\">\\n              <option>[0..1]</option>\\n              <option>[1..1]</option>\\n              <option>[0..n]</option>\\n              <option>[1..n]</option>\\n            </select>\\n          </td>\\n        </tr>\\n        </tbody>\\n      </table>\\n    </div>\\n  </div>\\n</form>\\n\\n<dk-app-search-help></dk-app-search-help>\\n\";","import { Component, OnInit } from '@angular/core';\nimport {EntityService} from 'jor-angular';\nimport {EntityType} from 'jor-angular';\nimport { debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {Subject} from 'rxjs';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-entity-type',\n  templateUrl: './entity-type.component.html',\n  styleUrls: ['./entity-type.component.css']\n})\nexport class EntityTypeComponent implements OnInit {\n  entityTypeList: EntityType[];\n  isSearchListShown = true;\n\n  private searchTerms = new Subject<string>();\n  private theSelectedEntityType: EntityType;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listEntityType(term)),\n    ).subscribe(data => {\n      this.entityTypeList = data;\n      let entityID;\n      if (this.route.snapshot.firstChild) {\n        entityID = this.route.snapshot.firstChild.paramMap.get('entityID');\n      }\n      if (entityID ) {\n        if (entityID === 'new') {\n          this._newEntityType();\n        } else {\n          this.onSelect(this.entityTypeList.find(entityType => entityType.ENTITY_ID === entityID));\n        }\n      }\n    });\n    this.searchEntityType(''); // The initial list\n\n    this.modelService.theSelectedEntityType$.subscribe( data => {\n      if (this.theSelectedEntityType) {\n        this.theSelectedEntityType.ENTITY_ID = data.ENTITY_ID;\n        this.theSelectedEntityType.ENTITY_DESC = data.ENTITY_DESC;\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.entityTypeList[0] && !this.entityTypeList[0].CREATE_TIME) {\n        this.entityTypeList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const entityID = this.route.snapshot.firstChild.paramMap.get('entityID');\n        if (entityID) {\n          if (entityID === 'new') {\n            this.onSelect(this.entityTypeList[0]);\n          } else {\n            this.onSelect(this.entityTypeList.find(entityType => entityType.ENTITY_ID === entityID));\n          }\n        }\n      }\n    });\n  }\n\n  onSelect(entityType: EntityType): void {\n    if (entityType) {\n      this.theSelectedEntityType = entityType;\n      this.modelService.setSelectedEntityType(entityType);\n    }\n  }\n\n  searchEntityType(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  newEntityType(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('entityID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newEntityType();\n      this.router.navigate(['/model/entity-type/new']);\n    }\n  }\n\n  _newEntityType(): void {\n    this.theSelectedEntityType = new EntityType();\n    this.theSelectedEntityType.ENTITY_ID = 'new';\n    this.theSelectedEntityType.ENTITY_DESC = 'description';\n    this.theSelectedEntityType.VERSION_NO = 1;\n    this.theSelectedEntityType.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedEntityType.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedEntityType(this.theSelectedEntityType);\n    this.entityTypeList.splice(0, 0, this.theSelectedEntityType);\n  }\n}\n","export default \".dk-actions{\\n  width: 5rem;\\n  min-width: 5rem;\\n  max-width: 5rem;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbW9kZWwvcmVsYXRpb24vcmVsYXRpb24tZGV0YWlsL3JlbGF0aW9uLWRldGFpbC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBVztFQUNYLGVBQWU7RUFDZixlQUFlO0FBQ2pCIiwiZmlsZSI6InNyYy9hcHAvbW9kZWwvcmVsYXRpb24vcmVsYXRpb24tZGV0YWlsL3JlbGF0aW9uLWRldGFpbC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmRrLWFjdGlvbnN7XG4gIHdpZHRoOiA1cmVtO1xuICBtaW4td2lkdGg6IDVyZW07XG4gIG1heC13aWR0aDogNXJlbTtcbn1cbiJdfQ== */\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL3JvbGUvcm9sZS1kZXRhaWwvcm9sZS1kZXRhaWwuY29tcG9uZW50LmNzcyJ9 */\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL3JvbGUvcm9sZS5jb21wb25lbnQuY3NzIn0= */\";","export default \".dk-model-content {\\n  margin-top: .5rem;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbW9kZWwvbW9kZWwuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGlCQUFpQjtBQUNuQiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL21vZGVsLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuZGstbW9kZWwtY29udGVudCB7XG4gIG1hcmdpbi10b3A6IC41cmVtO1xufVxuIl19 */\";","export default \"<div class=\\\"btn-toolbar mb-2\\\"  role=\\\"toolbar\\\"\\n     [ngClass]=\\\"{'justify-content-end': isSearchListShown, 'justify-content-between': !isSearchListShown}\\\" >\\n  <button *ngIf=\\\"!isSearchListShown\\\" class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Show List\\\" (click)=\\\"showSearchList()\\\">\\n    <span class=\\\"fas fa-arrow-right\\\"></span>\\n  </button>\\n\\n  <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Edit/Display\\\" (click)=\\\"switchEditDisplay()\\\">\\n      <span *ngIf=\\\"readonly\\\" class=\\\"fas fa-edit\\\"></span>\\n      <span *ngIf=\\\"!readonly\\\" class=\\\"fas fa-glasses\\\"></span>\\n    </button>\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Save\\\" (click)=\\\"save()\\\">\\n      <span class=\\\"fas fa-save\\\"></span>\\n    </button>\\n  </div>\\n</div>\\n\\n<dk-message></dk-message>\\n<form *ngIf=\\\"dataDomainMeta\\\" [formGroup]=\\\"dataDomainForm\\\">\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"dataDomain\\\" class=\\\"col-form-label form-control-sm\\\">Data Domain:\\n      <span [class.ng-invalid]=\\\"dataDomainForm.get('DOMAIN_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n        {{dataDomainForm.get('DOMAIN_ID').errors?.message}}\\n      </span>\\n    </label>\\n    <input type=\\\"text\\\" class=\\\"form-control form-control-sm\\\" id=\\\"dataDomain\\\" [readonly]=\\\"readonly || !isNewMode\\\"\\n           (change)=\\\"onChangeDataDomainID()\\\" name=\\\"dataDomain\\\" formControlName=\\\"DOMAIN_ID\\\">\\n  </div>\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"dataDomain-desc\\\" class=\\\"col-form-label form-control-sm\\\">Data Domain Description:</label>\\n    <textarea class=\\\"form-control\\\" id=\\\"dataDomain-desc\\\" name=\\\"dataDomain-desc\\\" rows=\\\"2\\\"\\n              formControlName=\\\"DOMAIN_DESC\\\" [readonly]=\\\"readonly\\\" (change)=\\\"onChangeDataDomainDesc()\\\"></textarea>\\n  </div>\\n\\n\\n  <div class=\\\"card mt-2\\\">\\n    <div class=\\\"card-header\\\">Data Type</div>\\n    <div class=\\\"card-body\\\">\\n      <div class=\\\"ml-2 mb-2 row\\\">\\n        <select formControlName=\\\"DATA_TYPE\\\" (change)=\\\"onChangeDataType(dataDomainForm)\\\"\\n                class=\\\"col-sm-8 col-lg-4 form-control form-control-sm\\\">\\n          <option *ngFor=\\\"let opt of dataTypes\\\" [value]=\\\"opt.key\\\">{{opt.value}}</option>\\n        </select>\\n      </div>\\n\\n      <div class=\\\"ml-0 row\\\">\\n        <div class=\\\"form-group col-8 col-sm-4 col-lg-2\\\">\\n          <label class=\\\"col-form-label col-form-label-sm\\\" for=\\\"data-length\\\">Length:\\n          </label>\\n          <input type=\\\"number\\\" formControlName=\\\"DATA_LENGTH\\\" id=\\\"data-length\\\" name=\\\"data-length\\\"\\n                 class=\\\"form-control form-control-sm\\\" [readonly]=\\\"readonly\\\" >\\n          <span class=\\\"dk-invalid-feedback\\\">{{dataDomainForm.get('DATA_LENGTH').errors?.message}}</span>\\n        </div>\\n\\n        <div class=\\\"form-group col-8 col-sm-4 col-lg-2\\\">\\n          <label class=\\\"col-form-label col-form-label-sm\\\" for=\\\"decimal-place\\\">Decimal Place:\\n          </label>\\n          <input type=\\\"number\\\" formControlName=\\\"DECIMAL\\\" id=\\\"decimal-place\\\" name=\\\"decimal-place\\\"\\n                 class=\\\"form-control form-control-sm\\\" [readonly]=\\\"readonly\\\">\\n          <span class=\\\"dk-invalid-feedback\\\">{{dataDomainForm.get('DECIMAL').errors?.message}}</span>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"card mt-3\\\">\\n    <div class=\\\"card-header\\\">Domain Definition</div>\\n    <div class=\\\"card-body\\\">\\n      <div *ngIf=\\\"enableGeneralType\\\" class=\\\"card mb-3\\\">\\n        <div class=\\\"ml-2 mt-2 custom-control custom-radio\\\">\\n          <input type=\\\"radio\\\" class=\\\"custom-control-input\\\" id=\\\"general-type\\\" name=\\\"DOMAIN_TYPE\\\"\\n                 [value]=\\\"0\\\" formControlName=\\\"DOMAIN_TYPE\\\" (change)=\\\"onChangeDomainType(dataDomainForm)\\\">\\n          <label class=\\\"custom-control-label\\\" for=\\\"general-type\\\">General Type</label>\\n        </div>\\n        <div class=\\\"card-body row\\\">\\n          <div class=\\\"form-check col-sm-3 mx-3\\\">\\n            <input type=\\\"checkbox\\\" class=\\\"form-check-input\\\" formControlName=\\\"UNSIGNED\\\" id=\\\"unsigned\\\" name=\\\"unsigned\\\">\\n            <label class=\\\"form-check-label\\\" for=\\\"unsigned\\\">Unsigned</label>\\n          </div>\\n          <div class=\\\"form-check col-sm-3 mx-3\\\">\\n            <input type=\\\"checkbox\\\" class=\\\"form-check-input\\\" formControlName=\\\"CAPITAL_ONLY\\\" id=\\\"CAPITAL_ONLY\\\" name=\\\"CAPITAL_ONLY\\\">\\n            <label class=\\\"form-check-label\\\" for=\\\"CAPITAL_ONLY\\\">Capital Only</label>\\n          </div>\\n        </div>\\n      </div>\\n\\n      <div *ngIf=\\\"enableRegExpr\\\" class=\\\"card mb-3\\\">\\n        <div class=\\\"ml-2 mt-2 custom-control custom-radio\\\">\\n          <input type=\\\"radio\\\" class=\\\"custom-control-input\\\" id=\\\"regular-expression\\\" name=\\\"DOMAIN_TYPE\\\"\\n                 [value]=\\\"1\\\" formControlName=\\\"DOMAIN_TYPE\\\" (change)=\\\"onChangeDomainType(dataDomainForm)\\\">\\n          <label class=\\\"custom-control-label\\\" for=\\\"regular-expression\\\">Regular Expression\\n            <span [class.ng-invalid]=\\\"dataDomainForm.get('REG_EXPR').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n              {{dataDomainForm.get('REG_EXPR').errors?.message}}\\n            </span>\\n          </label>\\n        </div>\\n        <div class=\\\"card-body\\\">\\n          <div class=\\\"form-group\\\">\\n            <input type=\\\"text\\\" formControlName=\\\"REG_EXPR\\\" id=\\\"REG_EXPR\\\" name=\\\"REG_EXPR\\\"\\n                   class=\\\"form-control form-control-sm\\\" [readonly]=\\\"readonly\\\" >\\n          </div>\\n        </div>\\n      </div>\\n\\n      <div *ngIf=\\\"enableValueRelation\\\" class=\\\"card mb-2\\\">\\n        <div class=\\\"ml-2 mt-2 custom-control custom-radio\\\">\\n          <input type=\\\"radio\\\" class=\\\"custom-control-input\\\" id=\\\"value-relation\\\" name=\\\"DOMAIN_TYPE\\\"\\n                 [value]=\\\"2\\\" formControlName=\\\"DOMAIN_TYPE\\\" (change)=\\\"onChangeDomainType(dataDomainForm)\\\">\\n          <label class=\\\"custom-control-label\\\" for=\\\"value-relation\\\">Value Entity Relation\\n            <span [class.ng-invalid]=\\\"dataDomainForm.get('ENTITY_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n              {{dataDomainForm.get('ENTITY_ID').errors?.message}}\\n            </span>\\n          </label>\\n        </div>\\n        <div class=\\\"card-body row\\\">\\n          <div class=\\\"input-group col-lg-4 ml-2 mb-3\\\">\\n            <input type=\\\"text\\\" formControlName=\\\"ENTITY_ID\\\" id=\\\"ENTITY_ID\\\" name=\\\"ENTITY_ID\\\" placeholder=\\\"Entity Type\\\"\\n                   class=\\\"form-control form-control-sm\\\" [readonly]=\\\"readonly\\\" (change)=\\\"onChangeEntityID(dataDomainForm)\\\">\\n            <div class=\\\"input-group-append\\\">\\n              <button class=\\\"btn btn-outline-secondary btn-sm\\\" type=\\\"button\\\" id=\\\"searchEntity\\\" (click)=\\\"onEntitySearchHelp(dataDomainForm)\\\">\\n                <span class=\\\"fas fa-search\\\"></span>\\n              </button>\\n            </div>\\n          </div>\\n          <select formControlName=\\\"RELATION_ID\\\" class=\\\"form-control form-control-sm col-lg-4 ml-4 mr-3\\\">\\n            <option *ngFor=\\\"let relation of relationsOfEntity\\\" [value]=\\\"relation\\\">{{relation}}</option>\\n          </select>\\n        </div>\\n      </div>\\n\\n      <div *ngIf=\\\"enableArrayOrInterval\\\" class=\\\"card mb-3\\\">\\n        <div class=\\\"ml-2 mt-2 row\\\">\\n          <div class=\\\"custom-control custom-radio col-3\\\">\\n            <input type=\\\"radio\\\" class=\\\"custom-control-input\\\" id=\\\"value-array\\\" name=\\\"DOMAIN_TYPE\\\"\\n                   [value]=\\\"3\\\" formControlName=\\\"DOMAIN_TYPE\\\" (change)=\\\"onChangeDomainType(dataDomainForm)\\\">\\n            <label class=\\\"custom-control-label\\\" for=\\\"value-array\\\">Value Array</label>\\n          </div>\\n          <div class=\\\"custom-control custom-radio col-3\\\">\\n            <input type=\\\"radio\\\" class=\\\"custom-control-input\\\" id=\\\"value-interval\\\" name=\\\"DOMAIN_TYPE\\\"\\n                   [value]=\\\"4\\\" formControlName=\\\"DOMAIN_TYPE\\\" (change)=\\\"onChangeDomainType(dataDomainForm)\\\">\\n            <label class=\\\"custom-control-label\\\" for=\\\"value-interval\\\">Value Interval</label>\\n          </div>\\n        </div>\\n\\n        <div class=\\\"card-body\\\">\\n          <table class=\\\"table table-bordered dk-table\\\">\\n            <thead class=\\\"thead-light\\\">\\n              <tr>\\n                <th scope=\\\"col\\\">Low Value</th>\\n                <th *ngIf=\\\"dataDomainForm.get('DOMAIN_TYPE').value === 4\\\" scope=\\\"col\\\">High Value</th>\\n                <th scope=\\\"col\\\">Description</th>\\n                <th scope=\\\"col\\\">Actions</th>\\n              </tr>\\n            </thead>\\n\\n            <tbody formArrayName=\\\"DOMAIN_VALUES\\\">\\n            <tr *ngFor=\\\"let domainValueForm of domainValueFormArray.controls; let i = index\\\">\\n              <td [formGroup]=\\\"domainValueForm\\\">\\n                <div class=\\\"input-group\\\">\\n                  <input class=\\\"form-control\\\" type=\\\"text\\\" formControlName=\\\"LOW_VALUE\\\" maxlength=\\\"10\\\"\\n                         [readonly]=\\\"readonly\\\" (change)=\\\"onChangeDomainValue(i)\\\">\\n                  <div class=\\\"invalid-tooltip\\\">\\n                    {{domainValueForm.get('LOW_VALUE').errors?.message}}\\n                  </div>\\n                </div>\\n              </td>\\n              <td *ngIf=\\\"dataDomainForm.get('DOMAIN_TYPE').value === 4\\\" [formGroup]=\\\"domainValueForm\\\">\\n                <div class=\\\"input-group\\\">\\n                  <input class=\\\"form-control\\\" type=\\\"text\\\" formControlName=\\\"HIGH_VALUE\\\"\\n                         [readonly]=\\\"readonly\\\"  (change)=\\\"onChangeDomainValue(i)\\\">\\n                  <div class=\\\"invalid-tooltip\\\">\\n                    {{domainValueForm.get('HIGH_VALUE').errors?.message}}\\n                  </div>\\n                </div>\\n              </td>\\n              <td [formGroup]=\\\"domainValueForm\\\" class=\\\"dk-description\\\">\\n                <input  class=\\\"form-control\\\" type=\\\"text\\\" formControlName=\\\"LOW_VALUE_TEXT\\\" maxlength=\\\"100\\\"\\n                        [readonly]=\\\"readonly\\\">\\n              </td>\\n              <td class=\\\"dk-actions\\\">\\n                <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" [disabled]=\\\"readonly\\\" (click)=\\\"insertDomainValue(i)\\\" title=\\\"Insert\\\">\\n                  <span class=\\\"fas fa-plus\\\"></span>\\n                </button>\\n                <button class=\\\"btn btn-sm\\\" type=\\\"button\\\" [disabled]=\\\"readonly\\\" (click)=\\\"deleteDomainValue(i)\\\" title=\\\"Delete\\\">\\n                  <span class=\\\"far fa-trash-alt\\\"></span>\\n                </button>\\n              </td>\\n            </tr>\\n            </tbody>\\n          </table>\\n        </div>\\n      </div>\\n\\n    </div>\\n  </div>\\n</form>\\n\\n<dk-app-search-help></dk-app-search-help>\\n\";","export default \"<div class=\\\"row\\\">\\n  <div *ngIf=\\\"isSearchListShown\\\" class=\\\"col-3\\\">\\n    <div class=\\\"btn-toolbar justify-content-between mb-2\\\" role=\\\"toolbar\\\">\\n      <div class=\\\"input-group\\\">\\n        <input type=\\\"text\\\" class=\\\"form-control\\\" placeholder=\\\"Search\\\" #searchBox (keyup)=\\\"searchRelationship(searchBox.value)\\\" >\\n      </div>\\n\\n      <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Hide\\\" (click)=\\\"hideSearchList()\\\" [disabled]=\\\"!theSelectedRelationship\\\">\\n          <span class=\\\"fas fa-arrow-left\\\"></span>\\n        </button>\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Add\\\" (click)=\\\"newRelationship()\\\">\\n          <span class=\\\"fas fa-plus\\\"></span>\\n        </button>\\n      </div>\\n    </div>\\n    <div class=\\\"list-group\\\">\\n      <a *ngFor=\\\"let relationship of relationshipList\\\" routerLink=\\\"/model/relationship/{{relationship.RELATIONSHIP_ID}}\\\" routerLinkActive=\\\"active\\\"\\n         (click)=\\\"onSelect(relationship)\\\" class=\\\"list-group-item list-group-item-action flex-column align-items-start\\\">\\n        <div class=\\\"d-flex w-100 justify-content-between\\\">\\n          <h5 class=\\\"mb-1\\\">{{relationship.RELATIONSHIP_ID}}</h5>\\n          <small>version: {{relationship.VERSION_NO}}</small>\\n        </div>\\n        <p class=\\\"mb-1\\\">{{relationship.RELATIONSHIP_DESC}}</p>\\n        <!--<small>created by: {{entityType.CREATE_BY}} @{{entityType.CREATE_TIME}}</small> <br/>-->\\n        <small>last changed by: {{relationship.LAST_CHANGE_BY}} @{{relationship.LAST_CHANGE_TIME}}</small>\\n      </a>\\n    </div>\\n  </div>\\n  <div [ngClass]=\\\"{'col-9': isSearchListShown, 'col-12': !isSearchListShown}\\\">\\n    <router-outlet></router-outlet>\\n  </div>\\n</div>\\n\";","export default \".dk-table {\\n  display: block;\\n  overflow-x: auto;\\n  white-space: nowrap;\\n  border: none;\\n}\\n.dk-actions{\\n  width: 4rem;\\n  min-width: 4rem;\\n  max-width: 4rem;\\n}\\n.dk-description{\\n  width: 20rem;\\n  min-width: 20rem;\\n  max-width: 20rem;\\n}\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbW9kZWwvZGF0YS1kb21haW4vZGF0YS1kb21haW4tZGV0YWlsL2RhdGEtZG9tYWluLWRldGFpbC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsY0FBYztFQUNkLGdCQUFnQjtFQUNoQixtQkFBbUI7RUFDbkIsWUFBWTtBQUNkO0FBQ0E7RUFDRSxXQUFXO0VBQ1gsZUFBZTtFQUNmLGVBQWU7QUFDakI7QUFDQTtFQUNFLFlBQVk7RUFDWixnQkFBZ0I7RUFDaEIsZ0JBQWdCO0FBQ2xCIiwiZmlsZSI6InNyYy9hcHAvbW9kZWwvZGF0YS1kb21haW4vZGF0YS1kb21haW4tZGV0YWlsL2RhdGEtZG9tYWluLWRldGFpbC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmRrLXRhYmxlIHtcbiAgZGlzcGxheTogYmxvY2s7XG4gIG92ZXJmbG93LXg6IGF1dG87XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gIGJvcmRlcjogbm9uZTtcbn1cbi5kay1hY3Rpb25ze1xuICB3aWR0aDogNHJlbTtcbiAgbWluLXdpZHRoOiA0cmVtO1xuICBtYXgtd2lkdGg6IDRyZW07XG59XG4uZGstZGVzY3JpcHRpb257XG4gIHdpZHRoOiAyMHJlbTtcbiAgbWluLXdpZHRoOiAyMHJlbTtcbiAgbWF4LXdpZHRoOiAyMHJlbTtcbn1cbiJdfQ== */\";","import { Component, OnInit } from '@angular/core';\nimport {EntityService, SearchHelpH, SearchHelpMeta} from 'jor-angular';\nimport {Subject} from 'rxjs';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-search-help',\n  templateUrl: './search-help.component.html',\n  styleUrls: ['./search-help.component.css']\n})\nexport class SearchHelpComponent implements OnInit {\n\n  searchHelpList: SearchHelpH[] = [];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedSearchHelp: SearchHelpH;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listSearchHelp(term)),\n    ).subscribe(data => {\n      this.searchHelpList = data;\n      let searchHelpID;\n      if (this.route.snapshot.firstChild) {\n        searchHelpID = this.route.snapshot.firstChild.paramMap.get('searchHelpID');\n      }\n      if (searchHelpID ) {\n        if (searchHelpID === 'new') {\n          this._newSearchHelp();\n        } else {\n          this.onSelect(this.searchHelpList.find(searchHelp => searchHelp.SEARCH_HELP_ID === searchHelpID));\n        }\n      }\n    });\n    this.searchSearchHelp(''); // The initial list\n\n    this.modelService.theSelectedSearchHelp$.subscribe( data => {\n      if (this.theSelectedSearchHelp) {\n        this.theSelectedSearchHelp.SEARCH_HELP_ID = data['SEARCH_HELP_ID'];\n        this.theSelectedSearchHelp.SEARCH_HELP_DESC = data['SEARCH_HELP_DESC'];\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.searchHelpList[0] && !this.searchHelpList[0].CREATE_TIME) {\n        this.searchHelpList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const searchHelpID = this.route.snapshot.firstChild.paramMap.get('searchHelpID');\n        if (searchHelpID) {\n          if (searchHelpID === 'new') {\n            this.onSelect(this.searchHelpList[0]);\n          } else {\n            this.onSelect(this.searchHelpList.find(searchHelp => searchHelp.SEARCH_HELP_ID === searchHelpID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  onSelect(searchHelp: SearchHelpH): void {\n    if (searchHelp) {\n      this.theSelectedSearchHelp = searchHelp;\n      this.modelService.setSelectedSearchHelp(searchHelp);\n    }\n  }\n\n  searchSearchHelp(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  newSearchHelp(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('searchHelpID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newSearchHelp();\n      this.router.navigate(['/model/search-help/new']);\n    }\n  }\n\n  _newSearchHelp(): void {\n    this.theSelectedSearchHelp = new SearchHelpMeta();\n    this.theSelectedSearchHelp.SEARCH_HELP_ID = 'new';\n    this.theSelectedSearchHelp.SEARCH_HELP_DESC = 'description';\n    this.theSelectedSearchHelp.VERSION_NO = 1;\n    this.theSelectedSearchHelp.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedSearchHelp.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedSearchHelp(this.theSelectedSearchHelp);\n    this.searchHelpList.splice(0, 0, this.theSelectedSearchHelp);\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport {AbstractControl, AsyncValidator, ValidationErrors} from '@angular/forms';\nimport {EntityService} from 'jor-angular';\nimport {Observable, of} from 'rxjs';\nimport {catchError, map} from 'rxjs/operators';\nimport {ModelService} from './model.service';\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueSearchHelpValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    return this.entityService.getSearchHelpDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'SEARCH_HELP_NOT_EXIST') {\n          this.modelService.updateSearchHelpID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueDataDomainValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    return this.entityService.getDataDomainDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'DATA_DOMAIN_NOT_EXIST') {\n          this.modelService.updateDataDomainID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueDataElementValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    return this.entityService.getDataElementDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'DATA_ELEMENT_NOT_EXIST') {\n          this.modelService.updateDataElementID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueRoleValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    return this.entityService.getRoleDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'ROLE_NOT_EXIST') {\n          this.modelService.updateRoleID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueRelationValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    if (ctrl.value === 'r_') { return of(null); }\n    return this.entityService.getRelationDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'RELATION_NOT_EXIST') {\n          this.modelService.updateRelationID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueRelationshipValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    if (ctrl.value === 'rs_') { return of(null); }\n    return this.entityService.getRelationshipDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'RELATIONSHIP_NOT_EXIST') {\n          this.modelService.updateRelationshipID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n\n// noinspection JSAnnotator\n@Injectable({\n  providedIn: 'root'\n})\nexport class UniqueEntityTypeValidator implements AsyncValidator {\n  constructor(private entityService: EntityService,\n              private modelService: ModelService) {}\n\n  validate(\n    ctrl: AbstractControl\n  ): Promise<ValidationErrors | null> | Observable<ValidationErrors | null> {\n    return this.entityService.getEntityTypeDesc(ctrl.value).pipe(\n      map(data => {\n        if (data['msgName'] && data['msgName'] === 'ENTITY_TYPE_NOT_EXIST') {\n          this.modelService.updateEntityID(ctrl.value);\n          return null;\n        } else {\n          return { message: '\"' + ctrl.value + '\" already exists' };\n        }\n      }),\n      catchError(() => null)\n    );\n  }\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL2RhdGEtZWxlbWVudC9kYXRhLWVsZW1lbnQtZGV0YWlsL2RhdGEtZWxlbWVudC1kZXRhaWwuY29tcG9uZW50LmNzcyJ9 */\";","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {Association, RelationMeta} from 'jor-angular';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {EntityService} from 'jor-angular';\nimport {msgStore} from '../../../msgStore';\nimport {switchMap} from 'rxjs/operators';\nimport {Observable, of} from 'rxjs';\nimport {AttributeMetaComponent} from '../../attribute-meta/attribute-meta.component';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {UniqueRelationValidator} from '../../model-validators';\nimport {SearchHelpComponent} from 'jor-angular';\nimport {SearchHelp, SearchHelpMethod} from 'jor-angular';\n\n@Component({\n  selector: 'app-relation-detail',\n  templateUrl: './relation-detail.component.html',\n  styleUrls: ['./relation-detail.component.css']\n})\nexport class RelationDetailComponent implements OnInit {\n  relationMeta: RelationMeta;\n  readonly = true;\n  isNewMode = false;\n  isFieldMapShown = false;\n  relationForm: FormGroup;\n  currentAssociationForm: AbstractControl;\n  currentAssociation: Association;\n  currentRightRelationMeta: RelationMeta;\n  changedRelation = {};\n  bypassProtection = false;\n  isSearchListShown = true;\n  relationSearchHelp: SearchHelp;\n\n  @ViewChild(AttributeMetaComponent, {static: false})\n  private attrComponent!: AttributeMetaComponent;\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent!: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueRelationValidator: UniqueRelationValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.messageService.setMessageStore(msgStore, 'EN');\n  }\n\n  get associationFormArray() {\n    return this.relationForm.get('ASSOCIATIONS') as FormArray;\n  }\n  get fieldMapFormArray() {\n    if (this.currentAssociationForm) {\n      return this.currentAssociationForm.get('FIELDS_MAPPING') as FormArray;\n    } else {\n      return null;\n    }\n  }\n  get displayFieldMapModal() {\n    return this.isFieldMapShown ? 'block' : 'none';\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const relationID = params.get('relationID');\n        if (relationID === 'new') {\n          const relation = new RelationMeta();\n          relation.RELATION_ID = 'r_';\n          relation.RELATION_DESC = '';\n          relation.ATTRIBUTES = [];\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return of(relation);\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return this.entityService.getRelationMeta(params.get('relationID'));\n        }\n      })\n    ).subscribe(data => {\n      if ( 'RELATION_ID' in data) { // If the return data is a message\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.relationMeta = <RelationMeta>data;\n        this._generateRelationForm();\n      } else {\n        this.messageService.clearMessages();\n        this.relationMeta = null;\n        this.relationForm = null;\n        if (data instanceof Array) {\n          data.forEach(err => this.messageService.add(err));\n        } else {\n          this.messageService.report(<Message>data);\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  onSearchHelp(fieldName: string, control: AbstractControl, rowID: number): void {\n    if (!this.relationSearchHelp) {\n      this.relationSearchHelp = new SearchHelp();\n      this.relationSearchHelp.OBJECT_NAME = 'Relation';\n      this.relationSearchHelp.METHOD = function (entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listRelation(searchTerm);\n      }(this.entityService);\n      this.relationSearchHelp.BEHAVIOUR = 'A';\n      this.relationSearchHelp.MULTI = false;\n      this.relationSearchHelp.FUZZY_SEARCH = true;\n      this.relationSearchHelp.FIELDS = [\n        {\n          FIELD_NAME: 'RELATION_ID', LIST_HEADER_TEXT: 'Relation', IMPORT: true, EXPORT: true, IE_FIELD_NAME: fieldName,\n          LIST_POSITION: 1, FILTER_POSITION: 0\n        },\n        {FIELD_NAME: 'RELATION_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.relationSearchHelp.READ_ONLY = this.readonly;\n    }\n    const afterExportFn = function (context: any, ruleIdx: number) {\n      return () => context.onChangeRightRelationID(ruleIdx, true);\n    }(this, rowID).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.relationSearchHelp, control, afterExportFn);\n  }\n\n  _generateRelationForm(): void {\n    this.relationForm = this.fb.group({});\n    this.relationForm.addControl('RELATION_ID', new FormControl(this.relationMeta.RELATION_ID, {updateOn: 'blur'}));\n    if (this.isNewMode) {\n      this.relationForm.get('RELATION_ID').setValidators(this._validateRelationId);\n      this.relationForm.get('RELATION_ID').setAsyncValidators(this.uniqueRelationValidator.validate.bind(this.uniqueRelationValidator));\n    }\n    this.relationForm.addControl('RELATION_DESC', new FormControl(this.relationMeta.RELATION_DESC));\n\n    // Compose Associations\n    const formArray = [];\n    if (this.relationMeta.ASSOCIATIONS) {\n      this.relationMeta.ASSOCIATIONS.forEach( association => {\n        const fieldsMapArray = [];\n        association.FIELDS_MAPPING.forEach( fieldsMap => {\n          fieldsMapArray.push(this.fb.group({\n            LEFT_FIELD: [fieldsMap.LEFT_FIELD],\n            RIGHT_FIELD: [fieldsMap.RIGHT_FIELD]\n          }));\n        });\n        formArray.push(this.fb.group({\n          ASSOCIATION_NAME: [association.ASSOCIATION_NAME],\n          RIGHT_RELATION_ID: [association.RIGHT_RELATION_ID],\n          CARDINALITY: [{value: association.CARDINALITY, disabled: this.readonly}],\n          FOREIGN_KEY_CHECK: [{\n            value: association.FOREIGN_KEY_CHECK,\n            disabled: this.readonly || association.CARDINALITY === '[0..1]' || association.CARDINALITY === '[0..N]'}],\n          FIELDS_MAPPING: this.fb.array(fieldsMapArray)\n        }));\n      });\n    }\n\n    if (this.isNewMode) {\n      this._appendEmptyAssociation(formArray);\n    }\n    this.relationForm.addControl('ASSOCIATIONS', new FormArray(formArray));\n  }\n\n  _appendEmptyAssociation(formArray: any) {\n    formArray.push(\n      this.fb.group({\n        ASSOCIATION_NAME: [''],\n        RIGHT_RELATION_ID: [''],\n        CARDINALITY: ['[0..1]'],\n        FOREIGN_KEY_CHECK: [{value: 0, disabled: true}],\n        FIELDS_MAPPING: this.fb.array([])\n    }));\n  }\n\n  _validateRelationId(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Relation ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().toLowerCase().substr(0, 2) !== 'r_') {\n      return {message: 'Relation name must be started with \"r_\"!'};\n    }\n\n    if (c.value.toString().length < 3) {\n      return {message: 'Relation name must have length larger than 2!'};\n    }\n\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Entity Type?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.relationMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.relationForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateRelationForm();\n            this.relationForm.reset(this.relationForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this.readonly = false;\n      this.associationFormArray.controls.forEach(associationFormGroup => {\n        associationFormGroup.get('CARDINALITY').enable();\n        if ( associationFormGroup.get('CARDINALITY').value === '[1..1]' ||\n             associationFormGroup.get('CARDINALITY').value === '[1..N]' ) {\n          associationFormGroup.get('FOREIGN_KEY_CHECK').enable();\n        }\n      });\n      this._appendEmptyAssociation(this.associationFormArray);\n      this.attrComponent.switchEditDisplay(this.readonly);\n    }\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    let lastIndex = this.associationFormArray.length - 1;\n    while (lastIndex >= 0 && this.associationFormArray.controls[lastIndex].get('ASSOCIATION_NAME').value.trim() === '') {\n      this.associationFormArray.removeAt(lastIndex);\n      lastIndex--;\n    }\n    this.associationFormArray.controls.forEach(associationFormGroup => {\n      associationFormGroup.get('CARDINALITY').disable();\n      associationFormGroup.get('FOREIGN_KEY_CHECK').disable();\n    });\n    this.attrComponent.switchEditDisplay(this.readonly);\n  }\n\n  onChangeRelationID(): void {\n    this.modelService.updateRelationID(this.relationForm.get('RELATION_ID').value);\n  }\n\n  onChangeRelationDesc(): void {\n    this.modelService.updateRelationDesc(this.relationForm.get('RELATION_DESC').value);\n  }\n\n  deleteAssociation(index: number): void {\n    if (index !== this.associationFormArray.length - 1) {\n      this.associationFormArray.removeAt(index);\n      this.associationFormArray.markAsDirty();\n    }\n  }\n\n  openFieldMapModal(index: number): void {\n    this.currentAssociationForm = this.associationFormArray.controls[index];\n    if (this.currentAssociationForm.get('RIGHT_RELATION_ID').value.trim() === '') {\n      return;\n    }\n\n    this.entityService.getRelationMeta(this.currentAssociationForm.get('RIGHT_RELATION_ID').value)\n      .subscribe( data => {\n        this.currentRightRelationMeta = <RelationMeta>data;\n      });\n\n    if (this.readonly === false) {\n      this.fieldMapFormArray.push(this.fb.group({LEFT_FIELD: [''], RIGHT_FIELD: ['']}));\n    }\n    this.currentAssociation = this.relationMeta.ASSOCIATIONS ? this.relationMeta.ASSOCIATIONS[index] : null;\n    this.isFieldMapShown = true;\n  }\n\n  closeFieldMapModal(): void {\n    // this.currentAssociationForm.setValue(this.currentAssociationForm.value); // Or the value won't be updated.\n    let lastIndex = this.fieldMapFormArray.length - 1;\n    while (lastIndex >= 0 && this.fieldMapFormArray.controls[lastIndex].get('RIGHT_FIELD').value.trim() === '') {\n      this.fieldMapFormArray.removeAt(lastIndex);\n      lastIndex--;\n    }\n    this.isFieldMapShown = false;\n  }\n\n  deleteFieldMap(index: number): void {\n    if (index !== this.fieldMapFormArray.length - 1) {\n      this.fieldMapFormArray.removeAt(index);\n      this.fieldMapFormArray.markAsDirty();\n    }\n  }\n\n  onChangeAssociationName(index: number): void {\n    const currentAssocFormGroup = this.associationFormArray.at(index);\n    if (this.associationFormArray.controls.findIndex((assocCtrl, i) =>\n      i !== index && assocCtrl.get('ASSOCIATION_NAME').value === currentAssocFormGroup.get('ASSOCIATION_NAME').value\n    ) !== -1) {\n      currentAssocFormGroup.get('ASSOCIATION_NAME').setErrors({message: 'Duplicate association name!'});\n      return;\n    }\n\n    if (index === this.associationFormArray.length - 1 && currentAssocFormGroup.value.ASSOCIATION_NAME.trim() !== '') {\n      this._appendEmptyAssociation(this.associationFormArray);\n    }\n  }\n\n  onChangeRightRelationID(index: number, isExportedFromSH?: boolean): void {\n    const currentAssocFormGroup = this.associationFormArray.controls[index];\n\n    if (currentAssocFormGroup.get('RIGHT_RELATION_ID').value === this.relationMeta.RELATION_ID) {\n      currentAssocFormGroup.get('RIGHT_RELATION_ID').setErrors({message: 'Self association is not allowed'});\n      return;\n    }\n\n    if (!isExportedFromSH) {\n      this.entityService.getRelationDesc(currentAssocFormGroup.value.RIGHT_RELATION_ID)\n        .subscribe(data => {\n          if (data['msgCat']) {\n            currentAssocFormGroup.get('RIGHT_RELATION_ID').setErrors({message: data['msgShortText']});\n          }\n        });\n    }\n  }\n\n  onChangeCardinality(formGroup: AbstractControl): void {\n    const cardinality = formGroup.get('CARDINALITY');\n    if ( cardinality.value === '[1..1]' || cardinality.value === '[1..n]' ) {\n      formGroup.get('FOREIGN_KEY_CHECK').enable();\n    } else {\n      formGroup.get('FOREIGN_KEY_CHECK').setValue(0);\n      formGroup.get('FOREIGN_KEY_CHECK').markAsDirty();\n      formGroup.get('FOREIGN_KEY_CHECK').disable();\n    }\n  }\n\n  onChangeLeftField(index: number): void {\n    const currentFieldMapFormGroup = this.fieldMapFormArray.controls[index];\n    if (this.relationMeta.ATTRIBUTES.findIndex( attribute =>\n        attribute.ATTR_NAME === currentFieldMapFormGroup.get('LEFT_FIELD').value) === -1) {\n      currentFieldMapFormGroup.get('LEFT_FIELD').setErrors({message: 'Field Not Exist'});\n      return;\n    }\n\n    if (this.fieldMapFormArray.controls.findIndex((fieldMapCtrl, i) =>\n      i !== index && fieldMapCtrl.get('LEFT_FIELD') && fieldMapCtrl.get('RIGHT_FIELD') &&\n      fieldMapCtrl.get('LEFT_FIELD').value === currentFieldMapFormGroup.get('LEFT_FIELD').value &&\n      fieldMapCtrl.get('RIGHT_FIELD').value === currentFieldMapFormGroup.get('RIGHT_FIELD').value\n    ) !== -1) {\n      currentFieldMapFormGroup.get('LEFT_FIELD').setErrors({message: 'Duplicate Fields Mapping'});\n      return;\n    }\n\n    if (index === this.fieldMapFormArray.length - 1 && currentFieldMapFormGroup.value.LEFT_FIELD.trim() !== '') {\n      this.fieldMapFormArray.push(\n        this.fb.group( {LEFT_FIELD: [''], RIGHT_FIELD: ['']})\n      );\n    }\n  }\n\n  onChangeRightField(index: number): void {\n    const currentFieldMapFormGroup = this.fieldMapFormArray.controls[index];\n    if (this.currentRightRelationMeta &&\n        this.currentRightRelationMeta.ATTRIBUTES.findIndex( attribute =>\n          attribute.ATTR_NAME === currentFieldMapFormGroup.get('RIGHT_FIELD').value) === -1) {\n      currentFieldMapFormGroup.get('RIGHT_FIELD').setErrors({message: 'Field Not Exist'});\n      return;\n    }\n\n    if (this.fieldMapFormArray.controls.findIndex((fieldMapCtrl, i) =>\n      i !== index && fieldMapCtrl.get('LEFT_FIELD') && fieldMapCtrl.get('RIGHT_FIELD') &&\n      fieldMapCtrl.get('LEFT_FIELD').value === currentFieldMapFormGroup.get('LEFT_FIELD').value &&\n      fieldMapCtrl.get('RIGHT_FIELD').value === currentFieldMapFormGroup.get('RIGHT_FIELD').value\n    ) !== -1) {\n      currentFieldMapFormGroup.get('RIGHT_FIELD').setErrors({message: 'Duplicate Fields Mapping'});\n      return;\n    }\n\n    if (index === this.fieldMapFormArray.length - 1 && currentFieldMapFormGroup.value.RIGHT_FIELD.trim() !== '') {\n      this.fieldMapFormArray.push(\n        this.fb.group( {LEFT_FIELD: [''], RIGHT_FIELD: ['']})\n      );\n    }\n  }\n\n  oldAssociationName(formGroup: AbstractControl): boolean {\n    return this.relationMeta.ASSOCIATIONS ?\n      this.relationMeta.ASSOCIATIONS.findIndex(\n      association => association.ASSOCIATION_NAME === formGroup.get('ASSOCIATION_NAME').value ) !== -1 :\n      false;\n  }\n\n  oldFieldMap(formGroup: AbstractControl): boolean {\n    return this.currentAssociation ?\n      this.currentAssociation.FIELDS_MAPPING.findIndex(\n      fieldMap => fieldMap.LEFT_FIELD === formGroup.get('LEFT_FIELD').value &&\n                            fieldMap.RIGHT_FIELD === formGroup.get('RIGHT_FIELD').value ) !== -1 :\n      false;\n  }\n\n  onGoToRelation(relationID: string): void {\n    this.router.navigate(['/model/relation', relationID]);\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.relationForm && this.relationForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.relationForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (!this.relationForm.valid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedRelation['action'] = 'add';\n      this.changedRelation['RELATION_ID'] = this.relationForm.controls['RELATION_ID'].value;\n    } else {\n      this.changedRelation['action'] = 'update';\n      this.changedRelation['RELATION_ID'] = this.relationMeta.RELATION_ID;\n    }\n    if (this.relationForm.controls['RELATION_DESC'].dirty) {\n      this.changedRelation['RELATION_DESC'] = this.relationForm.controls['RELATION_DESC'].value;\n    }\n\n    const checkErrs = this.attrComponent.checkAttributes();\n    if (checkErrs.length > 0) {\n      checkErrs.forEach( errMsg => this.messageService.add( errMsg ) );\n      return;\n    }\n    this.changedRelation['ATTRIBUTES'] = this.attrComponent.processChangedAttributes();\n    if (!this._processChangedAssociation()) {\n      return;\n    }\n\n    this.entityService.saveRelation(this.changedRelation)\n      .subscribe(data => this._postActivityAfterSavingRelation(data));\n  }\n\n  _processChangedAssociation(): boolean {\n    const changedAssociations = [];\n    const errMessages = [];\n    if (!this.associationFormArray.dirty) { return true; }\n\n    this.changedRelation['ASSOCIATIONS'] = changedAssociations;\n\n    this.associationFormArray.controls.forEach(associationControl => {\n      if (!associationControl.get('ASSOCIATION_NAME').value ||\n          !associationControl.get('RIGHT_RELATION_ID').value) { return; }\n      const changedAssociation = {};\n      const associationMeta = this.relationMeta.ASSOCIATIONS.find(\n        association => associationControl.get('ASSOCIATION_NAME').value === association.ASSOCIATION_NAME);\n      if (!associationMeta) {// New Add Case\n        changedAssociation['action'] = 'add';\n        changedAssociation['ASSOCIATION_NAME'] = associationControl.get('ASSOCIATION_NAME').value;\n        changedAssociation['RIGHT_RELATION_ID'] = associationControl.get('RIGHT_RELATION_ID').value;\n        changedAssociation['CARDINALITY'] = associationControl.get('CARDINALITY').value;\n        changedAssociation['FOREIGN_KEY_CHECK'] = associationControl.get('FOREIGN_KEY_CHECK').value;\n        changedAssociation['FIELDS_MAPPING'] = [];\n        const fieldMapArray = associationControl.get('FIELDS_MAPPING') as FormArray;\n        if (fieldMapArray.length === 0) {\n          errMessages.push(this.messageService.generateMessage(\n            'MODEL', 'MISS_RELATION_ASSOCIATION_FIELD_MAPPING', 'E', changedAssociation['RIGHT_RELATION_ID']));\n          return;\n        }\n        fieldMapArray.controls.forEach(fieldMap => {\n          changedAssociation['FIELDS_MAPPING'].push(\n            {action: 'add', RIGHT_FIELD: fieldMap.get('RIGHT_FIELD').value, LEFT_FIELD: fieldMap.get('LEFT_FIELD').value});\n        });\n        changedAssociations.push(changedAssociation);\n      } else {\n        if (associationControl.dirty) {// Change Case\n          changedAssociation['action'] = 'update';\n          changedAssociation['ASSOCIATION_NAME'] = associationControl.get('ASSOCIATION_NAME').value;\n          if (associationControl.get('RIGHT_RELATION_ID').dirty) {\n            changedAssociation['RIGHT_RELATION_ID'] = associationControl.get('RIGHT_RELATION_ID').value;\n          }\n          if (associationControl.get('CARDINALITY').dirty) {\n            changedAssociation['CARDINALITY'] = associationControl.get('CARDINALITY').value;\n          }\n          if (associationControl.get('FOREIGN_KEY_CHECK').dirty) {\n            changedAssociation['FOREIGN_KEY_CHECK'] = associationControl.get('FOREIGN_KEY_CHECK').value;\n          }\n          if (associationControl.get('FIELDS_MAPPING').dirty) {\n            changedAssociation['FIELDS_MAPPING'] = [];\n            const fieldMapArray = associationControl.get('FIELDS_MAPPING') as FormArray;\n            if (fieldMapArray.length === 0) {\n              errMessages.push(this.messageService.generateMessage(\n                'MODEL', 'MISS_RELATION_ASSOCIATION_FIELD_MAPPING', 'E', changedAssociation['RIGHT_RELATION_ID']));\n              return;\n            }\n            fieldMapArray.controls.forEach(fieldMap => {\n              if (fieldMap.dirty) {\n                changedAssociation['FIELDS_MAPPING'].push(\n                  {action: 'add', RIGHT_FIELD: fieldMap.get('RIGHT_FIELD').value, LEFT_FIELD: fieldMap.get('LEFT_FIELD').value});\n              }\n            });\n            associationMeta.FIELDS_MAPPING.forEach( oldFieldMap => {\n              const index = fieldMapArray.controls.findIndex(fieldMap =>\n                fieldMap.get('LEFT_FIELD').value === oldFieldMap.LEFT_FIELD &&\n                fieldMap.get('RIGHT_FIELD').value === oldFieldMap.RIGHT_FIELD);\n              if (index === -1) {\n                changedAssociation['FIELDS_MAPPING'].push(\n                  {action: 'delete', RIGHT_FIELD: oldFieldMap.LEFT_FIELD, LEFT_FIELD: oldFieldMap.RIGHT_FIELD});\n              }\n            });\n          }\n          changedAssociations.push(changedAssociation);\n        }\n      }\n    });\n    if (errMessages.length > 0) {\n      errMessages.forEach( errMessage => this.messageService.add(errMessage));\n      return false;\n    }\n    // Deletion Case\n    this.relationMeta.ASSOCIATIONS.forEach(associationMeta => {\n      const index = this.associationFormArray.controls.findIndex(\n        associationControl => associationControl.get('ASSOCIATION_NAME').value === associationMeta.ASSOCIATION_NAME);\n      if (index === -1) { // The association must be deleted\n        changedAssociations.push({action: 'delete', ASSOCIATION_NAME: associationMeta.ASSOCIATION_NAME});\n      }\n    });\n    return true;\n  }\n\n  _postActivityAfterSavingRelation(data: any) {\n    this.changedRelation = {};\n    if (data['RELATION_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/relation/' + data['RELATION_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'RELATION_SAVED', 'S', data['RELATION_ID'])}});\n      } else {\n        this.readonly = true;\n        this.relationMeta = data;\n        this._generateRelationForm();\n        this.messageService.reportMessage('MODEL', 'RELATION_SAVED', 'S', data['RELATION_ID']);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n","export default \"<div class=\\\"btn-toolbar mb-2\\\"  role=\\\"toolbar\\\"\\n     [ngClass]=\\\"{'justify-content-end': isSearchListShown, 'justify-content-between': !isSearchListShown}\\\" >\\n  <button *ngIf=\\\"!isSearchListShown\\\" class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Show List\\\" (click)=\\\"showSearchList()\\\">\\n    <span class=\\\"fas fa-arrow-right\\\"></span>\\n  </button>\\n\\n  <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Edit/Display\\\" (click)=\\\"switchEditDisplay()\\\">\\n      <span *ngIf=\\\"readonly\\\" class=\\\"fas fa-edit\\\"></span>\\n      <span *ngIf=\\\"!readonly\\\" class=\\\"fas fa-glasses\\\"></span>\\n    </button>\\n    <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Save\\\" (click)=\\\"save()\\\">\\n      <span class=\\\"fas fa-save\\\"></span>\\n    </button>\\n  </div>\\n</div>\\n\\n<dk-message></dk-message>\\n<form *ngIf=\\\"dataElementMeta\\\" [formGroup]=\\\"dataElementForm\\\">\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"dataElement\\\" class=\\\"col-form-label form-control-sm\\\">Data Element:\\n      <span [class.ng-invalid]=\\\"dataElementForm.get('ELEMENT_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n        {{dataElementForm.get('ELEMENT_ID').errors?.message}}\\n      </span>\\n    </label>\\n    <input type=\\\"text\\\" class=\\\"form-control form-control-sm\\\" id=\\\"dataElement\\\" [readonly]=\\\"readonly || !isNewMode\\\"\\n           (change)=\\\"onChangeDataElementID()\\\" name=\\\"dataElement\\\" formControlName=\\\"ELEMENT_ID\\\">\\n  </div>\\n  <div class=\\\"form-group\\\">\\n    <label for=\\\"dataElement-desc\\\" class=\\\"col-form-label form-control-sm\\\">Data Element Description:\\n    </label>\\n    <textarea class=\\\"form-control\\\" id=\\\"dataElement-desc\\\" name=\\\"dataElement-desc\\\" rows=\\\"2\\\"\\n              formControlName=\\\"ELEMENT_DESC\\\" [readonly]=\\\"readonly\\\" (change)=\\\"onChangeDataElementDesc()\\\"></textarea>\\n  </div>\\n\\n  <div class=\\\"card mt-2\\\">\\n    <div class=\\\"card-header\\\">Data Type</div>\\n    <div class=\\\"card-body\\\">\\n      <div class=\\\"ml-2 mb-3 row\\\">\\n        <div class=\\\"col-8 col-lg-3 custom-control custom-radio\\\">\\n          <input type=\\\"radio\\\" class=\\\"custom-control-input\\\" id=\\\"use-domain\\\" name=\\\"USE_DOMAIN\\\"\\n                 [value]=\\\"1\\\" formControlName=\\\"USE_DOMAIN\\\" (change)=\\\"onChangeUseDomain(dataElementForm)\\\" required>\\n          <label class=\\\"custom-control-label\\\" for=\\\"use-domain\\\">Data Domain</label>\\n        </div>\\n        <div class=\\\"input-group col-8 col-lg-4\\\">\\n          <input type=\\\"text\\\" class=\\\"form-control form-control-sm\\\" id=\\\"data-domain\\\" (change)=\\\"onChangeDataDomain(dataElementForm)\\\"\\n                 [readonly]=\\\"readonly || !dataElementForm.get('USE_DOMAIN').value\\\" name=\\\"dataElement\\\" formControlName=\\\"DOMAIN_ID\\\"\\n                 (dblclick)=\\\"onGoToDataDomain(dataElementForm.value['DOMAIN_ID'])\\\">\\n          <div class=\\\"input-group-append\\\">\\n            <button class=\\\"btn btn-outline-secondary btn-sm\\\" type=\\\"button\\\" id=\\\"searchDomain\\\"\\n                    (click)=\\\"onDataDomainSearchHelp(dataElementForm)\\\">\\n              <span class=\\\"fas fa-search\\\"></span>\\n            </button>\\n          </div>\\n        </div>\\n        <span [class.ng-invalid]=\\\"dataElementForm.get('DOMAIN_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n          {{dataElementForm.get('DOMAIN_ID').errors?.required? 'A Data Domain is required': null}}\\n          {{dataElementForm.get('DOMAIN_ID').errors?.message}}\\n        </span>\\n      </div>\\n\\n      <div class=\\\"ml-2 mb-2 row\\\">\\n        <div class=\\\"col-8 col-lg-3 custom-control custom-radio\\\">\\n          <input type=\\\"radio\\\" class=\\\"custom-control-input\\\" id=\\\"use-data-type\\\" name=\\\"USE_DOMAIN\\\"\\n                 [value]=\\\"0\\\" formControlName=\\\"USE_DOMAIN\\\" (change)=\\\"onChangeUseDomain(dataElementForm)\\\" required>\\n          <label class=\\\"custom-control-label\\\" for=\\\"use-data-type\\\">Elementary Type</label>\\n        </div>\\n        <div class=\\\"input-group col-8 col-lg-4\\\">\\n          <select formControlName=\\\"DATA_TYPE\\\" (change)=\\\"onChangeDataType(dataElementForm)\\\"\\n                  class=\\\"form-control form-control-sm\\\">\\n            <option *ngFor=\\\"let opt of dataTypes\\\" [value]=\\\"opt.key\\\">{{opt.value}}</option>\\n          </select>\\n        </div>\\n      </div>\\n\\n      <div class=\\\"ml-2 row\\\">\\n        <div class=\\\"col-lg-3\\\"></div>\\n        <div class=\\\"form-group col-4 col-lg-2\\\">\\n          <label class=\\\"col-form-label col-form-label-sm\\\" for=\\\"data-length\\\">Length:\\n          </label>\\n          <input type=\\\"number\\\" formControlName=\\\"DATA_LENGTH\\\" id=\\\"data-length\\\" name=\\\"data-length\\\" class=\\\"form-control form-control-sm\\\"\\n                 [readonly]=\\\"readonly\\\" >\\n          <span class=\\\"dk-invalid-feedback\\\">{{dataElementForm.get('DATA_LENGTH').errors?.message}}</span>\\n        </div>\\n        <div class=\\\"form-group col-4 col-lg-2\\\">\\n          <label class=\\\"col-form-label col-form-label-sm\\\" for=\\\"decimal-place\\\">Decimal Place:\\n          </label>\\n          <input type=\\\"number\\\" formControlName=\\\"DECIMAL\\\" id=\\\"decimal-place\\\" name=\\\"decimal-place\\\"\\n                 class=\\\"form-control form-control-sm\\\" [readonly]=\\\"readonly\\\">\\n          <span class=\\\"dk-invalid-feedback\\\">{{dataElementForm.get('DECIMAL').errors?.message}}</span>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"card mt-2\\\">\\n    <div class=\\\"card-header\\\">Text</div>\\n    <div class=\\\"card-body\\\">\\n      <div class=\\\"ml-2 form-group row\\\">\\n        <label class=\\\"col-form-label col-form-label-sm col-lg-3\\\" for=\\\"label-text\\\">Label Text</label>\\n        <input type=\\\"text\\\" formControlName=\\\"LABEL_TEXT\\\" id=\\\"label-text\\\" name=\\\"label-text\\\"\\n               class=\\\"form-control form-control-sm col-md-6\\\" [readonly]=\\\"readonly\\\">\\n      </div>\\n\\n      <div class=\\\"ml-2 form-group row\\\">\\n        <label class=\\\"col-form-label col-form-label-sm col-lg-3\\\" for=\\\"list-header-text\\\">List Header Text</label>\\n        <input type=\\\"text\\\" formControlName=\\\"LIST_HEADER_TEXT\\\" id=\\\"list-header-text\\\" name=\\\"list-header-text\\\"\\n               class=\\\"form-control form-control-sm col-md-6\\\" [readonly]=\\\"readonly\\\">\\n      </div>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"card mt-2\\\">\\n    <div class=\\\"card-header\\\">Additional Attribute</div>\\n    <div class=\\\"card-body\\\">\\n      <div class=\\\"ml-2 form-group row\\\">\\n        <label class=\\\"col-form-label col-form-label-sm col-lg-3\\\" for=\\\"search-help\\\">Search Help</label>\\n        <div class=\\\"input-group col-8 col-lg-4\\\">\\n          <input type=\\\"text\\\" formControlName=\\\"SEARCH_HELP_ID\\\" id=\\\"search-help\\\" name=\\\"search-help\\\"\\n                 class=\\\"form-control form-control-sm\\\" [readonly]=\\\"readonly\\\" (change)=\\\"onChangeSearchHelp(dataElementForm)\\\"\\n                 (dblclick)=\\\"onGoToSearchHelp(dataElementForm.value['SEARCH_HELP_ID'])\\\">\\n          <div class=\\\"input-group-append\\\">\\n            <button class=\\\"btn btn-outline-secondary btn-sm\\\" type=\\\"button\\\" id=\\\"searchSearchHelp\\\"\\n                    (click)=\\\"onSearchHelpSearchHelp(dataElementForm)\\\">\\n              <span class=\\\"fas fa-search\\\"></span>\\n            </button>\\n          </div>\\n        </div>\\n        <span [class.ng-invalid]=\\\"dataElementForm.get('SEARCH_HELP_ID').invalid\\\" class=\\\"dk-invalid-feedback\\\">\\n            {{dataElementForm.get('SEARCH_HELP_ID').errors?.message}}\\n        </span>\\n      </div>\\n\\n      <div class=\\\"ml-2 form-group row\\\">\\n        <label class=\\\"col-form-label col-form-label-sm col-lg-3\\\" for=\\\"sh-export-field\\\">Export Field</label>\\n        <div class=\\\"input-group col-8 col-lg-4\\\">\\n          <select formControlName=\\\"SEARCH_HELP_EXPORT_FIELD\\\" class=\\\"form-control form-control-sm\\\" id=\\\"sh-export-field\\\">\\n            <option *ngFor=\\\"let exportField of searchHelpExportField\\\" [value]=\\\"exportField\\\">{{exportField}}</option>\\n          </select>\\n        </div>\\n      </div>\\n\\n      <div class=\\\"ml-2 form-group row\\\">\\n        <label class=\\\"col-form-label col-form-label-sm col-lg-3\\\" for=\\\"parameter\\\">Parameter</label>\\n        <div class=\\\"input-group col-8 col-lg-4\\\">\\n          <input type=\\\"text\\\" formControlName=\\\"PARAMETER_ID\\\" id=\\\"parameter\\\" name=\\\"parameter\\\"\\n                 class=\\\"form-control form-control-sm\\\" [readonly]=\\\"readonly\\\">\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</form>\\n\\n<dk-app-search-help></dk-app-search-help>\\n\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL2RhdGEtZG9tYWluL2RhdGEtZG9tYWluLmNvbXBvbmVudC5jc3MifQ== */\";","import { Injectable } from '@angular/core';\nimport {EntityType, Relation, RelationshipH, RoleH, DataDomainH, DataElementH, SearchHelpH} from 'jor-angular';\nimport {Subject} from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ModelService {\n  dataTypes = [\n    {key: 1, value: 'Char'},\n    {key: 2, value: 'Integer'},\n    {key: 3, value: 'Boolean'},\n    {key: 4, value: 'Decimal'},\n    {key: 5, value: 'String'},\n    {key: 6, value: 'Binary'},\n    {key: 7, value: 'Date'},\n    {key: 8, value: 'Timestamp'}\n  ];\n\n  private dialogAnswer = new Subject<string>();\n  dialogAnswer$ = this.dialogAnswer.asObservable();\n\n  private isSearchListShown = new Subject<boolean>();\n  isSearchListShown$ = this.isSearchListShown.asObservable();\n\n  private theSelectedEntityType: EntityType;\n  private selectedEntityTypeSource = new Subject<EntityType>();\n  theSelectedEntityType$ = this.selectedEntityTypeSource.asObservable();\n\n  private theSelectedRelation: Relation;\n  private selectedRelationSource = new Subject<Relation>();\n  theSelectedRelation$ = this.selectedRelationSource.asObservable();\n\n  private theSelectedRelationship: RelationshipH;\n  private selectedRelationshipSource = new Subject<RelationshipH>();\n  theSelectedRelationship$ = this.selectedRelationshipSource.asObservable();\n\n  private theSelectedRole: RoleH;\n  private selectedRoleSource = new Subject<RoleH>();\n  theSelectedRole$ = this.selectedRoleSource.asObservable();\n\n  private theSelectedDataElement: DataElementH;\n  private selectedDataElementSource = new Subject<DataElementH>();\n  theSelectedDataElement$ = this.selectedDataElementSource.asObservable();\n\n  private theSelectedDataDomain: DataDomainH;\n  private selectedDataDomainSource = new Subject<DataDomainH>();\n  theSelectedDataDomain$ = this.selectedDataDomainSource.asObservable();\n\n  private theSelectedSearchHelp: SearchHelpH;\n  private selectedSearchHelpSource = new Subject<SearchHelpH>();\n  theSelectedSearchHelp$ = this.selectedSearchHelpSource.asObservable();\n\n  showSearchList(): void {\n    this.isSearchListShown.next(true);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown.next(false);\n  }\n  updateEntityID(entityID: string) {\n    this.theSelectedEntityType.ENTITY_ID = entityID;\n    this.selectedEntityTypeSource.next(this.theSelectedEntityType);\n  }\n\n  updateEntityDesc(entityDesc: string) {\n    this.theSelectedEntityType.ENTITY_DESC = entityDesc;\n    this.selectedEntityTypeSource.next(this.theSelectedEntityType);\n  }\n\n  setSelectedEntityType(entityType: EntityType): void {\n    this.theSelectedEntityType = entityType;\n  }\n\n  updateRelationID(relationID: string) {\n    this.theSelectedRelation.RELATION_ID = relationID;\n    this.selectedRelationSource.next(this.theSelectedRelation);\n  }\n\n  updateRelationDesc(relationDesc: string) {\n    this.theSelectedRelation.RELATION_DESC = relationDesc;\n    this.selectedRelationSource.next(this.theSelectedRelation);\n  }\n\n  setSelectedRelation(relation: Relation): void {\n    this.theSelectedRelation = relation;\n  }\n\n  updateRelationshipID(relationshipID: string) {\n    this.theSelectedRelationship.RELATIONSHIP_ID = relationshipID;\n    this.selectedRelationshipSource.next(this.theSelectedRelationship);\n  }\n\n  updateRelationshipDesc(relationshipDesc: string) {\n    this.theSelectedRelationship.RELATIONSHIP_DESC = relationshipDesc;\n    this.selectedRelationshipSource.next(this.theSelectedRelationship);\n  }\n\n  setSelectedRelationship(relationship: RelationshipH): void {\n    this.theSelectedRelationship = relationship;\n  }\n\n  updateRoleID(roleID: string) {\n    this.theSelectedRole.ROLE_ID = roleID;\n    this.selectedRoleSource.next(this.theSelectedRole);\n  }\n\n  updateRoleDesc(roleDesc: string) {\n    this.theSelectedRole.ROLE_DESC = roleDesc;\n    this.selectedRoleSource.next(this.theSelectedRole);\n  }\n\n  setSelectedRole(role: RoleH): void {\n    this.theSelectedRole = role;\n  }\n\n  updateDataElementID(elementID: string) {\n    this.theSelectedDataElement.ELEMENT_ID = elementID;\n    this.selectedDataElementSource.next(this.theSelectedDataElement);\n  }\n\n  updateDataElementDesc(elementDesc: string) {\n    this.theSelectedDataElement.ELEMENT_DESC = elementDesc;\n    this.selectedDataElementSource.next(this.theSelectedDataElement);\n  }\n\n  setSelectedDataElement(element: DataElementH): void {\n    this.theSelectedDataElement = element;\n  }\n\n  updateDataDomainID(domainID: string) {\n    this.theSelectedDataDomain.DOMAIN_ID = domainID;\n    this.selectedDataDomainSource.next(this.theSelectedDataDomain);\n  }\n\n  updateDataDomainDesc(domainDesc: string) {\n    this.theSelectedDataDomain.DOMAIN_DESC = domainDesc;\n    this.selectedDataDomainSource.next(this.theSelectedDataDomain);\n  }\n\n  setSelectedDataDomain(domain: DataDomainH): void {\n    this.theSelectedDataDomain = domain;\n  }\n\n  updateSearchHelpID(searchHelpID: string) {\n    this.theSelectedSearchHelp.SEARCH_HELP_ID = searchHelpID;\n    this.selectedSearchHelpSource.next(this.theSelectedSearchHelp);\n  }\n\n  updateSearchHelpDesc(searchHelpDesc: string) {\n    this.theSelectedSearchHelp.SEARCH_HELP_DESC = searchHelpDesc;\n    this.selectedSearchHelpSource.next(this.theSelectedSearchHelp);\n  }\n\n  setSelectedSearchHelp(searchHelp: SearchHelpH): void {\n    this.theSelectedSearchHelp = searchHelp;\n  }\n\n  sendDialogAnswer(answer: string): void {\n    this.dialogAnswer.next(answer);\n  }\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL21vZGVsL2VudGl0eS10eXBlL2VudGl0eS10eXBlLmNvbXBvbmVudC5jc3MifQ== */\";","export default \"<div class=\\\"row\\\">\\n  <div *ngIf=\\\"isSearchListShown\\\" class=\\\"col-3\\\">\\n    <div class=\\\"btn-toolbar justify-content-between mb-2\\\" role=\\\"toolbar\\\">\\n      <div class=\\\"input-group\\\">\\n        <input type=\\\"text\\\" class=\\\"form-control\\\" placeholder=\\\"Search\\\" #searchBox (keyup)=\\\"searchSearchHelp(searchBox.value)\\\" >\\n      </div>\\n\\n      <div class=\\\"btn-group\\\" role=\\\"group\\\">\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Hide\\\" (click)=\\\"hideSearchList()\\\" [disabled]=\\\"!theSelectedSearchHelp\\\">\\n          <span class=\\\"fas fa-arrow-left\\\"></span>\\n        </button>\\n        <button class=\\\"btn\\\" type=\\\"button\\\" title=\\\"Add\\\" (click)=\\\"newSearchHelp()\\\">\\n          <span class=\\\"fas fa-plus\\\"></span>\\n        </button>\\n      </div>\\n    </div>\\n    <div class=\\\"list-group\\\">\\n      <a *ngFor=\\\"let searchHelp of searchHelpList\\\" routerLink=\\\"/model/search-help/{{searchHelp.SEARCH_HELP_ID}}\\\" routerLinkActive=\\\"active\\\"\\n         (click)=\\\"onSelect(searchHelp)\\\" class=\\\"list-group-item list-group-item-action flex-column align-items-start\\\">\\n        <div class=\\\"d-flex w-100 justify-content-between\\\">\\n          <h5 class=\\\"mb-1\\\">{{searchHelp.SEARCH_HELP_ID}}</h5>\\n          <small>version: {{searchHelp.VERSION_NO}}</small>\\n        </div>\\n        <p class=\\\"mb-1\\\">{{searchHelp.SEARCH_HELP_DESC}}</p>\\n        <!--<small>created by: {{entityType.CREATE_BY}} @{{entityType.CREATE_TIME}}</small> <br/>-->\\n        <small>last changed by: {{searchHelp.LAST_CHANGE_BY}} @{{searchHelp.LAST_CHANGE_TIME}}</small>\\n      </a>\\n    </div>\\n  </div>\\n  <div [ngClass]=\\\"{'col-9': isSearchListShown, 'col-12': !isSearchListShown}\\\">\\n    <router-outlet></router-outlet>\\n  </div>\\n</div>\\n\\n\";","import {Component, OnInit, ViewChild} from '@angular/core';\nimport {ActivatedRoute, ParamMap, Router} from '@angular/router';\nimport {switchMap} from 'rxjs/operators';\nimport {AbstractControl, FormArray, FormBuilder, FormControl, FormGroup} from '@angular/forms';\nimport {Message, MessageService} from 'ui-message-angular';\nimport {msgStore} from '../../../msgStore';\nimport {forkJoin, Observable, of} from 'rxjs';\nimport {AttributeMetaComponent} from '../../attribute-meta/attribute-meta.component';\nimport {ModelService} from '../../model.service';\nimport {DialogService} from '../../../dialog.service';\nimport {UniqueEntityTypeValidator} from '../../model-validators';\nimport {SearchHelpMethod, SearchHelp, SearchHelpComponent, EntityService, Attribute, EntityMeta} from 'jor-angular';\n\n@Component({\n  selector: 'app-entity-type-detail',\n  templateUrl: './entity-type-detail.component.html',\n  styleUrls: ['./entity-type-detail.component.css']\n})\nexport class EntityTypeDetailComponent implements OnInit {\n  entityMeta: EntityMeta;\n  attributes: Attribute[];\n  readonly = true;\n  isNewMode = false;\n  entityTypeForm: FormGroup;\n  changedEntityType = {};\n  bypassProtection = false;\n  isSearchListShown = true;\n  roleSearchHelp: SearchHelp;\n\n  @ViewChild(AttributeMetaComponent, {static: false})\n  private attrComponent !: AttributeMetaComponent;\n  @ViewChild(SearchHelpComponent, {static: false})\n  private searchHelpComponent !: SearchHelpComponent;\n\n  constructor(private route: ActivatedRoute,\n              private router: Router,\n              private fb: FormBuilder,\n              private uniqueEntityTypeValidator: UniqueEntityTypeValidator,\n              private messageService: MessageService,\n              private modelService: ModelService,\n              private dialogService: DialogService,\n              private entityService: EntityService) {\n    this.messageService.setMessageStore(msgStore, 'EN');\n  }\n\n  get roleFormArray() {\n    return this.entityTypeForm.get('ROLES') as FormArray;\n  }\n\n  get attrFormArray() {\n    return this.entityTypeForm.get('ATTRIBUTES') as FormArray;\n  }\n\n  ngOnInit() {\n    this.route.paramMap.pipe(\n      switchMap((params: ParamMap) => {\n        const entityID = params.get('entityID');\n        if (entityID === 'new') {\n          const entityType = new EntityMeta();\n          entityType.ENTITY_ID = '';\n          entityType.ENTITY_DESC = '';\n          entityType.ROLES = [];\n          this.isNewMode = true;\n          this.readonly = false;\n          this.bypassProtection = false;\n          return forkJoin(of(entityType), of([]));\n        } else {\n          this.readonly = true;\n          this.isNewMode = false;\n          return forkJoin(\n            this.entityService.getEntityMeta(entityID),\n            this.entityService.getRelationMeta(entityID));\n        }\n      })\n    ).subscribe(data => {\n      if ( 'ENTITY_ID' in data[0]) {\n        this.messageService.clearMessages();\n        if (history.state.message) {\n          this.messageService.report(history.state.message);\n        }\n        this.entityMeta = <EntityMeta>data[0];\n        this.attributes = 'RELATION_ID' in data[1] ? data[1]['ATTRIBUTES'] : [];\n        this._generateEntityTypeForm();\n      } else {\n        this.messageService.clearMessages();\n        this.entityMeta = null;\n        this.entityTypeForm = null;\n        if (data[0] instanceof Array) {\n          data[0].forEach(err => this.messageService.add(err) );\n        } else {\n          this.messageService.report(<Message>data[0]);\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  showSearchList(): void {\n    this.isSearchListShown = true;\n    this.modelService.showSearchList();\n  }\n\n  onSearchHelp(control: AbstractControl, rowID: number): void {\n    if (!this.roleSearchHelp) {\n      this.roleSearchHelp = new SearchHelp();\n      this.roleSearchHelp.OBJECT_NAME = 'Role';\n      this.roleSearchHelp.METHOD = function(entityService: EntityService): SearchHelpMethod {\n        return (searchTerm: string): Observable<object[]> => entityService.listRole(searchTerm);\n      }(this.entityService);\n      this.roleSearchHelp.BEHAVIOUR = 'A';\n      this.roleSearchHelp.MULTI = false;\n      this.roleSearchHelp.FUZZY_SEARCH = true;\n      this.roleSearchHelp.FIELDS = [\n        {FIELD_NAME: 'ROLE_ID', LIST_HEADER_TEXT: 'Role', IMPORT: true, EXPORT: true, LIST_POSITION: 1, FILTER_POSITION: 0},\n        {FIELD_NAME: 'ROLE_DESC', LIST_HEADER_TEXT: 'Description', IMPORT: true, EXPORT: true, LIST_POSITION: 2, FILTER_POSITION: 0}\n      ];\n      this.roleSearchHelp.READ_ONLY = this.readonly || this.oldRole(control) && control.valid;\n    }\n    const afterExportFn = function (context: any, ruleIdx: number) {\n      return () => context.onChangeRoleID(ruleIdx, true);\n    }(this, rowID).bind(this);\n    this.searchHelpComponent.openSearchHelpModal(this.roleSearchHelp, control, afterExportFn);\n  }\n\n  _generateEntityTypeForm(): void {\n    this.entityTypeForm = this.fb.group({});\n    this.entityTypeForm.addControl('ENTITY_ID',\n      new FormControl(this.entityMeta.ENTITY_ID, {updateOn: 'blur'}));\n    if (this.isNewMode) {\n      this.entityTypeForm.get('ENTITY_ID').setValidators(this._validateEntityId);\n      this.entityTypeForm.get('ENTITY_ID').setAsyncValidators(\n        this.uniqueEntityTypeValidator.validate.bind(this.uniqueEntityTypeValidator));\n    }\n    this.entityTypeForm.addControl('ENTITY_DESC', new FormControl(this.entityMeta.ENTITY_DESC));\n\n    // Compose roles\n    const formArray = [];\n    this.entityMeta.ROLES.forEach( role => {\n      formArray.push(this.fb.group({\n        ROLE_ID: [role.ROLE_ID],\n        ROLE_DESC: [role.ROLE_DESC],\n        CONDITIONAL_ATTR: [{value: role.CONDITIONAL_ATTR, disabled: this.readonly}],\n        CONDITIONAL_VALUE: [role.CONDITIONAL_VALUE]\n      }));\n    });\n    if (this.isNewMode) {\n      formArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CONDITIONAL_ATTR: [''],\n          CONDITIONAL_VALUE: ['']\n        }));\n    }\n    this.entityTypeForm.addControl('ROLES', new FormArray(formArray));\n  }\n\n  _validateEntityId(c: FormControl) {\n    if (c.value.trim() === '') {\n      return {message: 'Entity ID is mandatory'};\n    }\n\n    if (c.value.toString().toLowerCase() === 'new') {\n      return {message: '\"NEW/new\" is reserved, thus is not allowed to use!'};\n    }\n\n    if (c.value.toString().toLowerCase().substr(0, 2) === 'r_' ||\n        c.value.toString().toLowerCase().substr(0, 3) === 'rs_') {\n      return {message: 'Entity ID cannot be started with \"r_\" or \"rs_\"!'};\n    }\n    return null;\n  }\n\n  switchEditDisplay() {\n    if (this.isNewMode) {\n      this.dialogService.confirm('Discard the new Entity Type?').subscribe(confirm => {\n        if (confirm) {\n          this._switch2DisplayMode();\n          this.entityMeta = null;\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return;\n    }\n\n    if (!this.readonly) { // In Change Mode -> Display Mode\n      if (this.entityTypeForm.dirty) {\n        this.dialogService.confirm('Discard changes?').subscribe(confirm => {\n          if (confirm) { // Discard changes and switch to Display Mode\n            this._generateEntityTypeForm();\n            this.entityTypeForm.reset(this.entityTypeForm.value);\n            this._switch2DisplayMode();\n          }\n        });\n      } else { // Switch to display mode\n        this._switch2DisplayMode();\n      }\n    } else { // In Display Mode -> Change Mode\n      this.readonly = false;\n      this.attrComponent.switchEditDisplay(this.readonly);\n      this.roleFormArray.controls.forEach(roleFormGroup => roleFormGroup.get('CONDITIONAL_ATTR').enable());\n      this.roleFormArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CONDITIONAL_ATTR: [''],\n          CONDITIONAL_VALUE: ['']\n        })\n      );\n    }\n    this.messageService.clearMessages();\n  }\n\n  _switch2DisplayMode(): void {\n    this.readonly = true;\n    this.attrComponent.switchEditDisplay(this.readonly);\n    this.roleFormArray.controls.forEach(roleFormGroup => {\n      roleFormGroup.get('CONDITIONAL_ATTR').disable();\n    });\n    let lastIndex = this.roleFormArray.length - 1;\n    while (lastIndex >= 0 && this.roleFormArray.controls[lastIndex].get('ROLE_ID').value.trim() === '') {\n      this.roleFormArray.removeAt(lastIndex);\n      lastIndex--;\n    }\n  }\n\n  onChangeEntityID(): void {\n    this.modelService.updateEntityID(this.entityTypeForm.get('ENTITY_ID').value);\n  }\n\n  onChangeEntityDesc(): void {\n    this.modelService.updateEntityDesc(this.entityTypeForm.get('ENTITY_DESC').value);\n  }\n\n  deleteRole(index: number): void {\n    if (index !== this.roleFormArray.length - 1) {\n      this.roleFormArray.removeAt(index);\n      this.roleFormArray.markAsDirty();\n    }\n  }\n\n  onChangeRoleID(index: number, isExportedFromSH?: boolean): void {\n    const currentRoleFormGroup = this.roleFormArray.controls[index];\n    if (this.roleFormArray.controls.findIndex((roleCtrl, i) =>\n      i !== index && roleCtrl.get('ROLE_ID').value === currentRoleFormGroup.get('ROLE_ID').value\n    ) !== -1) {\n      currentRoleFormGroup.get('ROLE_ID').setErrors({message: 'Duplicate roles'});\n      return;\n    }\n\n    if (index === this.roleFormArray.length - 1 && currentRoleFormGroup.value.ROLE_ID.trim() !== '') {\n      // Only work for the last New line\n      this.roleFormArray.push(\n        this.fb.group({\n          ROLE_ID: [''],\n          ROLE_DESC: [''],\n          CONDITIONAL_ATTR: [''],\n          CONDITIONAL_VALUE: ['']\n        })\n      );\n    }\n\n    if (!isExportedFromSH) {\n      this.entityService.getRoleDesc(currentRoleFormGroup.value.ROLE_ID).subscribe(data => {\n        if (data['msgCat']) {\n          currentRoleFormGroup.get('ROLE_ID').setErrors({message: data['msgShortText']});\n        } else {\n          currentRoleFormGroup.get('ROLE_DESC').setValue(data);\n        }\n      });\n    }\n  }\n\n  oldRole(formGroup: AbstractControl): boolean {\n    return this.entityMeta.ROLES ?\n      this.entityMeta.ROLES.findIndex(\n        role => role.ROLE_ID === formGroup.get('ROLE_ID').value ) !== -1 :\n      false;\n  }\n\n  onGoToRole(roleID: string): void {\n    this.router.navigate(['/model/role', roleID]);\n  }\n\n  canDeactivate(): Observable<boolean> | boolean {\n    if (this.isNewMode || (!this.bypassProtection && this.entityTypeForm && this.entityTypeForm.dirty)) {\n      const dialogAnswer = this.dialogService.confirm('Discard changes?');\n      dialogAnswer.subscribe(confirm => {\n        if (confirm) {\n          this.modelService.sendDialogAnswer('OK');\n        } else {\n          this.modelService.sendDialogAnswer('CANCEL');\n        }\n      });\n      return dialogAnswer;\n    } else {\n      return true;\n    }\n  }\n\n  save(): void {\n    if (!this.entityTypeForm.dirty) {\n      return this.messageService.reportMessage('MODEL', 'NO_CHANGE', 'S');\n    }\n\n    if (!this.entityTypeForm.valid) {\n      return this.messageService.reportMessage('MODEL', 'INVALID_DATA', 'E');\n    }\n\n    if (this.isNewMode) {\n      this.changedEntityType['action'] = 'add';\n      this.changedEntityType['ENTITY_ID'] = this.entityTypeForm.controls['ENTITY_ID'].value;\n    } else {\n      this.changedEntityType['action'] = 'update';\n      this.changedEntityType['ENTITY_ID'] = this.entityMeta.ENTITY_ID;\n    }\n    if (this.entityTypeForm.controls['ENTITY_DESC'].dirty) {\n      this.changedEntityType['ENTITY_DESC'] = this.entityTypeForm.controls['ENTITY_DESC'].value;\n    }\n\n    this.changedEntityType['ATTRIBUTES'] = this.attrComponent.processChangedAttributes();\n    this._processChangedRoles();\n\n    this.entityService.saveEntityType(this.changedEntityType)\n      .subscribe(data => this._postActivityAfterSavingEntityType(data));\n  }\n\n  _processChangedRoles(): void {\n    const changedRoles = [];\n    if (this.roleFormArray.dirty) {\n      this.changedEntityType['ROLES'] = changedRoles;\n      let action;\n      // Add/Update Case\n      this.roleFormArray.controls.forEach(role => {\n        if (role.get('ROLE_ID').value.trim() === '') { return; }\n        const index = this.entityMeta.ROLES.findIndex(\n          existRole => role.value.ROLE_ID === existRole.ROLE_ID);\n        action = index === -1 ? 'add' : 'update';\n        if (role.dirty) {\n          const changedRole = { action: action, ROLE_ID: role.value.ROLE_ID };\n          if (role.get('CONDITIONAL_ATTR').dirty) {\n            changedRole['CONDITIONAL_ATTR'] = role.value.CONDITIONAL_ATTR;\n          }\n          if (role.get('CONDITIONAL_VALUE').dirty) {\n            changedRole['CONDITIONAL_VALUE'] = role.value.CONDITIONAL_VALUE;\n          }\n          changedRoles.push(changedRole);\n        }\n      });\n\n      // Deletion Case\n      this.entityMeta.ROLES.forEach(role => {\n        const index = this.roleFormArray.controls.findIndex(\n          roleControl => roleControl.get('ROLE_ID').value === role.ROLE_ID);\n        if (index === -1) {\n          const deletedRole = {action: 'delete', ROLE_ID: role.ROLE_ID};\n          changedRoles.push(deletedRole);\n        }\n      });\n    }\n  }\n\n  _postActivityAfterSavingEntityType(data: any) {\n    this.changedEntityType = {};\n    if (data[0] && data[0]['ENTITY_ID']) {\n      if (this.isNewMode) {\n        this.isNewMode = false;\n        this.bypassProtection = true;\n        this.router.navigate(['/model/entity-type/' + data[0]['ENTITY_ID']],\n          {state: {message: this.messageService.generateMessage(\n                'MODEL', 'ENTITY_TYPE_SAVED', 'S', data[0]['ENTITY_ID'])}});\n      } else {\n        this.readonly = true;\n        this.entityMeta = data[0];\n        this.attributes = data[1].ATTRIBUTES;\n        this._generateEntityTypeForm();\n        this.messageService.reportMessage('MODEL', 'ENTITY_TYPE_SAVED', 'S',\n          this.entityMeta.ENTITY_ID);\n      }\n    } else {\n      if (data instanceof Array) {\n        data.forEach(err => this.messageService.add(err));\n      } else {\n        this.messageService.report(<Message>data);\n      }\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport {Subject} from 'rxjs';\nimport {ModelService} from '../model.service';\nimport {MessageService} from 'ui-message-angular';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {debounceTime, distinctUntilChanged, switchMap} from 'rxjs/operators';\nimport {DataElementH, EntityService, DataElementMeta} from 'jor-angular';\nimport {IdentityService} from '../../identity.service';\n\n@Component({\n  selector: 'app-data-element',\n  templateUrl: './data-element.component.html',\n  styleUrls: ['./data-element.component.css']\n})\nexport class DataElementComponent implements OnInit {\n  dataElementList: DataElementH[] = [];\n  isSearchListShown = true;\n  private searchTerms = new Subject<string>();\n  private theSelectedDataElement: DataElementH;\n\n  constructor(private entityService: EntityService,\n              private modelService: ModelService,\n              private messageService: MessageService,\n              private identityService: IdentityService,\n              private route: ActivatedRoute,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.searchTerms.pipe(\n      debounceTime(300),\n      distinctUntilChanged(),\n      switchMap((term: string) => this.entityService.listDataElement(term)),\n    ).subscribe(data => {\n      this.dataElementList = data;\n      let elementID;\n      if (this.route.snapshot.firstChild) {\n        elementID = this.route.snapshot.firstChild.paramMap.get('elementID');\n      }\n      if (elementID ) {\n        if (elementID === 'new') {\n          this._newDataElement();\n        } else {\n          this.onSelect(this.dataElementList.find(dataEle => dataEle.ELEMENT_ID === elementID));\n        }\n      }\n    });\n    this.searchDataElement(''); // The initial list\n\n    this.modelService.theSelectedDataElement$.subscribe( data => {\n      if (this.theSelectedDataElement) {\n        this.theSelectedDataElement.ELEMENT_ID = data['ELEMENT_ID'];\n        this.theSelectedDataElement.ELEMENT_DESC = data['ELEMENT_DESC'];\n      }\n    });\n\n    this.modelService.dialogAnswer$.subscribe( answer => {\n      if (answer === 'OK' && this.dataElementList[0] && !this.dataElementList[0].CREATE_TIME) {\n        this.dataElementList.splice(0, 1); // Remove the first one.\n      } else if (answer === 'CANCEL') {\n        const elementID = this.route.snapshot.firstChild.paramMap.get('elementID');\n        if (elementID) {\n          if (elementID === 'new') {\n            this.onSelect(this.dataElementList[0]);\n          } else {\n            this.onSelect(this.dataElementList.find(dataElement => dataElement.ELEMENT_ID === elementID));\n          }\n        }\n      }\n    });\n\n    this.modelService.isSearchListShown$.subscribe( data => this.isSearchListShown = data);\n  }\n\n  hideSearchList(): void {\n    this.isSearchListShown = false;\n    this.modelService.hideSearchList();\n  }\n\n  onSelect(dataElement: DataElementH): void {\n    if (dataElement) {\n      this.theSelectedDataElement = dataElement;\n      this.modelService.setSelectedDataElement(dataElement);\n    }\n  }\n\n  searchDataElement(term: string): void {\n    this.searchTerms.next(term);\n  }\n\n  newDataElement(): void {\n    if (this.route.snapshot.firstChild && this.route.snapshot.firstChild.paramMap.get('elementID') === 'new') {\n      this.messageService.reportMessage('MODEL', 'UNSAVED_NEW', 'E');\n    } else {\n      this._newDataElement();\n      this.router.navigate(['/model/data-element/new']);\n    }\n  }\n\n  _newDataElement(): void {\n    this.theSelectedDataElement = new DataElementMeta();\n    this.theSelectedDataElement.ELEMENT_ID = 'new';\n    this.theSelectedDataElement.ELEMENT_DESC = 'description';\n    this.theSelectedDataElement.VERSION_NO = 1;\n    this.theSelectedDataElement.LAST_CHANGE_BY = this.identityService.Session.USER_ID;\n    this.theSelectedDataElement.LAST_CHANGE_TIME = this.identityService.CurrentTime;\n    this.modelService.setSelectedDataElement(this.theSelectedDataElement);\n    this.dataElementList.splice(0, 0, this.theSelectedDataElement);\n  }\n}\n"]}